# React ç¬¬ä¸€å¤©

## Reactç®€ä»‹

+ React èµ·æºäº Facebook çš„å†…éƒ¨é¡¹ç›®ï¼Œå› ä¸ºè¯¥å…¬å¸å¯¹å¸‚åœºä¸Šæ‰€æœ‰ JavaScript MVC æ¡†æ¶ï¼Œéƒ½ä¸æ»¡æ„ï¼Œå°±å†³å®šè‡ªå·±å†™ä¸€å¥—ï¼Œç”¨æ¥æ¶è®¾ Instagramï¼ˆç…§ç‰‡äº¤å‹ï¼‰ çš„ç½‘ç«™ã€‚åšå‡ºæ¥ä»¥åï¼Œå‘ç°è¿™å¥—ä¸œè¥¿å¾ˆå¥½ç”¨ï¼Œ**å°±åœ¨2013å¹´5æœˆå¼€æºäº†**ã€‚
+ Angular1 2009 å¹´  è°·æ­Œ    MVC  ä¸æ”¯æŒ ç»„ä»¶åŒ–å¼€å‘
+ ç”±äº React çš„**è®¾è®¡æ€æƒ³æå…¶ç‹¬ç‰¹**ï¼Œå±äºé©å‘½æ€§åˆ›æ–°ï¼Œæ€§èƒ½å‡ºä¼—ï¼Œä»£ç é€»è¾‘å´éå¸¸ç®€å•ã€‚æ‰€ä»¥ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹å…³æ³¨å’Œä½¿ç”¨ï¼Œè®¤ä¸ºå®ƒå¯èƒ½æ˜¯å°†æ¥ Web å¼€å‘çš„ä¸»æµå·¥å…·ã€‚
+ æ¸…æ¥šä¸¤ä¸ªæ¦‚å¿µï¼š
  + libraryï¼ˆåº“ï¼‰ï¼šå°è€Œå·§çš„åº“ï¼Œåªæä¾›äº†ç‰¹å®šçš„APIï¼›ä¼˜ç‚¹å°±æ˜¯ èˆ¹å°å¥½æ‰å¤´ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ä»ä¸€ä¸ªåº“åˆ‡æ¢åˆ°å¦å¤–çš„åº“ï¼›ä½†æ˜¯ä»£ç å‡ ä¹ä¸ä¼šæ”¹å˜ï¼›
  + Frameworkï¼ˆæ¡†æ¶ï¼‰ï¼šå¤§è€Œå…¨çš„æ˜¯æ¡†æ¶ï¼›æ¡†æ¶æä¾›äº†ä¸€æ•´å¥—çš„è§£å†³æ–¹æ¡ˆï¼›æ‰€ä»¥ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­é—´ï¼Œæƒ³åˆ‡æ¢åˆ°å¦å¤–çš„æ¡†æ¶ï¼Œæ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼›



## Reactçš„ç‰¹ç‚¹

- å£°æ˜å¼
  - Reactè´Ÿè´£æ¸²æŸ“UI, å¹¶åœ¨æ•°æ®å˜åŒ–çš„æ—¶å€™, æ›´æ–°UI
- åŸºäºç»„ä»¶
- å­¦ä¹ ä¸€æ¬¡,éšå¤„ä½¿ç”¨
  - ä½¿ç”¨Reactå¯ä»¥å¼€å‘webåº”ç”¨
  - ä½¿ç”¨reactå¯ä»¥å¼€å‘ç§»åŠ¨ç«¯æ··åˆåº”ç”¨(react-native)
  - ä½¿ç”¨Reactå¯ä»¥å¼€å‘VR (è™šæ‹Ÿç°å®) åº”ç”¨(react 360)

## Reactä¸vueçš„å¯¹æ¯”

### ç»„ä»¶åŒ–æ–¹é¢

1. **ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–ï¼š**æ˜¯ä»**ä»£ç **çš„è§’åº¦æ¥è¿›è¡Œåˆ†æçš„ï¼›æŠŠä¸€äº›å¯å¤ç”¨çš„ä»£ç ï¼ŒæŠ½ç¦»ä¸ºå•ä¸ªçš„æ¨¡å—ï¼›ä¾¿äºé¡¹ç›®çš„ç»´æŠ¤å’Œå¼€å‘ï¼›
2. **ä»€ä¹ˆæ˜¯ç»„ä»¶åŒ–ï¼š** æ˜¯ä» **UI ç•Œé¢**çš„è§’åº¦ æ¥è¿›è¡Œåˆ†æçš„ï¼›æŠŠä¸€äº›å¯æœç”¨çš„UIå…ƒç´ ï¼ŒæŠ½ç¦»ä¸ºå•ç‹¬çš„ç»„ä»¶ï¼›ä¾¿äºé¡¹ç›®çš„ç»´æŠ¤å’Œå¼€å‘ï¼›
3. **ç»„ä»¶åŒ–çš„å¥½å¤„ï¼š**éšç€é¡¹ç›®è§„æ¨¡çš„å¢å¤§ï¼Œæ‰‹é‡Œçš„ç»„ä»¶è¶Šæ¥è¶Šå¤šï¼›å¾ˆæ–¹ä¾¿å°±èƒ½æŠŠç°æœ‰çš„ç»„ä»¶ï¼Œæ‹¼æ¥ä¸ºä¸€ä¸ªå®Œæ•´çš„é¡µé¢ï¼›
4. **Vueæ˜¯å¦‚ä½•å®ç°ç»„ä»¶åŒ–çš„ï¼š** é€šè¿‡ `.vue` æ–‡ä»¶ï¼Œæ¥åˆ›å»ºå¯¹åº”çš„ç»„ä»¶ï¼›
   + template  ç»“æ„
   + script        è¡Œä¸º
   + style           æ ·å¼


5. **Reactå¦‚ä½•å®ç°ç»„ä»¶åŒ–**ï¼šå¤§å®¶æ³¨æ„ï¼ŒReactä¸­æœ‰ç»„ä»¶åŒ–çš„æ¦‚å¿µï¼Œä½†æ˜¯ï¼Œå¹¶æ²¡æœ‰åƒvueè¿™æ ·çš„ç»„ä»¶æ¨¡æ¿æ–‡ä»¶ï¼›Reactä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯ä»¥JSæ¥è¡¨ç°çš„ï¼›å› æ­¤è¦å­¦ä¹ Reactï¼ŒJSè¦åˆæ ¼ï¼›ES6 å’Œ ES7 ï¼ˆasync  å’Œ awaitï¼‰ è¦ä¼šç”¨ï¼›

### å¼€å‘å›¢é˜Ÿæ–¹é¢

+ Reactæ˜¯ç”±FaceBookå‰ç«¯å®˜æ–¹å›¢é˜Ÿè¿›è¡Œç»´æŠ¤å’Œæ›´æ–°çš„ï¼›å› æ­¤ï¼ŒReactçš„ç»´æŠ¤å¼€å‘å›¢é˜Ÿï¼ŒæŠ€æœ¯å®åŠ›æ¯”è¾ƒé›„åšï¼›
+ Vueï¼šç¬¬ä¸€ç‰ˆï¼Œä¸»è¦æ˜¯æœ‰ä½œè€… å°¤é›¨æºª ä¸“é—¨è¿›è¡Œç»´æŠ¤çš„ï¼Œå½“ Vueæ›´æ–°åˆ° 2.x ç‰ˆæœ¬åï¼Œä¹Ÿæœ‰äº†ä¸€ä¸ªä»¥ å°¤é›¨æºª ä¸ºä¸»å¯¼çš„å¼€æºå°å›¢é˜Ÿï¼Œè¿›è¡Œç›¸å…³çš„å¼€å‘å’Œç»´æŠ¤

### ç¤¾åŒºæ–¹é¢

+ åœ¨ç¤¾åŒºæ–¹é¢ï¼ŒReactç”±äºè¯ç”Ÿçš„è¾ƒæ—©ï¼Œæ‰€ä»¥ç¤¾åŒºæ¯”è¾ƒå¼ºå¤§ï¼Œä¸€äº›å¸¸è§çš„é—®é¢˜ã€å‘ã€æœ€ä¼˜è§£å†³æ–¹æ¡ˆï¼Œæ–‡æ¡£ã€åšå®¢åœ¨ç¤¾åŒºä¸­éƒ½æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿å°±èƒ½æ‰¾åˆ°çš„ï¼›
+ Vueæ˜¯è¿‘ä¸¤å¹´æ‰ç«èµ·æ¥çš„ï¼Œæ‰€ä»¥ï¼Œå®ƒçš„ç¤¾åŒºç›¸å¯¹äºReactæ¥è¯´ï¼Œè¦å°ä¸€äº›ï¼Œå¯èƒ½æœ‰çš„ä¸€äº›å‘ï¼Œæ²¡äººè¸©è¿‡ï¼›

### ç§»åŠ¨APPå¼€å‘ä½“éªŒæ–¹é¢

+ Vueï¼Œç»“åˆ Weex è¿™é—¨æŠ€æœ¯ï¼Œæä¾›äº† è¿ç§»åˆ° ç§»åŠ¨ç«¯Appå¼€å‘çš„ä½“éªŒï¼ˆWeexï¼Œç›®å‰åªæ˜¯ä¸€ä¸ª å°çš„ç©å…·ï¼Œ å¹¶æ²¡æœ‰å¾ˆæˆåŠŸçš„ å¤§æ¡ˆä¾‹ï¼›ï¼‰
+ Reactï¼Œç»“åˆ ReactNativeï¼Œä¹Ÿæä¾›äº†æ— ç¼è¿ç§»åˆ° ç§»åŠ¨Appçš„å¼€å‘ä½“éªŒï¼ˆRNç”¨çš„æœ€å¤šï¼Œä¹Ÿæ˜¯æœ€ç«æœ€æµè¡Œçš„ï¼‰ï¼›



> ç²¾è¾Ÿæ€»ç»“:  vue çš„ç”Ÿæ€æ›´å®˜æ–¹åŒ–, reactçš„ç”Ÿæ€æ›´ç¤¾åŒºåŒ–



## React çš„ä½¿ç”¨

### reactæ™®é€šhtmlä½¿ç”¨

1. å®‰è£…

- react: æ ¸å¿ƒåŒ…, åˆ›å»ºreactå…ƒç´ , åˆ›å»ºreactç»„ä»¶
- react-dom: æ¸²æŸ“reactå…ƒç´ /reactç»„ä»¶

```shell
yarn add react react-dom
```

2. å¼•å…¥

```html
// ä¼šæš´éœ²ä¸¤ä¸ªå…¨å±€å˜é‡ React , ReactDOM
<script src="./node_modules/react/umd/react.development.js"></script>
<script src="./node_modules/react-dom/umd/react-dom.development.js"></script>
```

3. åˆ›å»ºreactå…ƒç´ 
   - å‚æ•°1:  å…ƒç´ åç§°/æ ‡ç­¾å
   - å‚æ•°2:  å…ƒç´ çš„å±æ€§ `{}`, æ— å±æ€§ç»™`null`
   - å‚æ•°3:   æ–‡æœ¬å­èŠ‚ç‚¹æˆ–è€… domå­èŠ‚ç‚¹

```js

// react åˆ›å»ºå…ƒç´ 
let el = React.createElement(
    'div', 
    {
    titel: 'å˜»å˜»'
    },
    'hello React'
)
```

4. æ¸²æŸ“

```js
<div id="app"></div>

// ReactDOM æ¸²æŸ“reactå…ƒç´ 
æ¸²æŸ“
å‚æ•°1: è¦æ¸²æŸ“çš„å†…å®¹ reactå…ƒç´  / reactç»„ä»¶
å‚æ•°2: å®¹å™¨
ReactDOM.render(el, document.getElementById('app'))
```



### æ¨¡å—åŒ–åŸºæœ¬ä½¿ç”¨

1. è¿è¡Œ `cnpm i react react-dom -S` å®‰è£…åŒ…

   + reactï¼š ä¸“é—¨ç”¨äºåˆ›å»ºç»„ä»¶å’Œè™šæ‹ŸDOMçš„ï¼ŒåŒæ—¶ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸéƒ½åœ¨è¿™ä¸ªåŒ…ä¸­
   + react-domï¼š ä¸“é—¨è¿›è¡ŒDOMæ“ä½œçš„ï¼Œæœ€ä¸»è¦çš„åº”ç”¨åœºæ™¯ï¼Œå°±æ˜¯`ReactDOM.render()`

2. åœ¨`index.html`é¡µé¢ä¸­ï¼Œåˆ›å»ºå®¹å™¨ï¼š

   ```html
   <!-- å®¹å™¨ï¼Œå°†æ¥ï¼Œä½¿ç”¨ React åˆ›å»ºçš„è™šæ‹ŸDOMå…ƒç´ ï¼Œéƒ½ä¼šè¢«æ¸²æŸ“åˆ°è¿™ä¸ªæŒ‡å®šçš„å®¹å™¨ä¸­ -->
   <div id="app"></div>
   ```

3. å¯¼å…¥ åŒ…ï¼š**å®šä¹‰çš„æ¥æ”¶å˜é‡å¿…é¡»è¿™ä¹ˆå†™**

   ```js
   //åˆ›å»ºç»„ä»¶, è™šæ‹ŸDOMå…ƒç´ , ç”Ÿå‘½å‘¨æœŸ
   import React from 'react'
   //é‚£åˆ›å»ºçš„è™šæ‹ŸDOM, ç»„ä»¶æ”¾åˆ°é¡µé¢ä¸Šå±•ç¤º
   import ReactDOM from 'react-dom'
   ```

4. åˆ›å»ºè™šæ‹ŸDOMå…ƒç´ ï¼š

   ```jsx
   // è¿™æ˜¯ åˆ›å»ºè™šæ‹ŸDOMå…ƒç´ çš„ API    <h1 title="å•Šï¼Œäº”ç¯" id="myh1">ä½ æ¯”å››ç¯å¤šä¸€ç¯</h1>
   //  ç¬¬ä¸€ä¸ªå‚æ•°ï¼š å­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„æ ‡ç­¾çš„åç§°
   //  ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯¹è±¡ç±»å‹çš„å‚æ•°ï¼Œ è¡¨ç¤º åˆ›å»ºçš„å…ƒç´ çš„å±æ€§èŠ‚ç‚¹
   //  ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š æ–‡æœ¬å­èŠ‚ç‚¹æˆ–è€… domå­èŠ‚ç‚¹
   //  å‚æ•° n   :  å…¶ä»–å­èŠ‚ç‚¹ 	
   const myh1 = React.createElement('h1', { title: 'å•Šï¼Œäº”ç¯', id: 'myh1' }, 'ä½ æ¯”å››ç¯å¤šä¸€ç¯')
   ```


5. æ¸²æŸ“ï¼š

   ```js
   // 3. æ¸²æŸ“è™šæ‹ŸDOMå…ƒç´ 
   // å‚æ•°1ï¼š è¡¨ç¤ºè¦æ¸²æŸ“çš„è™šæ‹ŸDOMå¯¹è±¡
   // å‚æ•°2ï¼š æŒ‡å®šå®¹å™¨,æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½ç›´æ¥æ”¾ å®¹å™¨å…ƒç´ çš„Idå­—ç¬¦ä¸²ï¼Œéœ€è¦æ”¾ä¸€ä¸ªå®¹å™¨çš„DOMå¯¹è±¡
   ReactDOM.render(myh1, document.getElementById('app'))
   ```









## Reactçš„ä½¿ç”¨

### åŸºæœ¬ä½¿ç”¨

1. è¿è¡Œ `cnpm i react react-dom -S` å®‰è£…åŒ…

   + reactï¼š ä¸“é—¨ç”¨äºåˆ›å»ºç»„ä»¶å’Œè™šæ‹ŸDOMçš„ï¼ŒåŒæ—¶ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸéƒ½åœ¨è¿™ä¸ªåŒ…ä¸­
   + react-domï¼š ä¸“é—¨è¿›è¡ŒDOMæ“ä½œçš„ï¼Œæœ€ä¸»è¦çš„åº”ç”¨åœºæ™¯ï¼Œå°±æ˜¯`ReactDOM.render()`

2. åœ¨`index.html`é¡µé¢ä¸­ï¼Œåˆ›å»ºå®¹å™¨ï¼š

   ```html
   <!-- å®¹å™¨ï¼Œå°†æ¥ï¼Œä½¿ç”¨ React åˆ›å»ºçš„è™šæ‹ŸDOMå…ƒç´ ï¼Œéƒ½ä¼šè¢«æ¸²æŸ“åˆ°è¿™ä¸ªæŒ‡å®šçš„å®¹å™¨ä¸­ -->
   <div id="app"></div>
   ```

3. å¯¼å…¥ åŒ…ï¼š**å®šä¹‰çš„æ¥æ”¶å˜é‡å¿…é¡»è¿™ä¹ˆå†™**

   ```js
   //åˆ›å»ºç»„ä»¶, è™šæ‹ŸDOMå…ƒç´ , ç”Ÿå‘½å‘¨æœŸ
   import React from 'react'
   //é‚£åˆ›å»ºçš„è™šæ‹ŸDOM, ç»„ä»¶æ”¾åˆ°é¡µé¢ä¸Šå±•ç¤º
   import ReactDOM from 'react-dom'
   ```

4. åˆ›å»ºè™šæ‹ŸDOMå…ƒç´ ï¼š

   ```jsx
   // è¿™æ˜¯ åˆ›å»ºè™šæ‹ŸDOMå…ƒç´ çš„ API    <h1 title="å•Šï¼Œäº”ç¯" id="myh1">ä½ æ¯”å››ç¯å¤šä¸€ç¯</h1>
   //  ç¬¬ä¸€ä¸ªå‚æ•°ï¼š å­—ç¬¦ä¸²ç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„æ ‡ç­¾çš„åç§°
   //  ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯¹è±¡ç±»å‹çš„å‚æ•°ï¼Œ è¡¨ç¤º åˆ›å»ºçš„å…ƒç´ çš„å±æ€§èŠ‚ç‚¹
   //  ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š æ–‡æœ¬å­èŠ‚ç‚¹æˆ–è€… domå­èŠ‚ç‚¹
   //  å‚æ•° n   :  å…¶ä»–å­èŠ‚ç‚¹ 	
   const myh1 = React.createElement('h1', { title: 'å•Šï¼Œäº”ç¯', id: 'myh1' }, 'ä½ æ¯”å››ç¯å¤šä¸€ç¯')
   ```


5. æ¸²æŸ“ï¼š

   ```js
   // 3. æ¸²æŸ“è™šæ‹ŸDOMå…ƒç´ 
   // å‚æ•°1ï¼š è¡¨ç¤ºè¦æ¸²æŸ“çš„è™šæ‹ŸDOMå¯¹è±¡
   // å‚æ•°2ï¼š æŒ‡å®šå®¹å™¨,æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½ç›´æ¥æ”¾ å®¹å™¨å…ƒç´ çš„Idå­—ç¬¦ä¸²ï¼Œéœ€è¦æ”¾ä¸€ä¸ªå®¹å™¨çš„DOMå¯¹è±¡
   ReactDOM.render(myh1, document.getElementById('app'))
   ```




### åœ¨jsä¸­å®ç°DOMå…ƒç´ åµŒå¥—

```js
//åˆ›å»ºç»„ä»¶, è™šæ‹ŸDOMå…ƒç´ , ç”Ÿå‘½å‘¨æœŸ
import React from 'react'
//é‚£åˆ›å»ºçš„è™šæ‹ŸDOM, ç»„ä»¶æ”¾åˆ°é¡µé¢ä¸Šå±•ç¤º
import ReactDOM from 'react-dom'

//2-åˆ›å»ºè™šæ‹ŸDOM
const h1 = React.createElement('h1', {titel: 'è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªreactè™šæ‹ŸDOM'}, 'è¿™æ˜¯ä¸€ä¸ªh1')

// ä»ç¬¬ä¸‰ä¸ªå‚æ•°å¼€å§‹, éƒ½ç®—åšdivçš„å­èŠ‚ç‚¹, åŒ…å«æ–‡æœ¬èŠ‚ç‚¹
const div = React.createElement('div', null, 'è¿™æ˜¯ä¸€ä¸ªçˆ¶ç›’å­',h1)

//3-æ¸²æŸ“åˆ°é¡µé¢ä¸­
ReactDOM.render(div, document.querySelector('#app'))
```



## webpack 4.X

webpackæ˜¯åŸºäºnodeæ„å»ºçš„, æ”¯æŒæ‰€æœ‰çš„ Node API å’Œè¯­æ³•

1. è¿è¡Œ`yarn init -y` åˆå§‹åŒ–é¡¹ç›®
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º`src` æºä»£ç ç›®å½•å’Œ `dist` äº§å“ç›®å½•
3. åœ¨`src` ä¸‹æ–°å»ºä¸€ä¸ª`index.html` å’Œ `index.js` å…¥å£æ–‡ä»¶
4. `yarn add webpack webpack-cli -D`

5. **æ³¨æ„:** åœ¨webpack 4.xä¸­ æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹æ€§, å°±æ˜¯çº¦å®šå¤§äºé…ç½®, çº¦å®š  é»˜è®¤çš„æ‰“åŒ…å…¥å£æ–‡ä»¶è·¯å¾„æ˜¯ src -> index.js
   - ç›®çš„å°±æ˜¯å°½é‡å‡å°‘é…ç½®æ–‡ä»¶çš„ä½“ç§¯
   - æ‰“åŒ…å…¥å£æ–‡ä»¶æ—¶`index.js` 
   - æ‰“åŒ…çš„è¾“å‡ºæ–‡ä»¶æ—¶`dist/main.js`
   - æ–°å¢`mode` é…ç½®é€‰é¡¹å¿…é¡»é…ç½®:`production å’Œ development`



### module.exports å’Œ export default

éƒ½æ˜¯å‘å¤–å¯¼å‡ºæ¨¡å—çš„API , ä½†æ˜¯åœ¨webpack.config.jsé…ç½®æ–‡ä»¶ä¸­ä¸æ”¯æŒ`export default {}` 

- `export default {}` æ˜¯ES6 çš„æ–°è¯­æ³• , nodeéƒ½ä¸æ”¯æŒ

> *chromeæ”¯æŒçš„ES6+æ–°ç‰¹æ€§, nodeå°±æ”¯æŒ, å› ä¸ºnodeç”¨çš„æ˜¯chromeçš„V8å¼•æ“*
>
> chrome ä¸æ”¯æŒ export default



## webpack-dev-server

æ¯ä¸€æ¬¡ä¿®æ”¹ä»£ç éƒ½éœ€è¦é‡æ–°æ‰“åŒ…, webpack-dev-serverèƒ½å¤Ÿè‡ªåŠ¨æ‰“åŒ…, å¹¶åœ¨é¡¹ç›®çš„æ ¹ç›®å½•çš„å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ª`main.js` , æŠŠmain.jsæ‰˜ç®¡åˆ°å†…å­˜ä¸­

ä¸€äº›å¸¸è§é…ç½®:

- --open è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨

- --open firefox æŒ‡å®šæ‰“å¼€çš„æµè§ˆå™¨

- --port 3000 æŒ‡å®šç«¯å£

- --hot çƒ­æ›´æ–°

- --progress æ‰“åŒ…è¿›åº¦

- --compress åœ¨èµ°ç½‘ç»œçš„æ—¶å€™è¿›è¡Œå‹ç¼©

- --host èƒ½å¤ŸæŒ‡å®šåŸŸå

  

## html-webpack-plugin

html-webpack-plugin èƒ½å¤Ÿåœ¨ç½‘ç«™æ ¹ç›®å½•ä¸­æ ¹æ®æä¾›çš„æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª`index.html` å¹¶ä¸”è‡ªåŠ¨å¼•å…¥`main.js`

ä¼šå°†ç”Ÿæˆçš„`index.html` åœ¨å†…å­˜ä¸­ç”Ÿæˆå¹¶åœ¨å†…å­˜ä¸­æ‰˜ç®¡åˆ°å†…å­˜ä¸­

***åœ¨å†…å­˜ä¸­ç”Ÿæˆindex.htmlå¹¶æ‰˜ç®¡åˆ°ç½‘ç«™æ ¹ç›®å½•, è‡ªåŠ¨å¼•å…¥æ‰“åŒ…å¥½çš„main.js***

**é…ç½®**

```js
const htmlWebpackPlugin = require('html-webpack-plugin')
const path = require('path')

const htmlWebpack = new htmlWebpackPlugin({
  template: path.resolve(__dirname, 'src/index.html'),
  filename: 'index.html'
})

module.exports = {
  mode: 'production',
  plugins:[ 
    htmlWebpack
  ]
}
```



## React è„šæ‰‹æ¶

### å®‰è£…è„šæ‰‹æ¶

1. ä½¿ç”¨`npm`

``` js
ç¬¬ä¸€ç§ ä½¿ç”¨npm å…¨å±€å®‰è£…
$ npm i create-react-app -g

æŸ¥çœ‹ç‰ˆæœ¬å·
$ create-react-app -V

åˆå§‹åŒ–é¡¹ç›®
$ create-react-app react-demo 
```

2. npx  `å®˜ç½‘æ¨è`

`npx` ä¸€æ¡å‘½ä»¤, å®ç°äº†ä¸¤ä¸ªåŠ¨ä½œ, å®‰è£…è„šæ‰‹æ¶ + åˆå§‹åŒ–é¡¹ç›®

èƒ½å¤Ÿä¿è¯å…¨å±€åªæœ‰ä¸€ä¸ª è„šæ‰‹æ¶

```js
$ npx create-react-app é¡¹ç›®å
```

### åˆ›å»ºä¸€ä¸ªé¡¹ç›®

```js
npx create-react-app react-demo
```

### è¿è¡Œé¡¹ç›®

```js
yarn start
```



### é¡¹ç›®ç›®å½•

- `src/`
  - `index.js` å…¥å£æ–‡ä»¶
- `public/`
  - `index.html` å…¥å£é¡µé¢, é¡¹ç›®å¯åŠ¨é¦–å…ˆè®¿é—®`index.html` å…¥å£é¡µé¢ä¸­å»å¼•å…¥`index.js` å…¥å£æ–‡ä»¶



## JSXè¯­æ³•

### é…ç½®jsxè¯­æ³•babel

+ å®‰è£… `babel` æ’ä»¶

  - è¿è¡Œ`cnpm i babel-core babel-loader babel-plugin-transform-runtime -D`
  - è¿è¡Œ`cnpm i babel-preset-env babel-preset-stage-0 -D`

+ å®‰è£…èƒ½å¤Ÿè¯†åˆ«è½¬æ¢jsxè¯­æ³•çš„åŒ… `babel-preset-react` 

  + è¿è¡Œ`cnpm i babel-preset-react -D`

+ æ·»åŠ  `.babelrc` é…ç½®æ–‡ä»¶

  ```json
  {
    "presets": ["env", "stage-0", "react"],
    "plugins": ["transform-runtime"]
  }
  ```

+ æ·»åŠ babel-loaderé…ç½®é¡¹ï¼š

  ```js
  module: { //è¦æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹æ¨¡å—
      rules: [
        { test: /\.js|jsx$/, use: 'babel-loader', exclude: /node_modules/ }
      ]
  }
  ```

  

#### babel 6 çš„é…ç½®æ–¹æ³•

å®‰è£…loader

```js
yarn add babel-core babel-loader@7 babel-plugin-transform-runtime -D
yarn add babel-preset-env babel-preset-stage-0 -D
yarn add babel-preset-react -D
```

æ·»åŠ  `.babelrc` é…ç½®æ–‡ä»¶

```json
{
  "presets": ["env", "stage-0", "react"],
  "plugins": ["transform-runtime"]
}
```

æ·»åŠ babel-loaderé…ç½®é¡¹ï¼š

```js
module: { //è¦æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹æ¨¡å—
    rules: [
      { test: /\.js|jsx$/, use: 'babel-loader', exclude: /node_modules/ }
    ]
}
```



#### babel 7 é…ç½®æ–¹æ³•

å®‰è£…loader   ------------> ä¸å¯è¡Œ

```shell
#babel æ’ä»¶
$ yarn add @babel/core babel-loader @babel/plugin-transform-runtime -D
$ yarn add @babel/preset-env @babel/preset-stage-0 -D	

#è¯­æ³•æ’ä»¶
$ yarn add @babel/preset-react -D

#æ‰§è¡Œå‘½ä»¤
$ cnpm i @babel/plugin-proposal-class-properties -D
$ cnpm i @babel/runtime -D
```

æ·»åŠ  `.babelrc` é…ç½®æ–‡ä»¶

```json
{
  "presets": ["@babel/preset-env","@babel/preset-react", "@babel/preset-stage-0"],
  "plugins": ["@babel/plugin-transform-runtime","@babel/plugin-proposal-class-properties"]	
}
```

æ·»åŠ babel-loaderé…ç½®é¡¹ï¼š

```js
module: { //è¦æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹æ¨¡å—
    rules: [
      { test: /\.js|jsx$/, use: 'babel-loader', exclude: /node_modules/ }
    ]
}
```



### ä»€ä¹ˆæ˜¯jsxè¯­æ³•

æ˜¯ä¸€ä¸ªjavascript çš„ä¸€ä¸ªè¯­æ³•æ‰©å±•

> å°±æ˜¯ç¬¦åˆ xml è§„èŒƒ çš„ js è¯­æ³•;  ( è¯­æ³•æ ¼å¼ç›¸å¯¹æ¥è¯´,è¦æ¯”htmlä¸¥è°¨çš„å¤š )

å¯¹äºæ„é€ UIç»“æ„æ¥è¯´, htmlæ˜¯æœ€ä¸ºåˆé€‚ä¸è¿‡çš„æ ‡è®°è¯­è¨€äº†

ä½†æ˜¯åœ¨JSæ–‡ä»¶ä¸­ä¸èƒ½å†™ html è¯­è¨€  ,  ä½†æ˜¯å¯ä»¥ä½¿ç”¨ babel æ¥è½¬æ¢ è¿™äº› JS ä¸­çš„ html æ ‡ç­¾

> ä½œç”¨: å¯ä»¥åœ¨jsä¸­å†™ html

**jsxè¯­æ³•çš„æœ¬è´¨: åœ¨è¿è¡Œçš„æ—¶å€™, æœ€ç»ˆè¿˜æ˜¯è¢«babelè½¬æ¢æˆäº† React.createElement å½¢å¼ç”Ÿæˆçš„, è¯­æ³•ç³–**



### jsxè¯­æ³•

- jsx åªå…è®¸ä¸€ä¸ªè·Ÿæ ‡ç­¾å’Œ`vue` ä¸­çš„ `template` ä¸€æ · , ä¹Ÿå¯ä»¥ä½¿ç”¨ç©ºæ ‡ç­¾`<></>`åŒ…è£¹
- jsx é‡Œé¢çš„ä»£ç ç»“æ„æ¯”è¾ƒå¤æ‚çš„æ—¶å€™, æ¨èä½¿ç”¨åœ¨å¤–é¢`()`åŒ…è£¹èµ·æ¥, æŠŠå†…å®¹å½“æˆä¸€ä¸ªæ•´ä½“ 



### jsxä¸­åµŒå…¥è¡¨è¾¾å¼

- å½“æˆ‘ä»¬åœ¨jsxæ§åˆ¶çš„åŒºåŸŸå†…, ä½¿ç”¨jså˜é‡,æˆ–è€…è¡¨è¾¾å¼, åˆ™éœ€è¦å†™åœ¨`{  }` ä¸­, ç±»ä¼¼vueä¸­çš„æ’å€¼è¡¨è¾¾å¼`{{  }}`
- `{}` æ’å€¼ä¸­å¯ä»¥æ”¾(è¡¨è¾¾å¼)
  - è¿ç®—
  - ä¸‰å…ƒè¡¨è¾¾å¼
  - å‡½æ•°è°ƒç”¨
- `{}` ä¸å¯ä»¥æ”¾è¯­å¥
  - if è¯­å¥ for è¯­å¥ ç­‰ç­‰
- è¯­å¥å’Œ è¡¨è¾¾å¼çš„åŒºåˆ«
  - è¡¨è¾¾å¼éƒ½æœ‰è¿”å›å€¼, è¯­å¥æ²¡æœ‰è¿”å›å€¼

```jsx
let a = 10
const div = <div>è¿™æ˜¯ä¸€ä¸ªdiv { a + 2 } </div>
```



- åœ¨vue ä¸­æ ‡ç­¾çš„å±æ€§èµ‹å€¼éœ€è¦ä½¿ç”¨`v-bind`ä¸èƒ½ä½¿ç”¨`{{}}` , åœ¨react å¯ä»¥åœ¨å±æ€§ä¸­ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼`{}`

```js
const h1 = <h1 title={ title }>å“ˆå“ˆå“ˆ </h1>
```





- jsxä¸­ä½¿ç”¨ å¸ƒå°”å€¼, å­—ç¬¦ä¸²å˜é‡, æ•°ç»„

```js
import React from 'react'
import ReactDOM from 'react-dom'

//æŠŠæ•°ç»„é‡Œçš„å­—ç¬¦ä¸²å˜æˆä¸€ä¸ªh3æ ‡ç­¾æ”¾å…¥åˆ°é¡µé¢ä¸­
const nameArr = ['å°å‚»å­', 'å¤§å‚»å­', 'çš®çš®è™¾']

const nameObj = {
  name: 'å°å‚»å­',
  age: 18
}
const flag = true

const arr = [
  <div>è¿™ä¸€ä¸ªæ•°ç»„</div>,
  <div>è¿™ä¸€ä¸ªæ•°ç»„</div>
]

const div = <div>
  {/* æ¸²æŸ“ä¸€ä¸ªå¸ƒå°”å€¼ */}
  { flag ? 'true' : 'false' }

  {/* æ¸²æŸ“æ•°ç»„æ¯ä¸€é¡¹ */}
  { nameArr.map(item => <h3>{ item }</h3>) }
  <hr />
  {/* { nameArr } */}
  <h1  title={nameObj.age}>{ nameObj.name } </h1>

  <hr />
  { arr }

</div>

ReactDOM.render(div, document.querySelector('#app'))
```



### jsxä¸­çš„æ³¨é‡Š

```jsx
{/*  è¿™æ˜¯jsxçš„æ³¨é‡Š */}
{
  //è¿™æ ·å†™æ³¨é‡Šä¹Ÿå¯ä»¥
}
```



### jsxä¸­ä¸ºå…ƒç´ æ·»åŠ class , for

åœ¨jsxç¯å¢ƒä¸­ä¸ºå…ƒç´ æ·»åŠ classä½†æ˜¯ä¸èƒ½ä½¿ç”¨ class , éœ€è¦ä½¿ç”¨`className` ä»£æ›¿`class`

> *å› ä¸ºclassæ˜¯jsçš„å…³é”®å­—*
>
> label æ ‡ç­¾çš„ for åº”è¯¥ç”¨htmlFor ä»£æ›¿



### jsxä¸­çš„labelçš„forå±æ€§

`for` ä¹Ÿæ˜¯jsä¸­çš„å…³é”®å­—, æ‰€ä»¥åœ¨jsxä¸­ä¹Ÿä¸èƒ½ä½¿ç”¨, éœ€è¦ç”¨`htmlFor` æ›¿ä»£

### jsxåˆ›å»ºDOM

åœ¨jsxåˆ›å»ºDOMçš„æ—¶å€™,æ‰€æœ‰çš„èŠ‚ç‚¹ å¿…é¡»æœ‰å”¯ä¸€çš„æ ¹å…ƒç´ åŒ…è£¹, ç±»ä¼¼vueä¸­çš„`template`

```jsx
  <p className="jsx">è¿™æ˜¯jsxä¸­çš„å…ƒç´ </p>
  <label htmlFor="#label">è¿™æ˜¯jsxä¸­çš„label</label>
```





## è™šæ‹ŸDOM

### çœŸå®DOMçš„è§£ææµç¨‹

#### **DOMæ•°æ®æ¥æº?**

>  ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥åŸŸåç‚¹å‡»å›è½¦, éƒ½å‘ç”Ÿäº†ä»€ä¹ˆäº‹?

![](E:/Vue/image/æ•²å›è½¦åšçš„äº‹æƒ….png)

1. æµè§ˆå™¨ä¼šè§£æåŸŸå, ä¼šå…ˆä»æœ¬åœ°çš„hostæ–‡ä»¶ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰åŸŸåå¯¹åº”çš„IP åœ°å€, æœ‰åˆ™å¯¹è¿™ä¸ªIPå‘èµ·httpè¯·æ±‚

æ²¡æœ‰åˆ™å‘DNSæœåŠ¡å™¨å‘é€è¯·æ±‚, è·å¾—åŸŸåå¯¹åº”çš„IPåœ°å€, å¯¹è¿™ä¸ªIPå‘èµ·httpè¯·æ±‚

2. æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚, ä¼šè¿™ä¸ªå¤„ç†è¯·æ±‚, æŠŠå“åº”ç»“æœç»™å®¢æˆ·ç«¯æµè§ˆå™¨
3. æµè§ˆå™¨æ‹¿åˆ°å“åº”, è¿›è¡Œå¤„ç†



#### **æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹**

æˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°æœåŠ¡å™¨å“åº”çš„ä¸€ä¸ªhtmlé¡µé¢çš„å­—ç¬¦ä¸², å‰åç«¯äº¤äº’çš„æœ¬è´¨ä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²äº¤äº’, å®¢æˆ·ç«¯å‘è¯·æ±‚, åå°æœåŠ¡å™¨å“åº”

å½“ç„¶ajaxè¯·æ±‚, å‰ç«¯èƒ½å¤Ÿå¾—åˆ°jsonæ•°æ®æ ¼å¼, ä½†æ˜¯è¿™äº›æ•°æ®æœ€ç»ˆè¿˜æ˜¯è¦æ¸²æŸ“åˆ°htmlé¡µé¢ä¸Š, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯·æ±‚è¯·æ±‚ä¸€ä¸ªç½‘ç«™, æœåŠ¡å™¨å¿…å®šä¼šå“åº”ä¸€ä¸ªhtmlå­—ç¬¦ä¸²

æµè§ˆå™¨æ‹¿åˆ°htmlé¡µé¢çš„å­—ç¬¦ä¸², è¿›è¡Œè§£æ, é‡åˆ° link, a, scriptç­‰ä¼šå‘èµ·äºŒæ¬¡è¯·æ±‚

æµè§ˆå™¨ä¸ºäº†æ•ˆç‡ä¸ä¼šç­‰å¾…æœåŠ¡å™¨çš„å“åº”ä¼šç»§ç»­å‘ä¸‹è§£æ

![](image/çœŸå®DOMæ ‘.png)

å½“cssç­‰æ–‡ä»¶å›æ¥ä¹‹å, ä¼šåœ¨å†…å­˜ä¸­åŒæ­¥è§£æcssä»£ç , ä¼šå½¢æˆä¸€ä¸ª style rules => css tree

è§£æ html ä¼šå¾—åˆ°ä¸€ä¸ª DOM tree

æµè§ˆå™¨æœ€ç»ˆä¼šæŠŠ`css tree `å’Œ `DOM tree` å…³è”èµ·æ¥å½¢æˆä¸€ä¸ª `render tree` , ç„¶åç»˜åˆ¶åˆ°é¡µé¢ä¸Š



#### JSæ“ä½œçœŸå®DOMçš„ä»£ä»·

ç”¨åŸç”Ÿçš„JSæˆ–è€…`jquery`æ“ä½œDOMä»£ä»·è¾ƒå¤§, ä¸¾ä¸ªæ —å­, æˆ‘ä»¬åœ¨ç”µå•†å…¨ç«¯çš„æ—¶å€™, åšè¿‡æœ€å¤šçš„ä¸€ä»¶äº‹å°±æ˜¯å‘é€ajax, æ‹¿åˆ°æ•°æ®æŠŠæ•°æ®é‡æ–°æ¸²æŸ“åˆ°é¡µé¢ä¸Š

å¸¦æ¥çš„é—®é¢˜?

å¯èƒ½æˆ‘ä»¬çš„ä¸€ä¸ªæ“ä½œ, åªæ˜¯æ”¹å˜äº†è¿™ä¸ªç»“æ„ä¸­å¾ˆå°‘çš„ä¸€éƒ¨åˆ†, å¯¹äºå¤§éƒ¨åˆ†ç»“æ„éƒ½æ˜¯æœªæ”¹å˜çš„, ä½†æ˜¯æµè§ˆå™¨ä¼šæŠŠä¹‹å‰çš„å†…å®¹å…¨éƒ¨å¹²æ‰, é‡æ–°æ¸²æŸ“DOMç»“æ„, ç³»ç»Ÿå¼€é”€å¾ˆå¤§



**è¿™ä¸ªæ—¶å€™è™šæ‹ŸDOMåº”æ™¯è€Œç”Ÿ**

### è™šæ‹ŸDOM

åœ¨vueä¸­å’Œreactä¸­éƒ½æåˆ°äº†è™šæ‹ŸDOM, åªæ˜¯åœ¨vueä¸­æˆ‘ä»¬å¾ˆå°‘å…³æ³¨è™šæ‹ŸDOM, è™šæ‹ŸDOMæ˜¯éšç€reactçš„è¯ç”Ÿè€Œè¯ç”Ÿ

ä½†æ˜¯äº†è§£äº†è™šæ‹ŸDOMçš„åŸç†,èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¾ˆå¥½çš„äº†è§£MVVMæ¡†æ¶å®ç°ä¸€äº›åŠŸèƒ½çš„åº•å±‚åŸç†



 è™šæ‹ŸDOMå°±æ˜¯ä¸ºäº†**è§£å†³æµè§ˆå™¨æ€§èƒ½é—®é¢˜**è€Œè¢«è®¾è®¡å‡ºæ¥çš„ , æ¯”å¦‚,  è‹¥ä¸€æ¬¡æ“ä½œä¸­æœ‰10æ¬¡æ›´æ–°DOMçš„åŠ¨ä½œï¼Œè™šæ‹ŸDOMä¸ä¼šç«‹å³æ“ä½œDOM ,  è€Œæ˜¯å°†è¿™10æ¬¡æ›´æ–°çš„diffå†…å®¹ä¿å­˜åˆ°æœ¬åœ°ä¸€ä¸ªJSå¯¹è±¡ä¸­ï¼Œæœ€ç»ˆå°†è¿™ä¸ªJSå¯¹è±¡ä¸€æ¬¡æ€§attchåˆ°DOMæ ‘ä¸Šï¼Œå†è¿›è¡Œåç»­æ“ä½œï¼Œé¿å…å¤§é‡æ— è°“çš„è®¡ç®—é‡ 

**é‚£ä¹ˆè¿™å°±èƒ½è§£é‡Šä¸ºä»€ä¹ˆvueä¸­ DOMçš„æ›´æ–°æ˜¯å¼‚æ­¥çš„äº†** é¿å…äº†æˆ‘ä»¬æˆ‘ä»¬çŸ­æ—¶é—´å†…æ“ä½œå¤šæ¬¡DOM, å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—



#### ä»€ä¹ˆæ˜¯è™šæ‹ŸDOM

**æˆ‘çš„ç†è§£: è™šæ‹ŸDOMå°±æ˜¯æˆ‘ä»¬ç¨‹åºå‘˜ç”¨JSçš„å¯¹è±¡æ¨¡æ‹Ÿé¡µé¢ä¸­çš„çœŸå®DOMç»“æ„å’ŒDOMåµŒå¥—**

![](image/è™šæ‹ŸDOMå¯¹æ¯”çœŸå®DOM.png)



**å¸¦æ¥çš„å¥½å¤„: æŒ‰éœ€æ›´æ–°**

å½“æˆ‘ä»¬æ“ä½œDOMæ—¶,å¯ä»¥å…¨éƒ¨æ˜ å°„åˆ°è™šæ‹ŸDOMä¸Š, æˆ‘ä»¬èƒ½å¤Ÿæ‰‹åŠ¨çš„æ¨¡æ‹Ÿæ–°æ—§ä¸¤é¢—DOMæ ‘, è¿›è¡Œdiffå¯¹æ¯”, å®ç°é«˜æ•ˆæ›´æ–°



#### è™šæ‹ŸDOMçš„æœ¬è´¨å’Œç›®çš„

æœ¬è´¨: ç”¨JSå¯¹è±¡, æ¥æ¨¡æ‹ŸçœŸå®DOMå…ƒç´ çš„åµŒå¥—å…³ç³»

ç›®çš„:  å®ç°é¡µé¢å…ƒç´ çš„é«˜æ•ˆæ›´æ–°

> jsx => è™šæ‹ŸDOM => çœŸå®DOM

jsxæ•°æ®å‘ç”Ÿå˜åŒ–ä¹‹å

> äº§ç”Ÿæ–°è™šæ‹ŸDOMæ ‘ => æ–°æ—§DOMæ ‘diffå¯¹æ¯”  => æ‰¾åˆ°å·®å¼‚çš„



## Diffç®—æ³•

> diff => different å·®å¼‚, ä¸åŒ

Reactä¸­çš„ä¸¤ç§å‡å®š

- ä¸¤ä¸ªä¸åŒç±»å‹çš„å…ƒç´ , ä¼šäº§ç”Ÿä¸åŒè™šæ‹ŸDOMæ ‘

### tree diff

ä¸¤ä¸ªæ–°æ—§DOMæ ‘,  é€å±‚å¯¹æ¯”çš„è¿‡ç¨‹å°±æ˜¯`tree diff`,  å½“æ•´é¢—DOMé€å±‚å¯¹æ¯”å®Œæ¯•, åˆ™éœ€è¦æŒ‰éœ€æ›´æ–°çš„å…ƒç´ , å¿…ç„¶èƒ½å¤Ÿæ‰¾åˆ°

### component diff

åœ¨è¿›è¡ŒTree Diff çš„æ—¶å€™, æ¯ä¸€å±‚ä¸­, éƒ½æœ‰ä¸åŒçš„ç»„ä»¶, (å¤´éƒ¨ç»„ä»¶, è½®æ’­å›¾ç»„ä»¶ç­‰ç­‰) ç»„ä»¶çº§åˆ«çš„å¯¹æ¯”, å«åš**Component Diff**

- å¦‚æœå¯¹æ¯”å‰å, ç»„ä»·ç±»å‹ç›¸åŒ, åˆ™æš‚æ—¶è®¤ä¸ºæ¬¡ç»„ä»¶ä¸éœ€è¦è¢«æ›´æ–°
- å¦‚æœå¯¹æ¯”å‰å, ç»„ä»¶ç±»å‹ä¸åŒ, åˆ™éœ€è¦ç§»é™¤æ—§ç»„ä»¶, å¹¶è¿½åŠ åˆ°é¡µé¢ä¸Š

### element diff

åœ¨è¿›è¡Œç»„ä»¶å¯¹æ¯”çš„æ—¶å€™, å¦‚æœä¸¤ä¸ªç»„ä»¶ç±»å‹ç›¸åŒ, åˆ™éœ€è¦è¿›è¡Œå…ƒç´ çº§åˆ«çš„å¯¹æ¯”

![](image/diff.png)

## ä¸‰å¤§æ¡†æ¶çš„æ›´æ–°æœºåˆ¶: é¢è¯•é¢˜

angular

- è„æ£€æŸ¥æœºåˆ¶
- vue æ¨¡ä»¿angular , åŒå‘æ•°æ®ç»‘å®š, æŒ‡ä»¤

react

- è™šæ‹ŸDOMæ›´æ–°æœºåˆ¶

- jsx => è™šæ‹ŸDOM => çœŸå®DOM
- æ•°æ®å‘ç”Ÿå˜åŒ– => äº§ç”Ÿæ–°è™šæ‹ŸDOMæ ‘ => é€šè¿‡diff æ¯”å¯¹ æ–°æ—§è™šæ‹ŸDOM => ä¿®æ”¹å·®å¼‚çš„åœ°æ–¹ 

Vue

- ç»†ç²’åº¦æ›´æ–° : ä¸€ä¸ªæ•°æ®å¯¹åº”ä¸€ä¸ª`Watcher`
  - data( name )æ•°æ® => observer( defineReactive  æ•°æ®å“åº”å¼ ( defineProperty æ•°æ®åŠ«æŒ ) ) => dataæ•°æ® å…·æœ‰`getter setter`
  - å½“æ•°æ®`name`è¢«ä½¿ç”¨çš„æ—¶å€™ => getter =>  Watcher(name) æŠŠæ•°æ®è®°å½•åˆ°  => Dep ä¾èµ–` []`
  - å½“æ•°æ®`name`è¢«ä¿®æ”¹çš„æ—¶å€™ => setter  => éå†Dep => æ‰¾åˆ°å¯¹åº”çš„Watcher => é€šçŸ¥å¤–ç•Œ => è®©å¤–ç•Œæ›´æ–°é¡µé¢
- ä¸­ç­‰ç²’åº¦æ›´æ–°: ä¸€ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ª`Watcher`
  - `name` æ•°æ®å‘ç”Ÿå˜åŒ– => Watcher => ç»„ä»¶ => è™šæ‹ŸDOM
    - ä¸€ä¸ªç»„ä»¶ å¯¹åº”ä¸€ä¸ª Watcher å¯¹åº”ä¸€ä¸ª è™šæ‹ŸDOMæ ‘
  - vueä¸­çš„`template`  => render => è™šæ‹ŸDOM







# React ç¬¬äºŒå¤©

## Reactä¸­åˆ›å»ºå‡½æ•°ç»„ä»¶

### å‡½æ•°ç»„ä»¶

ä¸€ä¸ªæ„é€ å‡½æ•°å°±æ˜¯ä¸€ä¸ªç»„ä»¶, ä½†æ˜¯ç»„ä»¶å¿…é¡»æœ‰return , å¦‚æœç»„ä»¶å†…å®¹ä¸ºç©º`return null`

1. **åˆ›å»ºç»„ä»¶, ä¸€ä¸ªæ„é€ å‡½æ•°å°±æ˜¯ä¸€ä¸ªç»„ä»¶(ç»„ä»¶é¦–å­—æ¯å¿…é¡»å¤§å†™)**
2. **ä»¥æ ‡ç­¾å½¢å¼å¼•å…¥ç»„ä»¶, å¹¶ä¸”å¯ä»¥ä¼ å€¼, åœ¨æ„é€ å‡½æ•°ä¸­æ¥æ”¶, æ ‡ç­¾å¯ä»¥æ˜¯å•æ ‡ç­¾å¯ä»¥æ˜¯åŒæ ‡ç­¾**
- é…åˆ`ES6` ä¸­çš„å±•å¼€è¿ç®—ç¬¦ä¼ å‚
   - `props` æ˜¯åªè¯»çš„, ä¸ç®¡æ˜¯ç®€å•æ•°æ®ç±»å‹, è¿˜æ˜¯å¤æ‚æ•°æ®ç±»å‹, éƒ½ä¸å…è®¸ä¿®æ”¹
- åœ¨vueä¸­ å¯¹äºå¤æ‚æ•°æ®ç±»å‹çš„propsèƒ½å¤Ÿä¿®æ”¹
3. å‡½æ•°ç»„ä»·å†…éƒ¨ä¸€å®šè¦æœ‰`return` è¿”å›å€¼

   - å¦‚æœæ²¡æœ‰æ¸²æŸ“å†…å®¹: `return null`
   - æœ‰å†…å®¹`return JSXæ¨¡æ¿`
4. JSXçš„æ³¨æ„ç‚¹:
   - åªèƒ½æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹
   - å¦‚æœç»“æ„å¤æ‚, å¤–é¢ç”¨`()` åŒ…èµ·æ¥

**ç»„ä»¶ä¼ å‚**

- ä¼ å€¼å¯ä»¥åœ¨ç»„ä»¶æ ‡ç­¾ä¸Šç›´æ¥ä¼ å‚ `name={ä¼ é€’çš„å‚æ•°}`
- åœ¨å‡½æ•°ç»„ä»¶ä¸Š, ç›´æ¥é€šè¿‡`props` æ¥æ”¶å¤–ç•Œä¼ æ¥çš„å‚æ•°  

```jsx
import React from 'react'
import ReactDOM from 'react-dom'

const dog = {
  name: 'å°é»‘',
  age: 3,
  gender: 'é›Œ'
}

// 1.åˆ›å»ºä¸€ä¸ªHelloç»„ä»¶
//å¤–ç•Œä¼ çš„å€¼, éœ€è¦åœ¨æ„é€ å‡½æ•°ä¸­æ¥æ”¶, æ¥æ”¶ä¹‹åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨  æ³¨æ„ç»„ä»¶åå¿…é¡»å¤§å†™
function Hello(props) {
  #ç»„ä»¶çš„propsæ˜¯åªè¯»çš„  
  return <div>è¿™æ˜¯Helloç»„ä»¶ --- {props.name} --- {props.age} --- {props.gender} </div>
}

ReactDOM.render(<div>
  {/*  2.åƒåœ¨vueä¸­ä¸€æ ·, ä»¥æ ‡ç­¾å½¢å¼å¼•å…¥ç»„ä»¶  å¹¶ä¸”å¯ä»¥ç»™ç»„ä»¶ä¼ å€¼ */}
  <Hello name={dog.name} age={dog.age} gender={dog.gender}></Hello>
        
  {/* ä½¿ç”¨ES6 çš„å±•å¼€è¿ç®—ç¬¦ */}      
   <Hello {...dog}></Hello>     
</div>, document.querySelector('#app'))
```



### æŠ½ç¦»åˆ°jsxæ–‡ä»¶åˆ›å»ºç»„ä»¶

æŠŠ ç»„ä»¶æŠ½ç¦»ä¸ºä¸€ä¸ªå•ç‹¬çš„`.jsx`æ–‡ä»¶

> **ç¡®ä¿, webpackèƒ½å¤Ÿè§£æjsxçš„æ–‡ä»¶, webpack.config.jså¿…é¡»é…ç½® rules**

1. å°†ç»„ä»¶æŠ½ç¦»åˆ°`jsx`æ–‡ä»¶ä¸­

```jsx
import React from 'react'

//åˆ›å»ºå¹¶å¯¼å‡ºä¸€ä¸ªHelloç»„ä»¶
export default function Hello(props) {

  // props.name = 'å¤§é»„'
  return <div>è¿™æ˜¯Helloç»„ä»¶ --- {props.name} --- {props.age} --- {props.gender} </div>
}
```

2. åœ¨`index.js` å…¥å£æ–‡ä»¶ä¸­ å¯¼å…¥ç»„ä»¶`import`

```js
import React from 'react'
import ReactDOM from 'react-dom'

const dog = {
  name: 'å°é»‘',
  age: 3,
  gender: 'é›Œ'
}

//å¯¼å…¥ç»„ä»¶==================================================å¯¼å…¥ç»„ä»¶
//å¹¶ä¸”åç¼€ååœ¨æ²¡æœ‰é…ç½®çš„æƒ…å†µä¸‹æ˜¯ä¸èƒ½çœç•¥çš„
import Hello from './components/index.jsx'

ReactDOM.render(<div>
  {/* <Hello name={dog.name} age={dog.age} gender={dog.gender}></Hello> */}
  <Hello {...dog}></Hello>

</div>, document.querySelector('#app'))
```



## å¯¼å…¥æ—¶çœç•¥.jsxæ–‡ä»¶çš„åç¼€å

åœ¨`webpack.config.js`ä¸­é…ç½® `resolve: { extensions: [] }` 

> æˆ‘ä»¬åœ¨reacté¡¹ç›®ä¸­å¯ä»¥é…ç½®.jsx, åœ¨vueä¸­åˆ™å¯ä»¥é…ç½®.vueçœç•¥åç¼€å
>
> æˆ‘ä»¬é…ç½®çš„`webpack.config.js` èƒ½å¤Ÿè¦†ç›–è„šæ‰‹æ¶é»˜è®¤çš„é…ç½®

```js
//å’Œ mode, plugins, entry å¹³çº§çš„å±æ€§
resolve: {
    //è¡¨ç¤ºè¿™å‡ ä¸ªæ–‡ä»¶çš„åç¼€åå¯ä»¥çœç•¥, ä¼šè‡ªåŠ¨è¡¥å…¨åç¼€, é¡ºåºæ˜¯ä»å‰åˆ°å
    extensions: ['.js', '.jsx', '.json'] 
}
```



## ä½¿ç”¨`@` ä»£æ›¿ `src` è¿™ä¸€å±‚è·¯å¾„

æœ‰æ—¶å€™æˆ‘ä»¬å¼•å…¥ç»„ä»¶è¿˜å¯ä»¥ä½¿ç”¨ `@` å¼€å¤´

å¯ä»¥ä½¿ç”¨`alias` æ˜¯ä¸€ä¸ªå¯¹è±¡, åˆ«åçš„æ„æ€

```js
#å¼•å…¥ç»„ä»¶çš„æ—¶å€™, ä»¥@å¼€å¤´
import Hello from '@/components/index'

#åœ¨webpack.config.jsä¸­çš„é…ç½®
  resolve: {
    extensions: ['.js', '.jsx', '.json'],
    alias: {
      "@": path.join(__dirname, './src')
    }
  }
```



## classç±»åˆ›å»ºç»„ä»¶

ES6 ä¸­class æ˜¯å®ç°ç±»çš„ä¸€ç§æ–¹æ³•, `class` æœ¬èº«æ˜¯ä¸€ä¸ªè¯­æ³•ç³–

### ç±»çš„åŸºæœ¬ä½¿ç”¨

1. `class` å®šä¹‰çš„ç±»å’Œ æ„é€ å‡½æ•°ä¸€æ ·, å¯ä»¥`new`  ä¸€ä¸ªå¯¹è±¡
2. `constructor` å±æ€§èƒ½å¤Ÿå®šä¹‰å®ä¾‹å±æ€§, `new` çš„æ—¶å€™ä¼šä¼˜å…ˆæ‰§è¡Œ`constructor` çš„ä»£ç , **æ¯ä¸€ä¸ªå¿…é¡»æœ‰æ„é€ å™¨**
3. `static` æ˜¯é™æ€å±æ€§, ç±»ä½œä¸ºå¯¹è±¡, ä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„å±æ€§

```js
class Animal {
  //å¦‚æœä¸å†™constructor, é»˜è®¤å°±æ˜¯ä¸€ä¸ª  constructor () { }
  //æ¯å½“newçš„æ—¶å€™, ä¼šä¼˜å…ˆæ‰§è¡Œæ„é€ å™¨ä¸­çš„ä»£ç , èƒ½å¤Ÿæ¥å—å®å‚
  constructor(name, age) { //ç›¸å½“æ™®é€šçš„æ„é€ å‡½æ•°  constructorä¸­çš„å±æ€§å°±æ˜¯å®ä¾‹å±æ€§
    //this.name, this.age ä¹Ÿå«åšå®ä¾‹å±æ€§, newä¹‹å, å®ä¾‹å¯¹è±¡è‡ªå·±èº«ä¸Šå°±æœ‰
    this.name = name 
    this.age = age
  }

  // é™æ€å±æ€§: é€šè¿‡æ„é€ å‡½æ•°ç›´æ¥è®¿é—®çš„å±æ€§, æ„é€ å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡, ä¹Ÿå¯æœ‰è‡ªå·±çš„å±æ€§
  static info = 'è¿™æ˜¯Animalçš„é™æ€å±æ€§' 
}

let a1 = new Animal('å¤§é»„', 3)
console.log(a1) 
console.log(Animal.info)

```



### ç±»æ·»åŠ å®ä¾‹æ–¹æ³•

ä¹Ÿå°±æ˜¯ç»™ç±»(æ„é€ å‡½æ•°) åŸå‹ä¸Šæ·»åŠ æ–¹æ³•, å®ä¾‹å¯¹è±¡èƒ½å¤Ÿç›´æ¥ `.` å‡ºæ¥çš„æ–¹æ³•, ä¹Ÿå«åšå®ä¾‹æ–¹æ³•

ä½œç”¨å’Œ åœ¨æ„é€ å‡½æ•°çš„`Animal.prototype.eat = function () {}` åšä½œç”¨ç›¸åŒ

ä¸¤ç§æ–¹å¼éƒ½èƒ½å¤Ÿç»™å®ä¾‹æ·»åŠ æ–¹æ³•, **ä¸€ä¸ªæ˜¯ç›´æ¥æ·»åŠ åˆ°å®ä¾‹å¯¹è±¡èº«ä¸Š, ä¸€ä¸ªæ·»åŠ åˆ°å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹ä¸Š**

```js
class Animal {
  constructor(name, age) { //ç›¸å½“æ™®é€šçš„æ„é€ å‡½æ•°  constructorä¸­çš„å±æ€§å°±æ˜¯å®ä¾‹å±æ€§
    this.name = name 
    this.age = age
    //è¿™æ˜¯ç›¸å½“äºç›´æ¥ç»™å®ä¾‹æ·»åŠ å®ä¾‹æ–¹æ³•---------------
    this.show = function () {
      console.log('ç›´æ¥æ·»åŠ åœ¨å®ä¾‹å¯¹è±¡èº«ä¸Š')
    }
  }
    
  //è¿™æ˜¯ç›¸å½“äºç»™å®ä¾‹çš„æ„é€ å‡½æ•°çš„åŸå‹æ·»åŠ æ–¹æ³•-----------------------
  show () {
    console.log('æ·»åŠ åœ¨æ„é€ å‡½æ•°åŸå‹ä¸Š')
  }  
    
  // å±æ€§åˆå§‹åŒ–è¯­æ³•, å…¶å®å°±è¡Œç›¸å½“äºæŠŠå®ä¾‹æ–¹æ³•ä»`constructor`ä¸­æŠ½ç¦»å‡ºæ¥äº†, è¿˜æ˜¯ç›´æ¥æ·»åŠ åˆ°å®ä¾‹ä¸Š  
  show = () => {
    console.log('è¿˜æ˜¯ç›´æ¥æ·»åŠ åˆ°å®ä¾‹å¯¹è±¡èº«ä¸Šçš„')  
  }  

  // é™æ€å±æ€§: é€šè¿‡æ„é€ å‡½æ•°ç›´æ¥è®¿é—®çš„å±æ€§, æ„é€ å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡, ä¹Ÿå¯æœ‰è‡ªå·±çš„å±æ€§
  static info = 'è¿™æ˜¯Animalçš„é™æ€å±æ€§'
  
}
```



### ç±»æ·»åŠ é™æ€æ–¹æ³•

åœ¨æ–¹æ³•å‰é¢æ·»åŠ `static` å…³é”®å­—, å®šä¹‰çš„æ–¹æ³•å°±æ˜¯é™æ€æ–¹æ³•, å®ä¾‹å¯¹è±¡æ— æ³•è®¿é—®

```js
// è¿™æ˜¯ç±»çš„é™æ€æ–¹æ³• å’Œå®ä¾‹æ–¹æ³•å¹³çº§
static show() {
    console.log('è¿™æ˜¯Animalçš„é™æ€æ–¹æ³•')
}
```

> æ³¨æ„ç‚¹1 : åœ¨class çš„` {  }` å†…éƒ¨åªèƒ½å†™ æ„é€ å™¨, å®ä¾‹å±æ€§, å®ä¾‹æ–¹æ³• å’Œé™æ€å±æ€§, é™æ€æ–¹æ³•
>
> æ³¨æ„ç‚¹2 : class åªæ˜¯åœ¨è¯­æ³•å±‚é¢å¸®æˆ‘ä»¬åšä¸€å±‚ä¼˜åŒ–, å†…éƒ¨è¿˜æ˜¯ä½¿ç”¨ åŸæ¥çš„æ„é€ å‡½æ•° , å®ƒåªæ˜¯ä¸€ä¸ª`è¯­æ³•ç³–`



## class å®ç°ç»§æ‰¿

### å®ç°ç»§æ‰¿çš„åŸºæœ¬æ–¹å¼

```js
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age 
  }
}

//é€šè¿‡extends å…³é”®å­—, å°±å¯ä»¥å®ç°ç»§æ‰¿, èƒ½å¤Ÿç»§æ‰¿Person
class Mail extends Person { }

class Femail extends Person { }

let boy = new Mail('å¤§å‚»å­', 18)
let gils = new Femail('å°å‚»å­', 18)
console.log(boy)
console.log(gils)
```



### ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•

æ„é€ å‡½æ•°èƒ½å¤Ÿç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°,  åœ¨ `new` çš„æ—¶å€™ å®ä¾‹å¯¹è±¡èƒ½å¤Ÿè®¿é—®

```js
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age
  }

  //è¿™æ˜¯ç›¸å½“äºç»™å®ä¾‹çš„æ„é€ å‡½æ•°çš„åŸå‹æ·»åŠ æ–¹æ³•----------å®ä¾‹å¯¹è±¡èƒ½å¤Ÿè®¿é—®
  show() {
    console.log('è¿™æ˜¯å¤–éƒ¨çš„å®ä¾‹æ–¹æ³•')
  }
}

//é€šè¿‡extends å…³é”®å­—, å°±å¯ä»¥å®ç°ç»§æ‰¿, èƒ½å¤Ÿç»§æ‰¿Person
class Mail extends Person { }

class Femail extends Person { }

let boy = new Mail('å¤§å‚»å­', 18)
let gils = new Femail('å°å‚»å­', 18)
console.log(boy)
console.log(gils)

```



`extends` 

`extends` åœ¨æˆ‘ä»¬ä¸å†™`constructor () {}` æ—¶, åº•å±‚ä¼šå¸®æˆ‘ä»¬è°ƒç”¨`constructor()` å¹¶æ”¹å˜thisæŒ‡å‘ 



### `super()` å‡½æ•°

1. ä¸ºä»€ä¹ˆè¦åœ¨å­ç±»çš„æ„é€ å™¨`constructor` ä¸­è°ƒç”¨`super()` 

å› ä¸º å¦‚æœä¸€ä¸ªå­ç±»é€šè¿‡ `extends` ç»§æ‰¿äº†çˆ¶ç±», é‚£ä¹ˆåœ¨å­ç±»çš„`constructor` ä¸­å¿…é¡»ä¼˜å…ˆè°ƒç”¨ `super()`  è¿™æ˜¯çº¦å®š

å¦‚æœæˆ‘ä»¬ä¸å†™constructor , ä¸åŠ ç§æœ‰å±æ€§, åˆ™extends é»˜è®¤è°ƒç”¨`super()` 

2. `super` æ˜¯ä»€ä¹ˆ

`super` æ˜¯ä¸€ä¸ªå‡½æ•°, è€Œä¸” å®ƒæ˜¯çˆ¶ç±»çš„ æ„é€ å™¨,   è°ƒç”¨`super()` å°±ç›¸å½“äºçˆ¶ç±»çš„`constructor()` , å®ƒå°±æ˜¯çˆ¶ç±»æ„é€ å™¨çš„ä¸€ä¸ªå¼•ç”¨

ä¹Ÿå°±æ˜¯è¯´åœ¨è°ƒç”¨çš„`super(name, age)` çš„æ—¶å€™, çˆ¶ç±»`constructor(name, age)` çš„å½¢å‚åœ¨è°ƒç”¨å½¢å‚çš„æ—¶å€™, ä¹Ÿéœ€è¦å®šä¹‰ 

3. ä¸ºä»€ä¹ˆæ‰ç”¨`super()` ä¸ä¼ å®å‚,  new å‡ºæ¥çš„å®ä¾‹å¯¹è±¡å±æ€§éƒ½æ˜¯`undefined` 

`super(name, age)`ç›¸å½“äºè°ƒç”¨çˆ¶ç±»çš„` constructor `æŠŠå®å‚ä¼ é€’çˆ¶ç±»æ„é€ å™¨, ä¸ä¼ å®å‚, å®ä¾‹å¯¹è±¡çš„å€¼å°±æ˜¯`undefined`

```js
class Person {
  constructor(name, age) {
    this.name = name
    this.age = age
  }

  //è¿™æ˜¯ç›¸å½“äºç»™å®ä¾‹çš„æ„é€ å‡½æ•°çš„åŸå‹æ·»åŠ æ–¹æ³•
  show() {
    console.log('è¿™æ˜¯å¤–éƒ¨çš„å®ä¾‹æ–¹æ³•')
  }
}

//é€šè¿‡extends å…³é”®å­—, å°±å¯ä»¥å®ç°ç»§æ‰¿, èƒ½å¤Ÿç»§æ‰¿Person
class Mail extends Person { 
  constructor(name, age) {
    super(name, age)
  }
}

class Femail extends Person {
  //åœ¨newçš„æ—¶å€™, ä¼ é€’çš„å‚æ•°ç¬¬ä¸€æ¬¡å‡ºç°åœ¨constructorä¸­
  constructor(name, age) {  // name,age --> å½¢å‚
    super(name, age) //  name,age --> å®å‚ ç›¸å½“äºè°ƒç”¨çˆ¶ç±»çš„ constructor  æŠŠå®å‚ä¼ é€’çˆ¶ç±»æ„é€ å™¨
  }
}

let boy = new Mail('å¤§å‚»å­', 18)
let gils = new Femail('å°å‚»å­', 18)
console.log(boy)
console.log(gils)
boy.show()
gils.show()
```



> åœ¨ `extends` ç»§æ‰¿ çˆ¶ç±», ä¸å†™ `constructor` ä¼šé»˜è®¤ è°ƒç”¨`super()` , å¹¶ä¸”æŠŠå‚æ•°ä¼ ç»™çˆ¶ç±»



### å®šä¹‰å­ç±»ç‹¬æœ‰å®ä¾‹å±æ€§

> å­ç±»ç‹¬æœ‰çš„å®ä¾‹å±æ€§, å¿…é¡»åœ¨`super()` åé¢å†™, ä¸ç„¶å°±ä¼šæŠ¥é”™

```js
class Femail extends Person {
  //åœ¨newçš„æ—¶å€™, ä¼ é€’çš„å‚æ•°ç¬¬ä¸€æ¬¡å‡ºç°åœ¨constructorä¸­
  constructor(name, age, mei) {
    super(name, age) // ç›¸å½“äºè°ƒç”¨çˆ¶ç±»çš„ constructor  æŠŠå®å‚ä¼ é€’çˆ¶ç±»æ„é€ å™¨
    # å¿…é¡»åœ¨super()ä¹‹åå†™
    this.mei = mei
  }
}
```



## classåˆ›å»ºç»„ä»¶

### åŸºæœ¬çš„ç»„ä»¶ç»“æ„

1. å¦‚æœæ˜¯æŠ½ç¦»å‡ºæ¥çš„ç»„ä»¶éœ€è¦`export default`å¯¼å‡º
2. `render(){}` æ–¹æ³•çš„ä½œç”¨æ˜¯: æ¸²æŸ“å½“å‰ç»„ä»¶**å¯¹åº”çš„è™šæ‹ŸDOMå…ƒç´ **, ä¸” å¿…é¡»æœ‰ `return`  
3. åœ¨æ ¹ç»„ä»¶çš„`jsx` ç¯å¢ƒå†…éƒ¨, ç›´æ¥ä»¥æ ‡ç­¾å½¢å¼ä½¿ç”¨ç»„ä»¶

```js
import React from 'react'
export default  class Liu extends React.Component {
  render() {
    return <div>è¿™ä¸€ä¸ªclassåˆ›å»ºçš„ç»„ä»¶</div>
  }
}
```



### classç»„ä»¶ä¼ å€¼

> **é€šè¿‡classåˆ›å»ºçš„ç»„ä»¶, åœ¨ç»„ä»¶æ ‡ç­¾ä¼ é€’çš„å€¼ , åœ¨ç»„ä»¶å†…éƒ¨å¯ä»¥ç›´æ¥é€šè¿‡ `this.props.å±æ€§`, ç›´æ¥ä½¿ç”¨** 

- ç»„ä»¶ä¸­çš„`this` æŒ‡å‘å½“å‰ç»„ä»¶çš„å®ä¾‹å¯¹è±¡

```js
import React from 'react'
import ReactDOM from 'react-dom'
class Liu extends React.Component {
  render() {
    // å†…éƒ¨çš„thisä¹ŸæŒ‡å‘ç»„ä»¶å®ä¾‹å¯¹è±¡  
    return <div>è¿™ä¸€ä¸ªclassåˆ›å»ºçš„ç»„ä»¶ -- {this.props.name} --- {this.props.age}</div>
  }
}

ReactDOM.render(<div>
  <Hello {...obj}></Hello>
{/* åœ¨jsxä¸­ä½¿ç”¨çš„ç»„ä»¶æ ‡ç­¾, å°±æ˜¯ç»„ä»¶çš„å®ä¾‹å¯¹è±¡ */}
  <Liu {...obj}></Liu>
</div>, document.querySelector('#app'))
```

> *å¼•å…¥çš„ç»„ä»¶ `<Liu></Liu>` ,  å°±æ˜¯ç»„ä»¶çš„å®ä¾‹å¯¹è±¡*
>
> ä¸è®ºæ˜¯`class`  è¿˜æ˜¯ æ™®é€š æ„é€ å‡½æ•° åˆ›å»ºçš„ç»„ä»¶ çš„ props éƒ½æ˜¯ `åªè¯»çš„`



**å¦ä¸€ç§ä¸å¸¸ç”¨çš„æ–¹å¼**

ä¹Ÿå¯ä»¥åœ¨`constructor (props) {}` ä¸­æ¥æ”¶ç»„ä»¶ä¼ é€’çš„å€¼

```js
class Liu extends React.Component {
    constructor (props) {
        super(props)
        console.log(props)
    }
}
```





### class åˆ›å»ºç»„ä»¶ å’Œ æ„é€ å‡½æ•°åˆ›å»ºç»„ä»¶åŒºåˆ«

1. ä½¿ç”¨`class` åˆ›å»ºçš„ç»„ä»¶æœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°å’Œè‡ªå·±çš„ç§æœ‰æ•°æ®,  ä½†ä½¿ç”¨`function` åˆ›å»ºçš„ç»„ä»¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­, æ²¡æœ‰è‡ªå·±çš„ç§æœ‰æ•°æ®, åªæœ‰`props`
2. ä½¿ç”¨`class` åˆ›å»º çš„ç»„ä»¶ä¼ é€’çš„å‚æ•°ç›´æ¥é€šè¿‡`this.props.å±æ€§` ä½¿ç”¨, `function` åˆ›å»ºçš„ç»„ä»¶éœ€è¦æ¥æ”¶
3. ç”¨æ„é€ å‡½æ•°`function` åˆ›å»ºçš„ç»„ä»¶å«åš:  `æ— çŠ¶æ€ç»„ä»¶/ æœ¨å¶ç»„ä»¶`, çŠ¶æ€(state)å³æ•°æ®, æ— æ³•æœ‰è‡ªå·±ç§æœ‰æ•°æ®
4. ç”¨`class` åˆ›å»ºçš„ç»„ä»¶å«åš: `æœ‰çŠ¶æ€ç»„ä»¶/ æ™ºèƒ½ç»„ä»¶` , æœ‰`state`, å¯ä»¥æœ‰è‡ªå·±ç§æœ‰æ•°æ®

> æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ä¹‹é—´çš„**æœ¬è´¨åŒºåˆ«**: æœ‰æ—  `state` å±æ€§ å’Œ ç”Ÿå‘½å‘¨æœŸå‡½æ•°
>
> æ— çŠ¶æ€ç»„ä»¶ä»¥åç”¨çš„ä¸å¤š

```js
# classåˆ›å»ºç»„ä»¶
 class Liu extends React.Component {
  render() {  //ä¼ é€’çš„é‡‡çº³æ•°ä¸éœ€è¦æ¥æ”¶, ç›´æ¥é€šè¿‡ this.props.å±æ€§ ä½¿ç”¨
    console.log(this)
    return <div>è¿™ä¸€ä¸ªclassåˆ›å»ºçš„ç»„ä»¶ -- {this.props.name} --- {this.props.age}</div>
  }
}

#ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºç»„ä»¶
function Hello(props) {   // ä¼ é€’çš„å‚æ•°éœ€è¦æ¥æ”¶
  return <div>è¿™æ˜¯ä¸€ä¸ªåˆ†ç¦»å‡ºå»çš„reactç»„ä»¶ --- {props.name} --- {props.age} --- {props.gender}</div>
}

#åœ¨å¼•å…¥ç»„ä»¶ å’Œ ä¼ å‚æ—¶, éƒ½ç›¸åŒ
ReactDOM.render(<div>
  <Hello {...obj}></Hello>
  {/* åœ¨jsxä¸­ä½¿ç”¨çš„ç»„ä»¶æ ‡ç­¾, å°±æ˜¯ç»„ä»¶çš„å®ä¾‹å¯¹è±¡ */}
  <Liu {...obj}></Liu>
</div>, document.querySelector('#app'))
```



## this.state

> åªæœ‰è°ƒç”¨`super()` ä¹‹å, `this` æ‰èƒ½ä½¿ç”¨

`this.state = {}`  åœ¨ ç»„ä»¶ä¸­çš„`constructor` ä¸­`super()` åé¢å®šä¹‰, å®ƒå°±ç›¸å½“äº `vue` ä¸­çš„ `data () { return {} }`

### state ç¬¬ä¸€ç§å†™æ³•

`this.state` **ä¸­çš„æ•°æ®æ˜¯å¯è¯»å¯å†™çš„**

```js
class Liu extends React.Component {
  constructor() {
    super()
    this.state = {
      msg: 'è¿™æ˜¯Liuç»„ä»¶çš„ç§æœ‰æ•°æ®!'
    }
  }
  render() {
    // console.log(this)
    this.state.msg = 'stateä¸­çš„æ•°æ®æ˜¯å¯ä»¥ä¿®æ”¹çš„'
    return <div>
    è¿™ä¸€ä¸ªclassåˆ›å»ºçš„ç»„ä»¶ -- {this.props.name} --- {this.props.age}
    <h3>{this.state.msg}</h3>
    </div>
  }
}
```



### state ç¬¬äºŒç§å†™æ³• (æ¨è)

ä¹Ÿå«: å±æ€§åˆå§‹åŒ–è¯­æ³•

ä¸éœ€è¦åœ¨`constructor` ä¸­ä¹¦å†™, æå–åˆ°å¤–é¢å†™, å…¶å®æœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„

```js
class Liu extends React.Component {
  state = {
      msg: 'è¿™æ˜¯Liuç»„ä»¶çš„ç§æœ‰æ•°æ®!'
  }
  render() {
    // console.log(this)
    this.state.msg = 'stateä¸­çš„æ•°æ®æ˜¯å¯ä»¥ä¿®æ”¹çš„'
    return <div>
    è¿™ä¸€ä¸ªclassåˆ›å»ºçš„ç»„ä»¶ -- {this.props.name} --- {this.props.age}
    <h3>{this.state.msg}</h3>
    </div>
  }
}
```





## this.setState

- ä¿®æ”¹`state` ä¸­çš„æ•°æ®
- é‡æ–°è°ƒç”¨`render()` æ›´æ–°é¡µé¢

åœ¨`react` ä¸­ ä¸º `state `ä¸­çš„å±æ€§é‡æ–°èµ‹å€¼, ä¸è¦ç›´æ¥é€šè¿‡ `this.state.*** = æ–°å€¼`

å¦‚æœç›´æ¥ä¿®æ”¹ `state` ä¸­çš„å€¼,é¡µé¢ä¸ä¼šå“åº”å¼æ›´æ–°, ä½†æ˜¯`state` çš„å€¼ç¡®å®èƒ½å¤Ÿä¿®æ”¹, åº”è¯¥ä½¿ç”¨`this.setState({})`

```js
export default class EventBind extends Component {
  constructor () {
    super()
    this.state = {
      msg: 'è¿™æ˜¯msgæ•°æ®'
    }
  }  
  render () {
    return <div>
      è¿™æ˜¯EventBindç»„ä»¶
      <hr/>
      <button onClick={ () => this.show('123 ğŸ·') }>è¿™æ˜¯ä¸€ä¸ªç‚¹å‡»äº‹ä»¶</button>
      <h3>{this.state.msg}</h3>
    </div>
  }
  //ç‚¹å‡»äº‹ä»¶çš„å¤„ç†å‡½æ•°
  show =  (arg) => {
    // console.log('å“ˆå“ˆå“ˆå“ˆ' + arg)
    this.setState({
      msg: 'å“åº”å¼ä¿®æ”¹äº†msgçš„å€¼'
    })
  }
}
```

> åœ¨`setState()` ä¸­ åªä¼šæŠŠ æä¾›çš„ state çŠ¶æ€å€¼æ›´æ–°,  è€Œä¸ä¼šè¦†ç›–æ‰æ²¡æœ‰ä¿®æ”¹çš„ state å€¼
>
> **`setState()`  è¿™ä¸ªæ–¹æ³•æ˜¯ å¼‚æ­¥çš„**
>
> `setState` ä¼šé‡æ–°è°ƒç”¨`render` , å°±å­˜åœ¨æ€§èƒ½ä¼˜åŒ–é—®é¢˜, renderä¸­å­˜åœ¨æˆ‘ä»¬ç»„ä»¶çš„æ‰€æœ‰ç»“æ„

æ³¨æ„ :  

`this.setState( {} , callback )`

- `callback` : ç”±äºè¿™ä¸ªapi æ˜¯ å¼‚æ­¥çš„, å¦‚æœæƒ³æ‹¿åˆ°æœ€æ–°çš„ å€¼, å¯ä»¥åœ¨ å›è°ƒå‡½æ•°ä¸­ æ‹¿





## å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶ä½¿ç”¨åœºæ™¯

1. çœ‹éœ€ä¸éœ€è¦`state` å’Œ ç”Ÿå‘½å‘¨æœŸ
2. ç±»ç»„ä»¶æ¯”è¾ƒå¼ºå¤§, æœ‰state å’Œ ç”Ÿå‘½å‘¨æœŸ, ä½†æ˜¯ç¼ºç‚¹æ¸²æŸ“é€Ÿåº¦æ…¢
3. å‡½æ•°ç»„ä»¶æ²¡æœ‰`state` å’Œ `ç”Ÿå‘½å‘¨æœŸ` æ¸²æŸ“æ•°æ®å¿«



## ç»„ä»¶ä¸­`props` å’Œ `state`åŒºåˆ«

- `props` ä¸­çš„ æ•°æ®æ˜¯å¤–ç•Œä¼ é€’çš„
- `state/data` æ˜¯ç»„ä»¶ç§æœ‰çš„æ•°æ®, ä¸€èˆ¬é€šè¿‡`ajax` è·å–æ¥çš„æ•°æ®
- `props` ä¸­çš„æ•°æ®æ˜¯åªè¯»çš„,  `state` ä¸­çš„æ•°æ®æ˜¯å¯è¯»å¯å†™çš„





## React ä¸­ äº‹ä»¶å¤„ç†

### åŸºæœ¬ä½¿ç”¨

åœ¨`react`  æœ‰ä¸€å¥—è‡ªå·±äº‹ä»¶ç»‘å®šæœºåˆ¶,  äº‹ä»¶åéƒ½å¿…é¡»éµå®ˆé©¼å³°å‘½åè§„åˆ™

```js
/**
	js: onclick	
	vue: @click    v-on
	react: onClick  é©¼å³°
*/
```

**ç”¨çš„æœ€å¤šçš„äº‹ä»¶ç»‘å®šå½¢å¼ä¸ºï¼š**

å±æ€§åˆå§‹åŒ–è¯­æ³• => ç®­å¤´å‡½æ•° =>èƒ½å¤Ÿé¿å…`this` é—®é¢˜

> `React `é»˜è®¤æ˜¯æ²¡æœ‰å¸®æˆ‘ä»¬å¤„ç†, classä¸­å‡½æ•°çš„thisé—®é¢˜, æˆ‘ä»¬éœ€è¦å€ŸåŠ©`ç®­å¤´å‡½æ•°` æˆ–è€… `bind` 

```js
import React, { Component } from 'react'
import ReactDOM from 'react-dom'

class Person extends Component {
  render () {
    return (
      <div>
        <button onClick={ () => this.fn('å“ˆå“ˆ') }>å“ˆå“ˆå“ˆ</button>
      </div>
    )
  }

  fn = arg => {
    console.log(this, arg)
  }
}

ReactDOM.render(<Person />, document.querySelector('#app'))
```

åœ¨Reactä¸­ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ state ä¸­çš„æ•°æ®ï¼Œæ¨èä½¿ç”¨ `this.setState({ })`



### äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„this

- åœ¨class ä¸­çš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æ²¡æœ‰`this` , `this` æ˜¯`undefined`

```jsx
class Child extends React.Component {
    state = {
       name: 'å¼ ä¸‰' 
    }
	render () {
        return <div>
            	<button onClick={this.fn}>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn () {
        console.log(this) // undefined
        this.setState({
            name: 'æå››' // æŠ¥é”™
        })
    }
}
```



### `bind`è§£å†³`this` é—®é¢˜

ä½œç”¨: æ”¹å˜`this`æŒ‡å‘, åˆ›å»ºæ–°å‡½æ•°å¹¶è¿”å›

å†™æ³•ä¸€: 

- ä½¿ç”¨`bind` ç»‘å®š`this` , è¿”å›ä¸€ä¸ªæ–°å‡½æ•°, åœ¨ç‚¹å‡»çš„æ—¶å€™, è§¦å‘å‡½æ•°

**ä¼ å‚**: `this.fn.bind(this, å‚æ•°1, å‚æ•°2)`

**è·å–äº‹ä»¶å¯¹è±¡**: 

- åœ¨ä¸ä¼ å‚çš„æƒ…å†µä¸‹, é»˜è®¤çš„å½¢å‚å°±æ˜¯äº‹ä»¶å¯¹è±¡, å¯ä»¥**ç›´æ¥è·å–ä½¿ç”¨äº‹ä»¶å¯¹è±¡**
- æœ€åä¸€ä¸ªå½¢å‚å°±æ˜¯äº‹ä»¶å¯¹è±¡`this.fn.bind(param1, param2, ...., e)`

```jsx
class Child extends React.Component {
	render () {
        return <div>
            	{/* ä½¿ç”¨bind ç»‘å®šthis */}
            	<button onClick={this.fn.bind(this)}>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn () {
        console.log(this) // å½“å‰ç»„ä»¶å¯¹è±¡
        this.setState({
            name: 'æå››' 
        })
    }
}
```

å†™æ³•äºŒ: (ä¸å¸¸ç”¨) 

```jsx
class Child extends React.Component {
    constructor () {
        super()
        this.fn = this.fn.bind(this)
    }
	render () {
        return <div>
            	{/* ä½¿ç”¨bind ç»‘å®šthis */}
            	<button onClick={this.fn}>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn () {
        console.log(this) 
        this.setState({
            name: 'æå››'
        })
    }
}
```



### å±æ€§åˆå§‹åŒ–è¯­æ³• (ä¼˜å…ˆ)

**ä¼ å‚**: å±æ€§åˆå§‹åŒ–è¯­æ³•**ä¸èƒ½ä¼ å‚**, ä¼ å‚å°±ç›´æ¥è°ƒç”¨äº†

**è·å–äº‹ä»¶å¯¹è±¡**: ç”±äºä¸èƒ½ä¼ å‚, æ‰€ä»¥é»˜è®¤çš„å½¢å‚å°±æ˜¯äº‹ä»¶å¯¹è±¡`e`

```jsx
class Child extends React.Component {
    constructor () {
        super()
        this.fn = this.fn.bind(this)
    }
	render () {
        return <div>
            	<button onClick={ this.fn }>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn = () => {
        console.log(this) 
        this.setState({
            name: 'æå››'
        })
    }
}
```



### ç®­å¤´å‡½æ•°å¤„ç†this

ä¼ å‚: ç›´æ¥ä¼ å‚, æ¥æ”¶, ä½¿ç”¨å³å¯

è·å–äº‹ä»¶å¯¹è±¡: 

- ç”±äºç®­å¤´å‡½æ•°ä¸­çš„å‡½æ•°ä½“æ˜¯`å‡½æ•°è°ƒç”¨`, **ä¸ä¼ å‚å°±æ²¡æœ‰å‡½æ•°å°±æ²¡æœ‰å½¢å‚**

```jsx
class Child extends React.Component {
    constructor () {
        super()
        this.fn = this.fn.bind(this)
    }
	render () {
        return <div>
            	<button onClick={ (e) => this.fn(e) }>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn (e) {
        console.log(e)
        this.setState({
            name: 'æå››'
        })
    }
}
```



### ç®­å¤´å‡½æ•° + å±æ€§åˆå§‹åŒ–è¯­æ³•

- æƒ³ä¼ å‚å°±ç›´æ¥ä¼ å‚, æƒ³è·å–äº‹ä»¶å¯¹è±¡, å°±ç›´æ¥è·å–

```jsx
class Child extends React.Component {
    constructor () {
        super()
        this.fn = this.fn.bind(this)
    }
	render () {
        return <div>
            	<button onClick={ (e) => this.fn(123) }>ä¿®æ”¹stateçš„å€¼</button>
            </div>
    }
	fn =  (num, e) => {
        console.log(num, e)
        this.setState({
            name: 'æå››'
        })
    }
}
```



# React ç¬¬ä¸‰å¤©



## æ¡ä»¶æ¸²æŸ“

#### 1. if / else

```js
state = {
    isLoading: true
} 
render () {
    if (this.state.isLoading) { // æ­£åœ¨åŠ è½½ä¸­
      return <h1>Loading...</h1>
    }
    return <div>è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„å†…å®¹</div>
  }
// é’©å­å‡½æ•° äº”ç§’é’Ÿä¹‹å ä¿®æ”¹çŠ¶æ€å€¼
  componentDidMount () { 
    setTimeout(() => {
      this.setState({
        isLoading : false
      })
    }, 3000);
  }
```

#### 2. ä¸‰å…ƒè¡¨è¾¾å¼

```js
 return this.state.isLoading ? (<h1>Loading...</h1>) : (<div>è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„å†…å®¹</div>)
```

#### 3. é€»è¾‘è¿ç®—ç¬¦

ä¸€èˆ¬ç”¨æ¥åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©º, ä¸ä¸ºç©ºåˆ™æ¸²æŸ“æ•°ç»„`{ list && list.map() }`

```js
 return this.state.isLoading && (<h1>Loading...</h1>) 
```



## åˆ—è¡¨æ¸²æŸ“

#### éå†ç®€å•æ•°ç»„

ä½¿ç”¨æ•°ç»„çš„`map()` æ–¹æ³•éå†æ•°ç»„

```js
// å‡†å¤‡æ•°æ®
state = {
  list :['å°è‹¹æœ','å¤§é¦™è•‰','é»„æ©™å­']
}

return (
    <ul>
    {
        this.state.list.map(item => { 
       		return <li>{ item }</li>
     	}) 
	}
	</ul>
)
```



#### éå†å¯¹è±¡æ•°ç»„

> å¦‚æœä¸æŒ‡å®š`key` æµè§ˆå™¨ä¼šæŠ¥é”™, è¿™é‡Œçš„`key` å’Œ vue ä¸­ä¸€æ ·

```js
// å‡†å¤‡æ•°æ®
state = {
    list2: [{ id: 1, name: 'æ˜¥' }, { id: 2, name: 'é£' }, { id: 3, name: 'è²' }]
}
// éå†
 return (
      <ul>
        {this.state.list2.map(item => { 
          return <li key={item.id}>{ item.name }</li>
        }) }
      </ul>
    )
```

#### æå–åˆ°å‡½æ•°

```jsx
// render é’©å­å‡½æ•°
render () {
  return (<ul>
        { this.renderLi()  }
       </ul>)
 }
  
// æå–åˆ°çš„ä¸€ä¸ªå‡½æ•°
renderLi () { 
   # å¿…é¡»è¦æœ‰è¿”å›å€¼ æŠŠ mapå¾—åˆ°çš„æ•°ç»„return å‡ºå»
  return this.state.list2.map(item => { 
      # è¿™ä¸ªreturn æ˜¯ map å‡½æ•°çš„return
     return <li key={item.id}>{ item.name }</li>
    }) 
}
```



## Reactä¸­çš„key

reactä¸­çš„key å’Œ vueä¸­çš„keyå®Œå…¨ä¸€æ ·, å”¯ä¸€åŒºåˆ«å°±æ˜¯ç»‘å®škeyçš„æ–¹å¼ä¸ä¸€æ ·, keyè¦ç»‘å®šç»™æˆ‘ä»¬éå†çš„å…ƒç´ 

```js
#ä¸ºéå†çš„å…ƒç´ ç»‘å®škeyå€¼
nameArr.map(item => <h3 key={item}>{ item }</h3>) }
```

æ²¡æœ‰keyåœ¨æµè§ˆå™¨æ§åˆ¶å°ä¼šæŠ¥è­¦å‘Š

```html
Warning: Each child in a list should have a unique "key" prop
```







## `style` è¡Œå†…æ ·å¼

åœ¨jsxä¸­ä¹¦å†™styleçš„æ ¼å¼ä¸º `<h1 style={ {color: 'red'} }></h1>`

> åŒèŠ±æ‹¬å·, å¤–é¢çš„èŠ±æ‹¬å·è¡¨ç¤ºæˆ‘ä»¬è¦å†™jsä»£ç äº† 
>
> é‡Œé¢çš„èŠ±æ‹¬å·æ˜¯ä¸€ä¸ªæ ·å¼å¯¹è±¡,  æ˜¯ä¸€ä¸ªJSå¯¹è±¡, è¦ç¬¦åˆJSçš„è§„èŒƒ

```jsx
import React from 'react'

//ç¬¬ä¸€å±‚å°è£…
const cmtItem = {
  border: '1px dashed #ccc', 
  boxShadow: '0 0 7px #ccc', 
  margin: '20px auto',
  padding: '10px 10px',
  boxSizing: 'border-box',
  width: '500px'
}

//ç¬¬äºŒå±‚å°è£…
const styles = {
  cmtItem: {
    border: '1px dashed #ccc', 
    boxShadow: '0 0 7px #ccc', 
    margin: '20px auto',
    padding: '10px 10px',
    boxSizing: 'border-box',
    width: '500px'
  },
  cmtTitle: {
    fontSize: '14px'
  }
}

export default class CmtItem extends React.Component {
  render () {
    return <div style={styles.cmtItem}>
      <h3 style={styles.cmtTitle}>è¯„è®ºäºº: {this.props.user}</h3>
      <p >è¯„è®ºå†…å®¹: {this.props.content}</p>
    </div>
  }
}
```

> **ä¹Ÿå¯ä»¥æŠŠcssæ ·å¼å¯¹è±¡ ,æŠ½ç¦»ä¸ºä¸€ä¸ª js æ–‡ä»¶,æˆä¸ºä¸€ä¸ªæ ·å¼è¡¨æ¨¡å—**



## ä½¿ç”¨cssæ ·å¼æ–‡ä»¶

webpackçš„css-loader é…ç½®

åœ¨ç»„ä»¶ä¸­å¯ä»¥å¼•å…¥cssæ ·å¼æ–‡ä»¶, ä½¿ç”¨æ ·å¼æ–‡ä»¶æä¾›çš„ç±»å, å»ç¾åŒ–DOMå…ƒç´ 

1. åˆ›å»ºå¯¹åº”çš„`.css` æ ·å¼æ–‡ä»¶, ä¹¦å†™æ ·å¼
2. ä¸‹è½½å¤„ç†cssçš„`loader`, å¹¶ä¸”åœ¨webpacké…ç½®loader
3. åœ¨ç»„å»ºä¸­`import` å¼•ç”¨æ ·å¼æ–‡ä»¶, ç»™è™šæ‹ŸDOM æ·»åŠ ç±»å
   - cssæ ·å¼æ–‡ä»¶, æ²¡æœ‰ä½œç”¨åŸŸ, ç›´æ¥å¯¼å…¥çš„cssæ ·å¼æ–‡ä»¶, é»˜è®¤æ˜¯åœ¨å…¨å±€, æ•´ä¸ªé¡¹ç›®éƒ½èƒ½ç”Ÿæ•ˆ

```js
//webpackçš„é…ç½®
 {test:/\.scss/, use: ['style-loader', 'css-loader', 'sass-loader']}
 {test:/\.less/, use: ['style-loader', 'css-loader', 'less-loader']}
```



css æ–‡ä»¶ä½¿ç”¨

1. import css æ–‡ä»¶
2. ç»™jsxå…ƒç´ æ·»åŠ æ ·å¼ç±»åå³å¯

```js
//2. å¼•å…¥
import './index.css'

//3. æ·»åŠ ç±»
 <p className='red' >å“ˆå“ˆ</p>
```



#### cssæ¨¡å—åŒ–

cssæ–‡ä»¶æ²¡æœ‰æ–‡ä»¶ä½œç”¨åŸŸçš„æ¦‚å¿µ, å¼•å…¥çš„cssæ ·å¼æ–‡ä»¶, åœ¨æ•´ä¸ªé¡¹ç›®éƒ½èƒ½ç”Ÿæ•ˆ, å°±å¯¼è‡´äº†, æ ·å¼å¯èƒ½å†²çªçš„é—®é¢˜

åœ¨`vue` ä¹Ÿæœ‰æ ·å¼å†²çª, ä½†æ˜¯åœ¨vue ä¸­ æä¾›äº†`scoped`  æŒ‡ä»¤èƒ½å¤Ÿè§£å†³æ ·å¼å…¨å±€æ±¡æŸ“é—®é¢˜, ä½†æ˜¯åœ¨`react` æ²¡æœ‰æŒ‡ä»¤çš„æ¦‚å¿µ

ä½†æ˜¯å¯ä»¥é…ç½®`css-loader` æ˜¯csså…·æœ‰æ¨¡å—åŒ–çš„æ¦‚å¿µ

```js
# è¿™æ˜¯webpack 4.x é…ç½®, ä¸­æ–‡ç½‘æ˜¯è¿˜æœªåŠæ—¶æ›´æ–°
//ç»™css-loader é…ç½®æ¨¡å—åŒ–, loaderä¹Ÿå¯ä»¥ä¸ºä¸€ä¸ªå¯¹è±¡
      { 
        test:/\.css/, 
        use: [
          'style-loader',
          {
            loader: 'css-loader',
            options: {
              modules: {
                mode: 'local',
                localIdentName: '[path][name]__[local]--[hash:base64:5]',
                // context: path.resolve(__dirname, 'src'),
                // hashPrefix: 'my-custom-hash',
              }
            }
          }
        ]
      }
```

> ä½†æ˜¯cssæ¨¡å—åŒ– åªé’ˆå¯¹ ç±»é€‰æ‹©å™¨ å’Œ id é€‰æ‹©å™¨ ç”Ÿæ•ˆ
>
> å¯¹äºæ ‡ç­¾é€‰æ‹©å™¨ä¸ä¼šæ¨¡å—åŒ–, ä¾æ—§å­˜åœ¨å…¨å±€é—®é¢˜



#### è‡ªå®šä¹‰æ¨¡å—åŒ–ç±»å

1. å¯ç”¨ css-modules

   1. ä¿®æ”¹ `webpack.config.js`è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸º `css-loader` æ·»åŠ å‚æ•°ï¼š

      ```js
      { test: /\.css$/, use: ['style-loader', 'css-loader?modules'] } // ä¸º .css åç¼€åçš„æ ·å¼è¡¨  å¯ç”¨ CSS æ¨¡å—åŒ–
      ```

   2. åœ¨éœ€è¦çš„ç»„ä»¶ä¸­ï¼Œ`import`å¯¼å…¥æ ·å¼è¡¨ï¼Œå¹¶æ¥æ”¶æ¨¡å—åŒ–çš„ CSS æ ·å¼å¯¹è±¡ï¼š

      ```js
      import cssObj from '../css/CmtList.css' 
      ```

   3. åœ¨éœ€è¦çš„HTMLæ ‡ç­¾ä¸Šï¼Œä½¿ç”¨`className`æŒ‡å®šæ¨¡å—åŒ–çš„æ ·å¼ï¼š

      ```jsx
      <h1 className={cssObj.title}>è¯„è®ºåˆ—è¡¨ç»„ä»¶</h1>
      ```

2. ä½¿ç”¨`localIdentName`è‡ªå®šä¹‰ç”Ÿæˆçš„ç±»åæ ¼å¼ï¼Œå¯é€‰çš„å‚æ•°æœ‰ï¼š

   - [path]  è¡¨ç¤ºæ ·å¼è¡¨ `ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•` æ‰€åœ¨è·¯å¾„
   - [name]  è¡¨ç¤º æ ·å¼è¡¨æ–‡ä»¶åç§°
   - [local]  è¡¨ç¤ºæ ·å¼çš„ç±»åå®šä¹‰åç§°
   - [hash:length]  è¡¨ç¤º32ä½çš„hashå€¼
   - ä¾‹å­ï¼š

   ```js
     { 
           test:/\.css/, 
           use: [
             'style-loader',
             {
               loader: 'css-loader',
               options: {
                 modules: {
                   mode: 'local',
                   localIdentName: '[path][name]__[local]--[hash:base64:5]',
                   // context: path.resolve(__dirname, 'src'),
                   // hashPrefix: 'my-custom-hash',
                 }
               }
             }
           ]
         }
   ```

   

3. ä½¿ç”¨ `:local()` å’Œ `:global()`

   - `:local()`åŒ…è£¹çš„ç±»åï¼Œæ˜¯è¢«æ¨¡å—åŒ–çš„ç±»åï¼Œåªèƒ½é€šè¿‡`className={cssObj.ç±»å}`æ¥ä½¿ç”¨

     åŒæ—¶ï¼Œ`:local`é»˜è®¤å¯ä»¥ä¸å†™ï¼Œè¿™æ ·ï¼Œé»˜è®¤åœ¨æ ·å¼è¡¨ä¸­å®šä¹‰çš„ç±»åï¼Œéƒ½æ˜¯è¢«æ¨¡å—åŒ–çš„ç±»åï¼›

   - `:global()`åŒ…è£¹çš„ç±»åï¼Œæ˜¯å…¨å±€ç”Ÿæ•ˆçš„ï¼Œä¸ä¼šè¢« `css-modules` æ§åˆ¶ï¼Œå®šä¹‰çš„ç±»åæ˜¯ä»€ä¹ˆï¼Œå°±æ˜¯ä½¿ç”¨å®šä¹‰çš„ç±»å`className="ç±»å"`

4. æ³¨æ„ï¼šåªæœ‰`.title`è¿™æ ·çš„ç±»æ ·å¼é€‰æ‹©å™¨ï¼Œæ‰ä¼šè¢«æ¨¡å—åŒ–æ§åˆ¶ï¼Œç±»ä¼¼äº`body`è¿™æ ·çš„æ ‡ç­¾é€‰æ‹©å™¨ï¼Œä¸ä¼šè¢«æ¨¡å—åŒ–æ§åˆ¶



**æ¨¡å—åŒ–ç±»åçš„ä½¿ç”¨**

```jsx
//å¦‚æœæƒ³è¦æ·»åŠ å¤šä¸ªç±»å, å¯ä»¥ç»“åˆæ•°ç»„ å’Œ æ•°ç»„çš„ joinæ–¹æ³•
<h1 className={[cssobj.title, cssobj.title2, 'title3'].join(' ')}>è¿™æ˜¯ä¸€ä¸ªè¯„è®ºçˆ¶ç»„ä»¶</h1>
```



**åœ¨æ¨¡å—åŒ–ä¸­å®šä¹‰ä¸€ä¸ªå…¨å±€çš„ç±»å**

ä½¿ç”¨`:global(.className)` èƒ½å¤Ÿå°†è¿™ä¸ªç±»é€‰æ‹©å™¨å˜æˆå…¨å±€çš„ç±»å

```css
:global(.title3) {
    font-style: italic;
}
```

ä½¿ç”¨`:local(.className)` èƒ½å¤Ÿå°†è¿™ä¸ªç±»åå˜æˆä¸€ä¸ªå±€éƒ¨çš„ç±»å



## ç¬¬ä¸‰æ–¹æ ·å¼è¡¨

**ä¸ºäº†åœ¨reactä¸­ä½¿ç”¨æ ·å¼è¡¨, æˆ‘ä»¬æŠŠcssæ–‡ä»¶å¼€å¯äº†æ¨¡å—åŒ–, ä½†æ˜¯å¯¹äºç¬¬ä¸‰æ–¹çš„UIæ¡†æ¶, æˆ‘ä»¬å¹¶ä¸æƒ³å¯ç”¨æ¨¡å—åŒ–, è€Œæ˜¯ç›´æ¥ä½¿ç”¨å®ƒæä¾›çš„ç±»å**

æ‰€ä»¥æˆ‘ä»¬çº¦å®š: è‡ªå·±æ ·å¼è¡¨ä»¥`.scss` æˆ–è€… `.less` å¯ç”¨æ¨¡å—åŒ–, å¯¹äº `.css` æ–‡ä»¶ä¸å¯ç”¨æ¨¡å—åŒ– 	

> æ‰€ä»¥åœ¨é…ç½®`css loader` çš„æ—¶å€™, ç¬¬ä¸‰æ–¹çš„css æ–‡ä»¶ ä¸é…ç½®æ¨¡å—åŒ–
>
> æˆ‘ä»¬è‡ªå·±ä½¿ç”¨`.scss ` `.less` æ–‡ä»¶é…ç½®æ¨¡å—åŒ–

ä½¿ç”¨: 

```js
//å¯¼å…¥æ—¶, ç›´æ¥å¯¼å…¥, node_modules zè¿™å±‚ç›®å½•å¯ä»¥çœç•¥ 
import 'bootstrap/dist/css/bootstrap.css'

<button className="btn btn-success">è¿™æ˜¯ä¸€ä¸ªbootstra</button>
```

### css loader é…ç½® 

```js
   {  // js loader
        test: /\.js|jsx$/,
        use: 'babel-loader',
        exclude: /node_modules/
      },	
	{  // scss loader
        test:/\.scss/, 
        use: [
          'style-loader',
          {
            loader: 'css-loader',
            options: {
              modules: {
                mode: 'local',
                localIdentName: '[path][name]__[local]--[hash:5]',
                context: path.resolve(__dirname, 'src'),
                hashPrefix: 'my-custom-hash',
              }
            }
          },
          'sass-loader'
        ]
      },
      {  //css loader
        test:/\.css/, 
        use: [
          'style-loader',
          'css-loader',
        ]
      },
      {  //less loader
        test:/\.less/, 
        use: [
          'style-loader',
          {
            loader: 'css-loader',
            options: {
              modules: {
                mode: 'local',
                localIdentName: '[path][name]__[local]--[hash:5]',
                context: path.resolve(__dirname, 'src'),
                hashPrefix: 'my-custom-hash',
              }
            }
          },
          'less-loader'
        ]
      },
      { test: /\.ttf|woff|woff2|eot|svg$/, use: 'url-loader'}
```



## å—æ§ç»„ä»¶

#### ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶

å¯¹äºè¡¨å•å…ƒç´ æˆ‘ä»¬åŠ `value` å±æ€§ä¹‹å, å°±å˜æˆä¸€ä¸ªå—æ§ç»„ä»¶, åœ¨æ²¡æœ‰`onChange` å¤„ç†å‡½æ•°, è¿™ä¸ªè¡¨å•å…ƒç´ , æ— æ³•è¾“å…¥å˜æˆäº†ä¸€ä¸ªå—æ§ç»„ä»¶ => **ç®€è€Œè¨€ä¹‹, ç»™è¡¨å•å…ƒç´ åŠ `value` ä¹‹åå°±å˜æˆå—æ§ç»„ä»¶äº†**

- `value` å°±æ˜¯ä» `M -> V` çš„è¿‡ç¨‹
- `onChange` å°±æ˜¯`V -> M` çš„ è¿‡ç¨‹ ä»è€Œå®ç°æ•°æ®åŒå‘ç»‘å®š

```jsx
render () {
    return (
        # åœ¨æ²¡æœ‰onChange çš„æƒ…å†µä¸‹, è¿™ä¸ªè¡¨å•æ— æ³•äº¤äº’
    	<input value={this.state.msg} onChange={ e => this.txtChange(e)}>	
    )
}
```

#### å…¶ä»–å—æ§ç»„ä»¶

```jsx
// æ–‡æœ¬è¾“å…¥æ¡†
<input onChange={this.handleInput} value={username} type="text" />  <br />
// æ–‡æœ¬åŸŸ
<textarea onChange={this.handleTextarea} value={content} cols="30" rows="10"></textarea>
// ä¸‹æ‹‰æ¡†
<select value={city} onChange={this.handleSelect}>
    <option value="sh">ä¸Šæµ·</option>
    <option value="hz">æ­å·</option>
    <option value="bj">åŒ—äº¬</option>
</select>
```



#### ä¼˜åŒ–`onChange`å¤„ç†å‡½æ•°

ç”±äº`onChange` å¤„ç†å‡½æ•°çš„ä»£ç éƒ½åŸºæœ¬å·®ä¸å¤š, å†™äº†å¾ˆå¤šé‡å¤çš„å¤„ç†å‡½æ•°, å¦‚æœä¸€ä¸ªé¡µé¢æœ‰å¾ˆå¤šè¡¨å•å…ƒç´ , åˆ™ä¼šå‡ºç°å¾ˆå¤šå¤„ç†å‡½æ•°

**ä¼˜åŒ–æ–¹å¼ä¸€**

ç»‘å®šä¸€ä¸ª`handler` å—æ§ç»„ä»¶å¤„ç†å‡½æ•°, åˆ™å¤šä¸ªå—æ§ç»„ä»¶å…±ç”¨ä¸€ä¸ªå¤„ç†å‡½æ•°

è¡¨å•å…ƒç´ éœ€è¦å®šä¹‰`name` å±æ€§

```js
handler = e => {
    this.setState({
        [e.target.name]: e.target.value
    })
}
```

> æ³¨æ„ç‚¹: åœ¨å¯¹è±¡ä¸­,å¦‚æœkeyä½¿ç”¨å˜é‡, åˆ™éœ€è¦åŠ `[]` åŒ…è£¹ 



**ä¼˜åŒ–æ–¹å¼äºŒ**

- æŠŠè¦ä¿®æ”¹çš„`key / value` ä¼ å€¼

```jsx
// æ–‡æœ¬è¾“å…¥æ¡†
<input  onChange={(e) => this.getValues('username', e.target.value)} value={username} type="text" />  <br />
// æ–‡æœ¬åŸŸ
<textarea onChange={(e) => this.getValues('content', e.target.value)} value={content} cols="30" rows="10"></textarea>
// ä¸‹æ‹‰æ¡†
<select value={city} onChange={ (e) => this.getValues('city', e.target.value) }>
    <option value="shanghai">ä¸Šæµ·</option>
    <option value="hangzhou">æ­å·</option>
    <option value="beijing">åŒ—äº¬</option>
</select>
```

`onChange` å¤„ç†

```jsx
 getValues = (name, value) => { 
    this.setState({
      [name] : value
    })
  }
```





## è¯„è®ºæ¡ˆä¾‹-ç»“åˆå—æ§ç»„ä»¶





## éå—æ§ç»„ä»¶

#### ä»€ä¹ˆæ˜¯éå—æ§ç»„ä»¶

å¦‚æœæƒ³è¦ç»™è¡¨å•å…ƒç´ æ·»åŠ é»˜è®¤`value` , è€Œä¸”ä¸æƒ³æŠŠè¡¨å•ç»„ä»¶å˜æˆ`å—æ§ç»„ä»¶` å¯ä»¥ä½¿ç”¨`defaultValue={}` , è¡¨å•å…ƒç´ ä¾æ—§ä¿æŒäº¤äº’æ€§

```jsx
<input type="text" defaultValue={this.state.name} />
```

**è¡¨å•å…ƒç´ (ç»„ä»¶) é»˜è®¤å°±æ˜¯éå—æ§ç»„ä»¶**

#### å¦‚ä½•æ‹¿åˆ°éå—æ§ç»„ä»¶çš„å€¼

1. åˆ›å»º`ref` å¼•ç”¨

```js
constructor(){
  super()
	// æ–¹å¼1
  this.iptRef = React.createRef()
}
// å’Œ state ä¸€æ ·
// æ–¹å¼2: å±æ€§åˆå§‹åŒ–è¯­æ³•
iptRef = React.createRef()

<input ref={ this.iptRef } />
```

2. é€šè¿‡`ref` æŠŠéå—æ§ç»„ä»¶ç»‘å®šèµ·æ¥

```jsx
render () {
    return (
        <div>
            <input ref={ this.iptRef } />
            <button onClick={this.click}></button>
        </div>
    )
} 

```

3. é€šè¿‡DOMæ“ä½œè·å–æ•°æ®

```jsx
// å¯ä»¥é€šè¿‡å°è¯•ç‚¹å‡»æŒ‰é’®
click = () => {
    console.log(this.iptRef.current.value)
}
```





## Reactä¸­è¡¨å•åŒå‘æ•°æ®ç»‘å®š

### å•å‘æ•°æ®æµ

- å¦‚æœæˆ‘ä»¬ç»™è¡¨å•å…ƒç´ , ç»‘å®š`state` çš„ çŠ¶æ€å€¼,  ä¸€æ—¦`state `çŠ¶æ€å€¼å˜åŒ–, å°†ä¼šåŒæ­¥åˆ°é¡µé¢ä¸­
- è¿™ä¸ªè¡¨å•å°†ä¼šå˜æˆä¸€ä¸ªåªè¯»çš„è¡¨å•å…ƒç´  , åªèƒ½å®ç°å•å‘æ•°æ®æµåŠ¨
- éœ€è¦ç»™è¡¨å•å…ƒç´ ç»‘å®šä¸€ä¸ª`onChange` äº‹ä»¶

### åŒå‘æ•°æ®ç»‘å®š

React  æ— æ³•å®ç°åƒ vue ä¸­çš„ `v-model` åŒå‘æ•°æ®ç»‘å®š

åœ¨react ä¸­, éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç›‘å¬æ–‡æœ¬æ¡†çš„`onChange` äº‹ä»¶, åœ¨ `onChange` äº‹ä»¶ä¸­æ‹¿åˆ°æœ€æ–°çš„å€¼,  è°ƒç”¨ `this.setState()` æŠŠæœ€æ–°çš„å€¼åŒæ­¥åˆ° `state` 



#### äº‹ä»¶å¯¹è±¡e

åªæœ‰æ‹¿åˆ°æœ€æ–°çš„æ•°æ®, æ‰èƒ½å¤Ÿç»™state åŒæ­¥æ•°æ®, å®ç°åŒå‘æ•°æ®ç»‘å®š

æ–¹å¼ä¸€:  ` ä½¿ç”¨ äº‹ä»¶å‚æ•°e.target.value ` ç»“åˆ `setState()`

```jsx
# 1- å®šä¹‰onChange äº‹ä»¶
<input type="text" value={this.state.msg} onChange={ (e) => this.txtChange(e) }/>
 
txtChange = (e) => {
    // console.log(e.target.value)
    # æ‹¿åˆ°æœ€æ–°çš„å€¼, è°ƒç”¨ setState åŒæ­¥åˆ° state ä¸­
    this.setState({
      msg: e.target.value
    })
  }
```



#### this.refs å®ç°åŒå‘æ•°æ®ç»‘å®š

å’Œvue ä¸­ çš„`vm.$refs.å¼•ç”¨å` ä½œç”¨ä¸€æ ·, é€šè¿‡åœ¨ å…ƒç´ èº«ä¸Šå®šä¹‰ `ref="å¼•ç”¨å"` 

é€šè¿‡`this.refs.å¼•ç”¨å` å°±å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªå…ƒç´ 

1. ç»™ è¡¨å•å…ƒç´ ç»‘å®š`onChange` äº‹ä»¶
2. é€šè¿‡`e.target.value` æˆ–è€… `this.refs.å¼•ç”¨å` æ‹¿åˆ°æœ€æ–°çš„å€¼
3. è°ƒç”¨`this.setState()` æŠŠæ•°æ®åŒæ­¥åˆ°`state` ä¸­

```js
# 1- å®šä¹‰onChange äº‹ä»¶
<input type="text" value={this.state.msg} onChange={ (e) => this.txtChange(e) } ref="txt"/>

 txtChange = () => {
    // console.log(this.refs.txt.value)
    # 3-æ‹¿åˆ°æœ€æ–°çš„å€¼, è°ƒç”¨ setState åŒæ­¥åˆ° state ä¸­
    this.setState({
     //	2- æ‹¿åˆ°æœ€æ–°çš„å€¼
      msg: this.refs.value
    })  
  }
```



**ref çš„å¦ä¸€ç§ç”¨æ³•**

- `React.createRef()` èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªref å¼•ç”¨å¯¹è±¡, å¹¶ä¸”å¯ä»¥é™„å±åˆ°`react` å…ƒç´ ä¸Š, `å¯¹è±¡çš„ current ` å±æ€§å°±æ˜¯å½“å‰çš„DOMå…ƒç´ 
- `this.inputRef.current` è‡ªå®šä»¥çš„å¼•ç”¨å¯¹è±¡,èƒ½å¤Ÿå¾—åˆ°é™„å±åœ¨DOMå…ƒç´ 

```js
class Person extends Component {
  state = {
    msg: 'å˜»å˜»å˜» '
  }
  render () {
    return (
      <div>
        <button>{ this.state.msg }</button> 
        <input onChange={ () => this.setText() } value={ this.state.msg } ref={this.inputRef}/>
      </div>
    )
  }
  // createRef æ˜¯ä¸€ä¸ªæ–¹æ³•, èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªrefå¼•ç”¨å¯¹è±¡, èƒ½å¤Ÿé™„å±åˆ° react å…ƒç´ ä¸Š
  inputRef = React.createRef()
  setText = e => {
    // this.inputRef æ˜¯ä¸€ä¸ªå¯¹è±¡, currentæŒ‡å‘å½“å‰çš„DOMå…ƒç´ 
    console.log(this.inputRef.current)
    this.setState({
      msg: this.inputRef.current.value
    })
  }
}

ReactDOM.render(<Person />, document.querySelector('#app'))
```





## ç»„ä»¶é€šè®¯

### çˆ¶ä¼ å­

1. é€šè¿‡å±æ€§ä¼ å€¼çš„æ–¹å¼ä¼ é€’ç»™å­ç»„ä»¶,å­ç»„ä»¶é€šè¿‡props, å°±å¯ä»¥æ‹¿åˆ°çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å€¼

```js
// çˆ¶ç»„ä»¶
class Parent extends React.Component {
  // 1. å‡†å¤‡å¥½æ•°æ®
    state = {
      pName : 'çˆ¶çš„æ•°æ®'
    }
    render() {
      return (
        <div>
          <p>å“ˆå“ˆ</p>
          //2. é€šè¿‡å±æ€§ å°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶
          <Child name={this.state.pName}></Child>
        </div>
      )
    }
}
// å­ç»„ä»¶  
// 3. é€šè¿‡ props è·å–æ•°æ®
const Child = (props) => <div>å­ç»„ä»¶ { props.name }</div>
```



### å­ä¼ çˆ¶

æ€è·¯: çˆ¶ç»„ä»¶ä¸­æä¾›äº†ä¸€ä¸ªæ–¹æ³•, ç”±å­ç»„ä»¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•, å°†æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’ç»™çˆ¶ç»„ä»¶

æ­¥éª¤ : 

- 1-åœ¨çˆ¶ç»„ä»¶ä¸­æä¾›ä¸€ä¸ªæ–¹æ³•
- 2-å°†è¿™ä¸ªæ–¹æ³•é€šè¿‡å±æ€§ä¼ é€’ç»™å­ç»„ä»¶
- 3-å­ç»„ä»¶ä¸­é€šè¿‡props æ‹¿åˆ°è¿™ä¸ªæ–¹æ³•è°ƒç”¨, å¹¶ä¸”å°†æ•°æ®ä½œä¸ºå®å‚ä¼ é€’ç»™çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å‡½æ•°, çˆ¶ç»„ä»¶å°±æ‹¿åˆ°å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å®å‚äº†

```js
// çˆ¶ç»„ä»¶
class Parent extends React.Component {
    // ç¬¬ä¸€æ­¥ :çˆ¶ç»„ä»¶å‡†å¤‡ä¸€ä¸ªæ–¹æ³•
    pFn = (data) => { 
      console.log('è°ƒç”¨äº†',data);
    }
    render() {
      return (
        <div>
          <p>å“ˆå“ˆ</p>
          {/* ç¬¬äºŒæ­¥ : é€šè¿‡å±æ€§å°†æ–¹æ³•äº§ä¼ é€’ç»™å­ç»„ä»¶ */}
          <Child cfn={ this.pFn } ></Child>
        </div>
      )
    }
}
// å­ç»„ä»¶  
class Child extends React.Component { 
  render () { 
    return (<div>
      <button onClick={this.sendMsg}>ç‚¹å‡»å‘é€</button>
    </div>)
  }
  sendMsg = () => { 
    // ç¬¬ä¸‰æ­¥ : å­ç»„ä»¶é€šè¿‡props æ‹¿åˆ°è¿™ä¸ªæ–¹æ³•, å¹¶ä¸”ä¼ å‚
    this.props.cfn('æ’©æ±‰å­')
  }
}
```





### éçˆ¶å­ä¼ å€¼

react ä¸­æ²¡æœ‰ vue ä¸­çš„ bus æ¥å®ç°éçˆ¶å­çš„ä¼ é€’

æ€è·¯: `çŠ¶æ€æå‡`, A ç»„ä»¶æŠŠæ•°æ®ä¼ é€’ç»™ çˆ¶ç»„ä»¶, çˆ¶ç»„ä»¶æŠŠæ•°æ®ä¼ é€’ç»™ Bç»„ä»¶, å½“Aç»„ä»¶æ•°æ®æ”¹å˜, å†ä¼ é€’ç»™ çˆ¶ç»„ä»¶, çˆ¶ç»„ä»¶é€šè¿‡å•å‘æ•°æ®æµ, Bç»„ä»¶çš„å€¼ä¹Ÿéšä¹‹æ”¹å˜

æ€»ç»“: å­ä¼ çˆ¶ -> çˆ¶ä¼ å­

## ç»„ä»¶åŒ–æ”¹é€ è¯„è®ºåˆ—è¡¨





# React ç¬¬å››å¤©

## ç»„ä»¶é€šè®¯

> çˆ¶ä¼ å­  
>
> å­ä¼ çˆ¶  
>
> éçˆ¶å­(çŠ¶æ€æå‡) 
>
> context  
>
> localStorage 
>
> redux

**localStorage å’Œ redux(vuex) æœ‰ä»€ä¹ˆåŒºåˆ«?**

redux æ˜¯å“åº”å¼çš„ , localStorage ä¸æ˜¯å“åº”å¼çš„ 

### context

`context: ä¸Šä¸‹æ–‡`ç”¨æ¥è§£å†³è·¨å¤šå±‚ç»„ä»¶ä¼ é€’æ•°æ®çš„é—®é¢˜

å½“å¤šå±‚ç»„ä»¶åµŒå¥—, æƒ³ä¼ é€’ä¸€ä¸ªæ•°æ®åˆ°æœ€é‡Œå±‚çš„ç»„ä»¶ , å¯ä»¥é€šè¿‡çˆ¶ä¼ å­ä¸€å±‚ä¸€å±‚ä¼ é€’, ä¹Ÿå¯ä»¥ä½¿ç”¨`context` ä¼ é€’

#### ä½¿ç”¨

`const { Provider, Consumer } = React.createContext()`

- `Provider` æä¾›ç»„ä»¶ ä¼ é€’æ•°æ®çš„ç»„ä»¶/ æä¾›æ•°æ®çš„ç»„ä»¶
- `Consumer` æ¶ˆè´¹ç»„ä»¶, æ¥æ”¶æ•°æ®çš„ / ä½¿ç”¨æ•°æ®çš„ç»„ä»¶

æ­¥éª¤: 

1. åˆ›å»º ä¸Šä¸‹æ–‡  è§£æ„å‡ºæ¥ä¸¤ä¸ªç»„ä»¶`const { Provider, Consumer } = React.createContext()`

2. é€šè¿‡`Provider` åŒ…è£¹ä½¿ç”¨æ•°æ®çš„ç»„ä»¶
   - `<Provider value={ this.state.name }></Provider>`
3. é€šè¿‡`<Consumer></Consumer>`  æ¥æ”¶æ•°æ®

```js
<Consumer>
  { data => {
   		return <div style={ { color: data } }></div>
 	} 
   }  
</Consumer>
```

å¾…è¡¥å……: ....

```jsx
1- åˆ›å»ºä¸€ä¸ªContextå¹¶è§£æ„
const { Provider, Consumer } = React.createContext()
class Hello extends Component {
  state = {
    msg: 'å˜»å˜»å˜»....',
    color: 'red'
  }
  render() {
    return (
      <div>
        2- ç”¨ProvideråŒ…è£¹, å¹¶ä½¿ç”¨valueä¼ å€¼
        <Provider value={this.state}>
          <Hello2></Hello2>
        </Provider>
      </div>
    )
  }
}

function Hello2() {
  return (
    <div>
      <Hello3></Hello3>
    </div>
  )
}

class Hello3 extends React.Component {
  render() {
    return (
        3- ä½¿ç”¨Consumer å¹¶ä½¿ç”¨æ•°æ®
      <Consumer>
        {(state) => {
          return <div style={{ color: state.color }}>{state.msg}</div>
        }}
      </Consumer>
    )
  }
}
```





## Propsæ·±å…¥

### children ç»„ä»¶çš„å­èŠ‚ç‚¹

`props`é»˜è®¤æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡

æˆ‘ä»¬åœ¨ä½¿ç”¨ç»„ä»¶`<Hello name="zs" age={40}>å“ˆå“ˆå“ˆ</Hello>` æ—¶, props æ¥æ”¶çš„å€¼ä¸º

```jsx
{
    name: 'zs',
    age: 40,
    children: 'å“ˆå“ˆå“ˆ'
}
```

æˆ‘ä»¬ç»™ç»„ä»¶ä¼ é€’çš„å­èŠ‚ç‚¹, åœ¨`props.children` è·å–

å¯ä»¥ç»™ç»„ä»¶å­èŠ‚ç‚¹ä¼ é€’jså‡½æ•°ç­‰

```jsx
<Hello name="zs" age={40}>
	{ () => console.log('å“ˆå“ˆå“ˆ') }
</Hello>
```



### props ç±»å‹æ ¡éªŒ

 éšç€ä½ çš„åº”ç”¨ç¨‹åºä¸æ–­å¢é•¿ï¼Œä½ å¯ä»¥é€šè¿‡ç±»å‹æ£€æŸ¥æ•è·å¤§é‡é”™è¯¯ã€‚å¯¹äºæŸäº›åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ [Flow](https://flow.org/) æˆ– [TypeScript](https://www.typescriptlang.org/) ç­‰ JavaScript æ‰©å±•æ¥å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºåšç±»å‹æ£€æŸ¥ã€‚ä½†å³ä½¿ä½ ä¸ä½¿ç”¨è¿™äº›æ‰©å±•ï¼ŒReact ä¹Ÿå†…ç½®äº†ä¸€äº›ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ã€‚è¦åœ¨ç»„ä»¶çš„ props ä¸Šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä½ åªéœ€é…ç½®ç‰¹å®šçš„ `propTypes` å±æ€§ 

#### ä½¿ç”¨`prop-types` åº“

å®‰è£…

```jsx
yarn add prop-types
```

å¼•å…¥

```js
import PropTypes from 'prop-types'
```

æ·»åŠ æ ¡éªŒè§„åˆ™  https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html 

```js
 class Greeting extends React.Component {
  render() {
    return (
      <h1>Hello, {this.props.name}</h1>
    )
  }
}

Greeting.propTypes = {
  name: PropTypes.string.isRequired,  æ ¡éªŒä½å­—ç¬¦ä¸²ç±»å‹å¹¶ä¸”æ˜¯å¿…é¡»è¦ä¼ 
  age: PropTypes.number,	æ•°å­—  
  a: PropTypes.array,		æ•°ç»„
  b: PropTypes.bool,		å¸ƒå°”	
  c: PropTypes.func,		å‡½æ•°
  d: PropTypes.number,		æ•°å­—
  e: PropTypes.object,		å¯¹è±¡
  f: PropTypes.string,		å­—ç¬¦ä¸²
  g: PropTypes.node  		ä»»æ„ç±»å‹ 
  h: PropTypes.oneOfType([
    PropTypes.string,
    PropTypes.number,
    PropTypes.instanceOf(Message)
  ])
  children: PropTypes.number       props.children ä¹Ÿå¯ä»¥æ ¡éªŒ  
}
```



#### å±æ€§é»˜è®¤å€¼

```js
æ–¹å¼1: æŒ‡å®š props çš„é»˜è®¤å€¼ï¼š
Hello.defaultProps = {
  children: 'å˜»å˜»å˜»'
}

æ–¹å¼äºŒ:  åœ¨ç»„ä»·å†…éƒ¨ç»™ç»„ä»¶æ·»åŠ é™æ€å±æ€§ä¹Ÿå¯
static defaultProps = {
    children: 'å˜»å˜»å˜»'
}
```





## Reactçš„ç”Ÿå‘½ç”Ÿå‘½å‘¨æœŸ

**react æœ‰ä¸ªçº¦å®š, é’©å­çš„åå­—è¶Šé•¿è¶Šä¸å¸¸ç”¨**

### **ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µ**

æ¯ä¸€ä¸ªç»„ä»¶å°±æ˜¯ä¸€ä¸ªreactå®ä¾‹ï¼Œ ä»åˆ›å»ºã€è¿è¡Œã€ç›´åˆ°é”€æ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šå‘ç”Ÿä¸€ç³»åˆ—çš„äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶å°±å«ç”Ÿå‘½å‘¨æœŸé’©å­

ç”Ÿå‘½å‘¨æœŸé’©å­ä¹Ÿå«ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•° åœ¨ç‰¹å®šçš„æ—¶æœºè‡ªåŠ¨è°ƒç”¨

å°±åƒajaxå¼‚æ­¥è¯·æ±‚, æˆåŠŸåçš„å›è°ƒ, æˆ‘ä»¬å¹¶æ²¡æœ‰è°ƒç”¨, è‡ªåŠ¨è°ƒç”¨



### ç»„ä»¶æŒ‚è½½é˜¶æ®µ

`1. constructor`

ç»„ä»¶åˆ›å»ºä¸Šæ¥å°±æ‰§è¡Œè¿™ä¸ªé’©å­å‡½æ•°, æ˜¯ç»„ä»¶çš„ç¬¬ä¸€ä¸ªé’©å­å‡½æ•°\

è§¦å‘æ—¶æœº: é¡µé¢æ¸²æŸ“ä¹‹å‰

ä½œç”¨: åˆå§‹åŒ–æ•°æ®

`2. render`

åªè¦`state` å‘ç”Ÿæ”¹å˜, å°±ä¼šè°ƒç”¨`render()`

è§¦å‘æ—¶æœº: åˆå§‹åŒ–æ•°æ®ä¹‹å, å°±ä¼šè§¦å‘

ä½œç”¨: æ¸²æŸ“è™šæ‹ŸDOMåˆ°é¡µé¢ä¸Š

`3. componentDidMount`

è™šæ‹ŸDOMå·²ç»åŒæ­¥åˆ°é¡µé¢åçš„ä¼šè°ƒç”¨è¿™ä¸ªé’©å­

ä½¿ç”¨åœºæ™¯:

-  å‘é€ajax, æŠŠæ•°æ®ä¿å­˜å¸¦state ä¸­
- å¯ä»¥æ“ä½œDOM



è§¦å‘é¡ºåº: `constructor -> render -> componentDidMount`

> ä¸€è¾ˆå­åªæ‰§è¡Œä¸€æ¬¡



### ç»„ä»¶æ›´æ–°é˜¶æ®µ

#### **ä¸å¸¸ç”¨é’©å­**

`componentWillReceiveProps`

`shouldComponentUpdate` 

å¦‚æœreturn true åˆ™æ‰§è¡Œæ›´æ–°é˜¶æ®µçš„é’©å­, å¦‚æœrerun false åˆ™ä¸è§¦å‘æ›´æ–°, ç›´æ¥è¿›å…¥è¿è¡Œé˜¶æ®µ

` componentWillUpdate` 



#### å¸¸ç”¨é’©å­å‡½æ•°

`1. render`

state æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶é¡µé¢é‡æ–°æ¸²æŸ“

è§¦å‘æ¡ä»¶: 

- `new props`  å¤–ç•Œä¼ é€’çš„æ•°æ®æ”¹å˜

- `setState()`  å†…éƒ¨ç§æœ‰æ•°æ®æ”¹å˜

- `forceUpdate()` å¼ºåˆ¶æ›´æ–°

> æŒ‰éœ€ï¼Œ æ ¹æ®`props` å±æ€§æˆ–è€… `state` çŠ¶æ€çš„æ”¹å˜é€‰æ‹©æ€§çš„æ‰§è¡Œ



`2. componentDidUpdate`

å·²ç»å®Œæˆæ›´æ–°, é¡µé¢å·²ç»æ˜¯æ–°çš„





#### componentDidUpdateæ³¨æ„äº‹é¡¹

åœ¨`componentDidUpdate` ä¸­ç›´æ¥ä½¿ç”¨`setState` ä¼šé€ æˆæ­»å¾ªç¯

åŸå› : setState() ä¼šè§¦å‘`render() ->componentDidUpdate `  åœ¨ componentDidUpdate åˆè§¦å‘äº†setState åˆæ‰§è¡Œrender () åˆ™å°±è¿›å…¥æ­»å¾ªç¯

è§£å†³æ–¹æ¡ˆ: æœ‰æ¡ä»¶çš„æ‰§è¡Œ, èŠ‚æµé˜€æ€æƒ³

æ¯”è¾ƒæ–°çš„`props.xxx` å±æ€§çš„å€¼å’Œæ—§çš„`prop.xxx` æ˜¯å¦ç›¸ç­‰, ä¸ç›¸ç­‰åˆ™è¿›å…¥åˆ¤æ–­

componentDidUpdate ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ä¸ªå‚æ•°

- å‚æ•°1:  æ—§çš„ `props` 
- å‚æ•°2:  æ—§çš„`preState`

```js
componentDidUpdate (preProps, preState) {
    if (preProps.name !== this.state.name) {
    	this.setState({
            name: 'ls'
        })    
    }
}
```



#### ç»„ä»¶æ·»åŠ key

åœ¨ç»„ä»¶èº«ä¸Šèº«ä¸Šæ·»åŠ å”¯ä¸€æ ‡è¯†`key` , å¯¹äºå¤ç”¨çš„ç»„ä»¶, æ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ›å»ºæ–°ç»„ä»¶, ä¸ä¼šå¤ç”¨ç»„ä»¶

åœ¨ `å¥½ç§Ÿå®¢é¡¹ç›®ä¸­` ,ç­›é€‰åŠŸèƒ½, å¯ä½¿ç”¨ key ä½œä¸ºå¤ç”¨ç»„ä»¶çš„å”¯ä¸€æ ‡è¯†, è§£å†³ state æ— æ³•è·å–çš„é—®é¢˜



### å¸è½½é˜¶æ®µ

`componentWillUnmount`

è§¦å‘æ—¶æœº: åœ¨ç»„ä»¶å°†è¦å¸è½½çš„æ—¶å€™è§¦å‘

ä½¿ç”¨åœºæ™¯: 

- å½“å­ç»„ä»¶é”€æ¯å, å­ç»„ä»¶é‡Œçš„å®šæ—¶å™¨ä¸ä¼šè¢«é”€æ¯, å¯ä»¥åœ¨è¿™ä¸ªé’©å­å‡½æ•°ä¸­å™¨æ¸…é™¤å®šæ—¶å™¨
- ç§»é™¤(window, document) èº«ä¸Šæ³¨å†Œçš„äº‹ä»¶

> ä¸€è¾ˆå­åªæ‰§è¡Œä¸€æ¬¡

**ç§»é™¤ç»„ä»¶(ä¸æ˜¯é’©å­å‡½æ•°)**

`ReactDOM.unmountComponentAtNode()`



![](./image/LifeCycle.png)







### é‡è¦çš„é’©å­

`render()`: åˆå§‹åŒ–æ¸²æŸ“ æˆ– æ›´æ–°æ¸²æŸ“è°ƒç”¨

`componentDidMount()` : å¼€å¯ç›‘å¬, å‘é€ ajaxè¯·æ±‚

`componentWillUnmount()`: åšä¸€äº›æ”¶å°¾å·¥ä½œ, å¦‚: æ¸…ç†å®šæ—¶å™¨

`componentWillReceviceProps()`: 



# React ç¬¬äº”å¤©

## render-props å’Œ é«˜é˜¶ç»„ä»¶

- ä»€ä¹ˆæƒ…å†µä¸‹ ä¼šä½¿ç”¨è¿™ä¸¤ç§æ¨¡å¼ ? **å¤ç”¨**
- å½“ä¸¤ä¸ªç»„ä»¶æˆ–è€…å¤šä¸ªç»„ä»¶æœ‰ä¸€éƒ¨åˆ†` state `   å’Œ  `æ“ä½œ state çš„æ–¹æ³•`  ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„æ—¶å€™, å°±å¯ä»¥å°†è¿™äº›ä»£ç é€»è¾‘ä½¿ç”¨è¿™ä¸¤ç§æ¨¡å¼æ¥å®ç°å¤ç”¨
- ç›®çš„ : **çŠ¶æ€é€»è¾‘å¤ç”¨**    ==> é€šä¿—ç‚¹è¯´ :  å¦ä¸€ç§å°è£…å½¢å¼
- è¦å¤ç”¨çš„å†…å®¹ä¸º : 
  - state 
  - æ“ä½œ state çš„æ–¹æ³•
- æ³¨æ„ 
  - ä¸ç®¡æ˜¯é«˜é˜¶ç»„ä»¶è¿˜æ˜¯ render-props æ¨¡å¼, éƒ½è¦å°†`çŠ¶æ€é€»è¾‘`å°è£…åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ 
  - å¹¶ä¸”è¿™ä¸ªç»„ä»¶åªæä¾›çŠ¶æ€å’Œæ“ä½œçŠ¶æ€çš„æ–¹æ³•é€»è¾‘
  - è¿™ä¸ªç»„ä»¶ä¸æä¾›è¦æ¸²æŸ“çš„UIç»“æ„,  å› ä¸ºè¦æ¸²æŸ“çš„å†…å®¹ä¸ç¡®å®š

- **å­¦ä¹ æ³¨æ„ :** 
  - **æ€æƒ³é‡äºä»£ç **



## render-props  ç»„ä»¶åº“æ€æƒ³

**å°è£…ç»„ä»¶çš„æ€æƒ³**

å°è£…çš„è¿™ä¸ªç»„ä»¶æä¾›æŸäº›ç‰¹å®šçš„æ–¹æ³•, æˆ‘ä»¬å¼•å…¥ç»„ä»¶, èƒ½å¤Ÿæ‹¿åˆ°è¿™ä¸ªç»„ä»¶æ–¹æ³•æä¾›çš„æ•°æ®, æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªæ•°æ®, å»åšå…·ä½“çš„äº‹æƒ…ä¾‹å¦‚æˆ‘ä»¬æ‹¿åˆ°å°è£…ç»„ä»¶æä¾›çš„é¼ æ ‡ä½ç½®, æŠŠè¿™ä¸ªæ•°æ®ä½“ç°åœ¨é¡µé¢ä¸Šç­‰.

**æ€»ç»“**: å°è£…çš„ç»„ä»¶æœ‰ç‰¹å®šçš„æ–¹æ³•, å¹¶æä¾›ç‰¹å®šåŠŸèƒ½çš„æ•°æ®, æˆ‘ä»¬`import` ç»„ä»¶èƒ½å¤Ÿå¾—åˆ°è¿™äº›æ•°æ®, æˆ‘ä»¬éœ€è¦é€šè¿‡`props` å»ä¼ é€’æ–¹æ³•, å°è£…ç»„ä»¶ä¼šè°ƒç”¨, æˆ‘ä»¬åœ¨æä¾›æ–¹æ³•çš„æ—¶å€™, å°±èƒ½å¤Ÿæ‹¿åˆ°å°è£…ç»„ä»¶æä¾›çš„æ•°æ®



**ç»„ä»¶åº“ä½¿ç”¨åŸç†:** 

æˆ‘ä»¬å¼•ç”¨äººå®¶çš„ç»„ä»¶

- æˆ‘ä»¬æ‹¿åˆ°æ•°æ®åšæˆ‘ä»¬æƒ³åšçš„æ“ä½œ

```js
<Mouse render={ (data) => {  } } >
```

ç»„ä»¶åº“å°è£…

- è°ƒç”¨æˆ‘ä»¬æä¾›çš„æ–¹æ³•
- å¹¶ä¸”æŠŠæ•°æ®ä¹Ÿä¼ é€’å‡ºå»

```js
render () {
    return this.props.render(this.state)
}
```



**åŸç†**: å…¶å®å°±æ˜¯, ä»¥å±æ€§ä¼ é€’çš„å½¢å¼, ç»™ç»„ä»¶çš„propsä¼ é€’ä¸€ä¸ª`render` å‡½æ•°, åœ¨è¿™ä¸ªå‡½æ•°é‡Œ, `return` å‡ºç»„ä»¶æƒ³è¦æ¸²æŸ“çš„`React JSX` å…ƒç´ , åœ¨ç»„ä»¶çš„renderé’©å­æ¸²æŸ“æ—¶è°ƒç”¨`this.props.render` è·å–ä¼ é€’è¿‡æ¥çš„JSXå…ƒç´ , åœ¨è°ƒç”¨`this.props.render(this.state)` è°ƒç”¨æ—¶ä¼ é€’å‚æ•°ç»™ ä¼ é€’çš„å±æ€§render



**æ€»ç»“ä½¿ç”¨å…±åŒæ­¥éª¤**

- 1.ç»™ Mouse ç»„ä»¶ä¼ é€’ `render å±æ€§`    ( renderå±æ€§çš„å€¼ æ˜¯ä¸€ä¸ªå‡½æ•° )
- 2.é€šè¿‡ render å‡½æ•°å±æ€§çš„**å‚æ•°** æ¥è·å–ç»„ä»¶å†…éƒ¨å¤ç”¨çš„çŠ¶æ€ (æ¯”å¦‚ : é¼ æ ‡ä½ç½®æ•°æ®)
- 3 é€šè¿‡renderå‡½æ•°å±æ€§çš„**è¿”å›å€¼**æ¥æŒ‡å®šæœ€ç»ˆè¦æ¸²æŸ“åœ¨ é¡µé¢ä¸­çš„å†…å®¹

```js
import React from 'react'
import ReactDOM from 'react-dom'
import Mouse from './Mouse'
import Cat from './cat.png'

ReactDOM.render(
  <Mouse
    # å®šä¹‰renderä¼ é€’ç»™ç»„ä»¶
    render={(data) => {
      return (
      <div>
        <p>æ°´å¹³ä½ç½®: {data.x}</p>
        <p>å‚ç›´æ–¹å‘: {data.y}</p>
        <img src={Cat} alt="" style={{ position: 'absolute', left: data.x - 64, top: data.y - 64 }} />
      </div>
    )}}></Mouse>,
  document.querySelector('#root'))
```

åœ¨`Mouse` ç»„ä»¶ä¸­è°ƒç”¨`render(this.state)` å‡½æ•°å¹¶ä¼ é€’æ‰€éœ€è¦çš„æ•°æ®

```jsx
import React from 'react'
export default class Mouse extends React.Component {
  state = {
    x: '',
    y: ''
  }
  render() {
    return this.props.render(this.state)
  }
  componentDidMount() {
    window.addEventListener('mousemove', this.handler)
  }

  handler = e => {
    this.setState({
      x: e.clientX,
      y: e.clientY
    }) 
  }
}
```



#### `props.children`ä»£æ›¿ `render`

- æ³¨æ„ : ä¸æ˜¯è¯¥æ¨¡å¼å« render-props æ¨¡å¼, å°±å¿…é¡»ä½¿ç”¨render å±æ€§
  - å®é™…ä¸Š, åªè¦æœ‰ä¸€ä¸ªå±æ€§æ¥å‘Šè¯‰ç»„ä»¶è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹, å…¶å®è¿™å°±æ˜¯ render-props æ¨¡å¼äº†
- **æ¨è : ä½¿ç”¨ children ä»£æ›¿ render å±æ€§**
- **ä½¿ç”¨ children æ¼”ç¤ºä½ç½®å’ŒçŒ«**

```js
ReactDOM.render(
  <Mouse>
    { (data) => {
      return (
      <div>
        <p>æ°´å¹³ä½ç½®: {data.x}</p>
        <p>å‚ç›´æ–¹å‘: {data.y}</p>
        <img src={Cat} alt="" style={{ position: 'absolute', left: data.x - 64, top: data.y - 64 }} />
      </div>
    ) }}
  </Mouse>,
  document.querySelector('#root'))
```



#### ä½¿ç”¨åœºæ™¯

åœºæ™¯1:  `context`

ç¬¬ä¸€æ­¥: å®šä¹‰ä¸Šä¸‹æ–‡ context

ç¬¬äºŒæ­¥: ä½¿ç”¨`Provider` åŒ…è£¹

ç¬¬ä¸‰æ­¥: ä½¿ç”¨`Consumer` åŒ…è£¹, æ ‡ç­¾å†…éƒ¨ç»™ä¸€ä¸ªç®­å¤´å‡½æ•°, return jsx å…ƒç´ 

```js
#  è¿™å°±æ˜¯render props çš„æ€æƒ³å®ç°çš„
<Consumer>
  { data => {
   		return <div style={ { color: data } }></div>
 	} 
   }  
</Consumer>
```



åœºæ™¯2: `react-spring` åŠ¨ç”»åº“

ä¹Ÿç”¨çš„æ˜¯`render props` çš„å°è£…æ€æƒ³

```js
yarn add react-spring

import { Spring } from 'react-spring/renderprops'
```

ä½¿ç”¨: 

```js
ReactDOM.render(
  <Spring from={{ opacity: 0 }} to={{ opacity: 1 }} config={{ duration: 4000 }}>
    {
      data => (
    	<h1 sytle={data}></h1>
      )
	}
  </Spring>,
  document.querySelector('#root'))
```





## é«˜é˜¶ç»„ä»¶ HOC

#### å¼•å…¥->é«˜é˜¶å‡½æ•°

ä¸€ä¸ªå‡½æ•° `return` ä¸€ä¸ª å‡½æ•° å°±å«åšé«˜é˜¶å‡½æ•°

åŒç†: ä¸€ä¸ªå‡½æ•° `return` ä¸€ä¸ªç»„ä»¶, è¿™ä¸ªç»„ä»¶å°±å«åšé«˜é˜¶ç»„ä»¶

```js
è¿™å°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°
const func = (x) => {
    return (y) => {
        return x + y
    }
}

func(1)(2) // 3
```

æ¨èä¹¦ç± JS å‡½æ•°å¼ç¼–ç¨‹  https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ 

#### é«˜é˜¶ç»„ä»¶ä»‹ç»

é«˜é˜¶ç»„ä»¶: HOC : Higher-Order Component

- **é«˜é˜¶ç»„ä»¶ :**  HOC : Higher-Order Component
- å®é™…ä¸Š**å°±æ˜¯ä¸€ä¸ªå‡½æ•°**,  è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ¥å—ä¸€ä¸ª**å‚æ•°ç»„ä»¶**, ç„¶å,è¿”å›ä¸€ä¸ª**å¢å¼ºåçš„ç»„ä»¶**
- **å‚æ•°ç»„ä»¶** : å°±æ˜¯éœ€è¦è¢«åŒ…è£…çš„ç»„ä»¶
- **è¿”å›çš„ç»„ä»¶** : å¢å¼ºåçš„ç»„ä»¶, è¿™ä¸ªç»„ä»¶ä¸­å°±æ˜¯é€šè¿‡Propsæ¥æ¥æ”¶åˆ°å¤ç”¨çš„çŠ¶æ€é€»è¾‘çš„

- **æ€æƒ³ : å°±æ˜¯ç»„ä»¶åœ¨å¢å¼ºçš„è¿‡ç¨‹ä¸­, ä¼ å…¥äº†ä¸€äº›æ•°æ®ç»™ ç»„ä»¶çš„ props**

```js
const å¢å¼ºåçš„ç»„ä»¶ = é«˜é˜¶ç»„ä»¶(è¢«åŒ…è£…ç»„ä»¶)
```

>  é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äº *  å¤ç”¨ç»„ä»¶é€»è¾‘  *çš„ä¸€ç§é«˜çº§æŠ€å·§ 

**é«˜é˜¶ç»„ä»¶çº¦å®š:** 

- é«˜é˜¶ç»„ä»¶çš„åç§°éƒ½ä»¥`with` å¼€å¤´
- é«˜é˜¶ç»„ä»¶çš„å‚æ•°ä¸ºä¸€ä¸ªç»„ä»¶, çº¦å®šå½¢å‚ä¸º**é¦–å­—æ¯å¤§å†™**
- é«˜é˜¶ç»„ä»¶é‡Œåˆ›å»ºäº†ä¸€ä¸ªç»„ä»¶, å¹¶ä¸”æŠŠè¿™ä¸ªç»„ä»¶è¿”å›å‡ºå» 
- é«˜é˜¶ç»„ä»¶é‡Œé¢å¯ä»¥æä¾›ä¸€ä¸ªstateæ•°æ®, å’Œæ“ä½œstateçš„æ–¹æ³•

#### é«˜é˜¶ç»„ä»¶åŸºç¡€ä½¿ç”¨

åœ¨`index.js` æ–‡ä»¶ä¸­

```js
import React from 'react'
import ReactDOM from 'react-dom'
import App from './App'

ReactDOM.render(<App></App>,document.querySelector('#root'))
```

åœ¨`APP.js` ç»„ä»¶ä¸­

- é«˜é˜¶ç»„ä»¶ä¼ å‚, ç›´æ¥åœ¨ç»„ä»¶ä¸­æ‹¿ä¸åˆ°, å› ä¸ºç»è¿‡é«˜é˜¶ç»„ä»¶åŒ…è£¹, åˆ™éœ€è¦é«˜é˜¶ç»„ä»¶åœ¨ä¼ é€’ä¸€æ¬¡

```js
import React from 'react'
// import withCopyRight from './withCopyRight'
import Another from './Another'
class App extends React.Component {
  render() {
    return (
      <>
        APP
        # åªè¦ä½¿ç”¨äº†é«˜é˜¶ç»„ä»¶åŒ…è£¹çš„è¿›è¡Œä¼ å€¼, åˆ™å®é™…ä¼ é€’ç»™äº†é«˜é˜¶ç»„ä»¶, å¹¶ä¸”è¿™ä¸ªç»„ä»¶æœ¬èº«
        <Another name="å¼ ä¸‰"></Another>
      </>
    )
  }
}
export default App
```



ç»„ä»¶`Another.js` ä½¿ç”¨é«˜é˜¶ç»„ä»¶

- å¯¼å‡ºçš„ä¸æ˜¯ç»„ä»¶æœ¬èº«è€Œæ˜¯ç»„ä»¶åŒ…è£¹åœ¨é«˜é˜¶ç»„ä»¶é‡Œé¢, å°±ä¼šé™„å¸¦æœ‰é«˜é˜¶ç»„ä»¶çš„å†…å®¹

```js
import React from 'react'
import withCopyRight from './withCopyRight'
 class Another extends React.Component {
  state = {}
  render () {
    console.log(this.props)
    return (
      <div>
        Another {this.props.name}
      </div>
    )
  }
}
export default withCopyRight(Another)
```



å®šä¹‰é«˜é˜¶ç»„ä»¶`withCopyRight.js`

- åœ¨ä»¥åçš„ä½¿ç”¨ä¸­, ä¼šä½¿ç”¨åˆ«äººå°è£…çš„é«˜é˜¶ç»„ä»¶
- æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€äº›é«˜é˜¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§, ç»™æˆ‘ä»¬ä½¿ç”¨

```js
import React from 'react'
const withCopyRight = (YourComponent) => {
  return class withCopyRight extends React.Component {
    render() {
        # é«˜é˜¶ç»„ä»·æ‹¿åˆ°äº†propsä¼ é€’çš„å€¼
     console.log(this.props)
      return (
        <>
          #  è¿™é‡Œéœ€è¦é«˜é˜¶ç»„ä»¶åœ¨ä¼ é€’ä¸€æ¬¡, åˆ™ç»„ä»¶æ‰èƒ½å¾—åˆ°ä¼ é€’çš„propså€¼
          <YourComponent {...this.props}></YourComponent>
          <div>&copy; 2019 &emsp; ä¼ æ™ºæ’­å®¢</div>
        </>
      )
    }
  }
}
export default withCopyRight
```



#### ç»™é«˜é˜¶ç»„ä»¶æ·»åŠ displayName 

- **displayName**ï¼šç”¨äºè®¾ç½® react-dev-tools ï¼ˆæµè§ˆå™¨ä¸­çš„reactæ’ä»¶ï¼‰ ä¸­ç»„ä»¶çš„å±•ç¤ºåç§°
- **æ³¨æ„**ï¼šè¯¥å±æ€§ä»…ä»…ç”¨äºè®¾ç½®å±•ç¤ºåç§°ï¼Œå¹¶ä¸ä¼šå¯¹ç»„ä»¶åŠŸèƒ½äº§ç”Ÿå½±å“ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä¸æƒ³å† react-dev-tools ä¸­è¿›è¡ŒåŒºåˆ†ï¼Œå®é™…ä¸Šï¼Œå¯ä»¥çœç•¥è¯¥è®¾ç½®ã€‚
- æ¼”ç¤º : æ•ˆæœ

```js
// åŒæ—¶æ¸²æŸ“å¤šä¸ªé«˜é˜¶ç»„ä»¶çš„æ—¶å€™
ReactDOM.render(<div>
  <HocPosition/>
  <HocCat/>
</div>, document.getElementById('root'))

// åœ¨ react-dev-tools ä¸Šé¢æ˜¾ç¤ºçš„æ˜¯è¿™æ ·çš„
<Mouse>...</Mouse>
<Mouse>...</Mouse>
                
// è¿™æ ·å¾ˆä¸å®¹æ˜“åŒºåˆ†,æ‰€æœ‰éœ€è¦æ·»åŠ displayName
```

- å¦‚ä½• è®¾ç½® displayName  ?   **åœ¨é«˜é˜¶ç»„ä»¶ä¸­å®šä¹‰**

```js
const withMouse = (WrappedComponent) => {
  class Mouse extends React.Component {
    ... çœç•¥é¼ æ ‡ä½ç½®çŠ¶æ€ å’Œ æ“ä½œé¼ æ ‡ä½ç½®çš„æ–¹æ³•é€»è¾‘
  }

  // ç»™é«˜é˜¶ç»„ä»¶è®¾ç½®åç§°ï¼Œå°†æ¥åœ¨ react-dev-tools å·¥å…·ä¸­ï¼Œèƒ½å¤ŸåŒºåˆ†åˆ°åº•æ˜¯å“ªä¸€ä¸ªé«˜é˜¶ç»„ä»¶åŒ…è£…çš„ç»„ä»¶
  function getDisplayName(WrappedComponent) {                          # +
    return WrappedComponent.displayName || WrappedComponent.name 
  }
  Mouse.displayName = getDisplayName(WrappedComponent)                 # +
  // å¦‚æœè¿˜æƒ³ä½“ç°å‡ºæ¥æ˜¯é«˜é˜¶ç»„ä»·,å°±åŠ ä¸ªå‰ç¼€
  Mouse.displayName = `WithMouse_${getDisplayName(WrappedComponent)}`  # +

  return Mouse
}
- è¡¥å……: 
- å…ˆè·å–è¢«åŒ…è£…ç»„ä»¶çš„ displayName ,å¦‚æœæ²¡æœ‰å°±è·å–å®ƒçš„åå­—,å¦‚æœå†æ²¡æœ‰æ¥ä¸ªé»˜è®¤çš„æœ€èµ·ç ä¸ä¼šæŠ¥é”™æˆ–è€…è¿”å›undefined
- WrappedComponent.displayName || WrappedComponent.name 
```



#### ç»™é«˜é˜¶ç»„ä»¶ä¼ é€’å±æ€§

- é—®é¢˜ : å¦‚æœç»™ é«˜çº§ç»„ä»¶ä¼ å±æ€§, å‘ç°ä¼šä¸¢å¤±,
- åŸå›  :  é«˜çº§ç»„ä»¶å†…éƒ¨ç»™åˆ›å»ºçš„Mouseç»„ä»¶å†…æ²¡æœ‰èµ‹å€¼å±æ€§. å³ é«˜é˜¶ç»„ä»¶æ²¡æœ‰å¾€ä¸‹ä¼ é€’ Props
- è§£å†³åŠæ³• : æ¸²æŸ“ WrappedComponentæ—¶, å°† state å’Œ this.props ä¸€èµ·ä¼ é€’ç»™ Mouseç»„ä»¶
- ä¼ é€’æ–¹æ³•

```js
// å¦‚æœå¤šåŠ äº†å±æ€§
<HocPosition name='jack'/>

// é«˜é˜¶ç»„ä»·å†…éƒ¨ :
const withMouse = (WrappedComponent) => {
  class Mouse extends React.Component {
    ... çœç•¥é¼ æ ‡ä½ç½®çŠ¶æ€ å’Œ æ“ä½œé¼ æ ‡ä½ç½®çš„æ–¹æ³•é€»è¾‘

    render() { 
      // ä¹‹å‰è¿™é‡Œåªä¼ é€’ç»™åŒ…è£…ç»„ä»¶ state ,å¹¶æ²¡æœ‰ä¼ é€’props
      return <WrappedComponent {...this.state}  {...this.props}  />    # ++++
    }
  }
  return Mouse
}

// ä½¿ç”¨
const Position = props => {
  // é€šè¿‡ props å°±å¯ä»¥è·å–åˆ°ä¼ é€’ç»™é«˜é˜¶ç»„ä»¶çš„å±æ€§äº†
  // ... çœç•¥å…¶ä»–ä»£ç 
}
```



#### ä¿®é¥°å™¨æ˜¯es7 çš„ç‹¬ç«‹è¯­æ³•

æµè§ˆå™¨å½“å‰ä¸æ”¯æŒè¿™ä¸ªè¯­æ³•, éœ€è¦é…ç½®babel

1. å®‰è£…åŒ…

```js
yarn add @babel/plugin-proposal-decorators
```

2. å¯¼å‡ºwebpacké…ç½®(gitç¯å¢ƒéœ€è¦commit)
   - èƒ½å¤Ÿå°†node_modules ä¸­çš„ webpack é…ç½®å¯¼å‡ºåˆ°æ ¹ç›®å½•	å’Œ package.jsonä¹Ÿä¼šå¤šä¸€äº›é…ç½®

```js
yarn eject // èƒ½å¤Ÿå°†node_modules ä¸­çš„ webpack é…ç½®å¯¼å‡ºåˆ°æ ¹ç›®å½•å’Œ package.jsonä¹Ÿä¼šå¤šä¸€äº›é…ç½®
```

3. åœ¨ package.json ä¸­ æ·»åŠ babel , plugins

```js

```

4. éœ€è¦å®‰è£…`@babel/plugin-transform-react-jsx-self`

```js
yarn add @babel/plugin-transform-react-jsx-self
```



**ä½¿ç”¨**

ä¿®é¥°å™¨ä¹Ÿå¯ä»¥ä¼ å‚

```js
ä¸ä½¿ç”¨ä¿®é¥°å™¨
const test = (component) => {
    component.isOk = true
}
class Person {}
test(component)
console.log(component.isOk) // true

ä½¿ç”¨ä¿®é¥°å™¨
const test = (component) => {
    component.isOk = true
}

@test  # è¿™é‡Œå¯ä»¥ä¼ å‚
class Person {}
console.log(component.isOk) // true
```





#### é«˜é˜¶ç»„ä»¶ + ä¿®é¥°å™¨

åŒ…å: `react-app-rewired`

è£…åŒ…

```js
$ yarn add react-app-rewired
```

**ä½¿ç”¨è£…é¥°å™¨å†™æ³•**

1- ä½¿ç”¨`react-app-rewired` å†™æ³•

```js
import React from 'react'
import withCopyRight from './withCopyRight'

@withCopyRight
class Another extends React.Component {
  state = {}
  render() {
    // console.log(this.props)
    return <div>Another {this.props.name}</div>
  }
}
export default Another

```

2- ä¿®æ”¹package.json ä¸­çš„ `scripts` 

```js
  "scripts": {
    "start": "react-app-rewired start",
    "build": "react-app-rewired build",
    "test": "react-app-rewired test",
    "eject": "react-scripts eject"
  },
```

3- åˆ›å»º`config-overrides.js` æ–‡ä»¶

```js
# é…ç½®è¾ƒä¸ºéº»çƒ¦
module.exports = (config) => {
  #  å¦‚æœæ²¡æœ‰ä½¿ç”¨ customize-cra å°±éœ€è¦åœ¨è¿™é‡Œè¿›è¡Œé…ç½®
  
  return config
}
```

4- ä½¿ç”¨è¾ƒä¸ºç®€å•çš„`customize-cra` åŒ…é…ç½® -> ä¾èµ–``react-app-rewired``

```js
yarn add customize-cra
```

å¯¼å…¥é…ç½®``config-overrides.js``

- å¿…é¡»å®‰è£…ä¾èµ–åŒ…`yarn add @babel/plugin-proposal-decorators`

```js
const { override, addDecoratorsLegacy }  = require('customize-cra')
module.exports = override(
  addDecoratorsLegacy()
)
```



## setState å¼‚æ­¥è¯¦è§£

setState() æ›´æ–°æ˜¯å¼‚æ­¥çš„

#### ä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„

å¦‚æœæ˜¯åŒæ­¥, å½“å­˜åœ¨å¤šä¸ª`setState` çš„æ—¶å€™, å°±ä¼šå­˜åœ¨é˜»å¡

#### setStateå‚æ•°

å‚æ•°1: è¦ä¿®æ”¹çš„å¯¹è±¡

å‚æ•°2: å¼‚æ­¥çš„å›è°ƒå‡½æ•°, è¿™é‡Œèƒ½æ‹¿åˆ°setStateæ‰§è¡Œåçš„ç»“æœ

```js
console.log(this.state.count)  # 0
# æ›´æ–°æ˜¯å¼‚æ­¥çš„
this.setState({
    count: this.state.count++
}, () => {
    console.log(this.state.count) # è¿™é‡Œèƒ½å¤Ÿåˆ°æ›´æ–°åæœ€æ–°çš„ç»“æœ 1
})

console.log(this.state.count) # 0
```



#### å¤šæ¬¡è°ƒç”¨setStateé—®é¢˜

- ç”±äºä¸¤æ¬¡setState éƒ½æ˜¯å¼‚æ­¥çš„, æ‰€ä»¥ä¸¤æ¬¡æ‹¿çš„`count` éƒ½æ˜¯ 0 , åœ¨0 çš„åŸºç¡€ä¸Š +1

```js
 console.log('å‰', this.state.count) // 0
    // å¼‚æ­¥æ›´æ–°
    this.setState({
      count: this.state.count + 1  // ä»¥ä¸ºæ˜¯ 1
    }, () => {
       console.log(this.state.count)  # 1
    })
    // å¼‚æ­¥æ›´æ–°  + è·å– ç»“æœ
    this.setState(
      {
        count: this.state.count + 1 // ä»¥ä¸ºæ˜¯ 2
      },
      () => {
        console.log(this.state.count) #  ä»¥ä¸ºæ˜¯ 2 ä½†æ˜¯ç»“æœæ˜¯ 1
      }
    )
// ä¸¤æ¬¡æ›´æ–° å‘ç°ç»“æœè¿˜éƒ½æ˜¯ 1 , åŸå› æ˜¯å› ä¸º æ¯æ¬¡è·å–çš„this.state.count `éƒ½æ˜¯æœ€å¼€å§‹çš„ 0` ,
// å½“æ‰§è¡Œthis.state.count + 1 çš„æ—¶å€™,ä¸€çœ‹æ˜¯å¼‚æ­¥çš„éƒ½æ»šä¸€è¾¹å», å½“å›æ¥çš„æ—¶å€™,éƒ½æ˜¯1
```

è§£å†³é—®é¢˜: è·å–å¼‚æ­¥æœ€æ–°çš„stateå€¼

ä½¿ç”¨åœºæ™¯: å¤šä¸ªsetState å‡ºç°, æ“ä½œ`state` æ•°æ®æ—¶

**å‡½æ•°å¼å‚æ•°è¯­æ³•**

- state : æœ€æ–°çš„ state
- props: æœ€æ–°çš„ props

```js
this.setState((state, props) => {
    return {
        count: state.count + 1
    }
}, () => {
    console.log(this.state.count) 
})
```

åŸºç¡€ä½¿ç”¨

- å½“æˆ‘ä»¬å¤šæ¬¡æ“ä½œstate æ—¶, reactçŸ¥é“æˆ‘ä»¬æ¯æ¬¡çš„æ“ä½œ, ä¼šåœ¨ä¸Šæ¬¡çš„`setState` ç»“æœå‡ºæ¥å, åœ¨æ­¤åŸºç¡€ä¸Šè®¡ç®—
- æ‰€æœ‰`setState`çš„å›è°ƒéƒ½ä¼šåœ¨æ‰€æœ‰`setState` æ•°æ®ä¿®æ”¹åæ‰ä¼šæ‰§è¡Œ, ä¹Ÿå°±æ„å‘³ç€æ‰€æœ‰`setState` çš„å›è°ƒå‡½æ•°å¾—åˆ°çš„stateæ˜¯æ‰€æœ‰setStateä¿®æ”¹åçš„ç»“æœ

```js
  state = {
    msg: 0
  }
  render() {
    return (
      <div>
        <button onClick={this.fn}>ç‚¹å‡»+1</button>
        <p>{this.state.msg}</p>
      </div>
    )
  }
fn = () => {
	console.log('ä¸Šé¢', this.state.msg) # 0
	this.setState(
		(state) => {
			return {
				msg: state.msg + 1
			}
		},
		() => {
			console.log('ç¬¬ä¸€æ¬¡ä¿®æ”¹', this.state.msg) # 6
		}
	)

	this.setState(
		(state) => {
			return {
				msg: state.msg + 5
			}
		},
		() => {
			console.log('ç¬¬äºŒæ¬¡ä¿®æ”¹', this.state.msg) # 6
		}
	)
	console.log('ä¸‹é¢', this.state.msg) # 0
}

```





## JSXè¯­æ³•çš„è½¬æ¢è¿‡ç¨‹(äº†è§£)

> æ¼”ç¤º  : babelä¸­æ–‡ç½‘è¯•ä¸€è¯• let h1 = <div></div>

- JSX ä»…ä»…æ˜¯createElement() æ–¹æ³•çš„è¯­æ³•ç³– (ç®€åŒ–è¯­æ³•)
- JSX è¯­æ³• è¢« @babel/preset-react  æ’ä»¶ç¼–è¯‘ä¸º createElement() æ–¹æ³•
- React å…ƒç´ ï¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥æè¿°ä½ å¸Œæœ›åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹
- React å…ƒç´  æœ€å è¢«  `ReactDOM.render(<Child/>,document.getElementById('root'))` æ¸²æŸ“æ˜¾ç¤ºåˆ°é¡µé¢

![](./image/jsx.png)



# React ç¬¬å…­å¤©



## ç»„ä»¶æ›´æ–°æœºåˆ¶

#### è°ƒç”¨setState

- setState çš„ä¸¤ä¸ªä½œç”¨
  - ä¿®æ”¹state
  - é‡æ–°è°ƒç”¨render , æ›´æ–°ç»„ä»¶(UI)
- **è¿‡ç¨‹** : **çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶, æ‰€æœ‰çš„å­ç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ -> æœ‰æ€§èƒ½é—®é¢˜** 

![](./image/æ›´æ–°æœºåˆ¶.png)



## ç»„ä»¶æ›´æ–°æ€§èƒ½ä¼˜åŒ–

#### stateä¼˜åŒ–

å› ä¸ºstate å‘ç”Ÿæ”¹å˜, render å°±ä¼šé‡æ–°æ¸²æŸ“, æ‰€ä»¥ ä¸æ¸²æŸ“æ— å…³çš„ æ•°æ® å°±ä¸è¦æ”¾åœ¨ state é‡Œ

é‚£ä¸æ”¾åœ¨stateé‡Œæ”¾åœ¨å“ªå‘¢ ?  ç›´æ¥ä»¥å±æ€§åˆå§‹åŒ–è¯­æ³•, æ·»åŠ åˆ° ç»„ä»¶çš„èº«ä¸Š

åœ¨renderä¸­æ²¡æœ‰ç”¨åˆ° `age` å¦‚æœå‘ç”Ÿæ”¹å˜ä¹Ÿä¼šé‡æ–°æ¸²æŸ“

```js
state = {
    name: 'å¼ ä¸‰',
    age: 80
} 

//
age = 80

render () {
    return <div>{this.state.name}</div>
}

fn = () => {
    this.setState({
        age: this.state.age + 1
    })
}
```





#### shouldComponentUpdateä¼˜åŒ–

`shouldComponentUpdate() {}` è¿™ä¸ªä¸€ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­, åœ¨`render` ä¹‹å‰è°ƒç”¨

é»˜è®¤ä¸å†™æ˜¯`return true`  ä¸º å…è®¸æ›´æ–°, å¦‚æœ`return false` åˆ™ä¸å…è®¸æ›´æ–° , ç»ˆæ­¢æ›´æ–°

- **ç»„ä»¶æ›´æ–°æœºåˆ¶** : çˆ¶ç»„ä»¶æ›´æ–°ä¼šå¼•èµ·å­ç»„ä»¶ä¹Ÿè¢«æ›´æ–°
- **é—®é¢˜** : å­ç»„ä»¶æ²¡æœ‰ä»»ä½•å˜åŒ–æ—¶, ä¹Ÿä¼šé‡æ–°æ¸²æŸ“
- **å¦‚ä½•é¿å…**ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“å‘¢ ? 
- **è§£å†³æ–¹å¼** : ä½¿ç”¨ é’©å­å‡½æ•°` shouldComponentUpdate(nextProps, nextState)`
  - nextProps  : æœ€æ–°çš„å±æ€§
  - nextState : æœ€æ–°çš„çŠ¶æ€
  - **åœºæ™¯** : æ¯”è¾ƒæ›´æ–°å‰åçš„ state æˆ–è€… props æ˜¯å¦ç›¸åŒ, æ¥å†³å®šæ˜¯å¦ æ›´æ–°ç»„ä»¶
- **ä½œç”¨** :  é€šè¿‡è¿”å›å€¼ å†³å®šè¯¥ç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“, è¿”å›true ,è¡¨ç¤ºé‡æ–°æ¸²æŸ“, false è¡¨ç¤ºä¸é‡æ–°æ¸²æŸ“
- **è§¦å‘æ—¶æœº** : æ›´æ–°é˜¶æ®µçš„é’©å­å‡½æ•°, ç»„ä»¶é‡æ–°æ¸²æŸ“   **å‰**   æ‰§è¡Œ 
  - é¡ºåº :  shouldComponentUpdate()   ==> render()  ==>  componentDidMount()
- **æ¼”ç¤º** : ç‚¹å‡»çˆ¶ç»„ä»¶çš„è®¡ç®—å™¨çš„æ•°æ®count

```js
// æ¼”ç¤º1 : å­ç»„ä»¶é‡Œ é€šè¿‡ shouldComponentUpdate()  { return true or false } 
	- true-æ›´æ–°
	- false-ä¸æ›´æ–°

// æ¼”ç¤º2 : è·å– çˆ¶ä¼ è¿‡æ¥çš„å±æ€§, å¥‡æ•°æ›´æ–°,å¶æ•°ä¸æ›´æ–°,  
  shouldComponentUpdate(nextProps,nextState)
	  - nextProps : æœ€æ–°çš„å±æ€§
    - nextState : æœ€æ–°çš„çŠ¶æ€
 - if(nextState.count % 2 == 0) {
        return false    
     }else { 
        return true
     }

// æ¼”ç¤º3 : å°±ä¸€ä¸ªç»„ä»¶é‡Œæœ‰number å€¼, ç‚¹å‡»äº§ç”Ÿéšæœºå€¼, æ¯”è¾ƒå‰åç”Ÿæˆçš„éšæœºå€¼æ˜¯å¦ä¸€è‡´,ä¸ä¸€è‡´å°±æ›´ç»†, ä¸€è‡´å°±ä¸éœ€è¦æ›´æ–°
// count : Math.floor(Math.random()*3)
 shouldComponentUpdate(nextProps,nextState) {
     
     //          ä¸Šä¸€ä¸ªçš„å€¼                  æœ€æ–°çš„å€¼
     console.log(this.state.count === nextState.count)
     
     // æœ¬æ¬¡çš„ nextState.number
     // ä¸Šä¸€æ¬¡çš„ this.state.number
     //  æˆ–è€… é€šè¿‡ if..else..åˆ¤æ–­ 
     return this.state.count !== nextState.count
 }
```



#### PureComponent çº¯ç»„ä»¶

åŠŸèƒ½å’Œ`React.Component` åŠŸèƒ½ä¸€æ ·, ä½†æ˜¯å®ƒæ˜¯çº¯ç»„ä»¶, å®ƒå†…éƒ¨ä¼šå¯¹æ¯” `shouldComponentUpdate` , ä¼šè‡ªåŠ¨å¯¹æ¯”å‰åprops å’Œ state , å¦‚æœå€¼æ²¡æœ‰å˜åŒ–, ä¼šè‡ªåŠ¨åœ¨`shouldComponentUpdate(){}` ä¸­ return false ä¸è°ƒç”¨ render

**ä½œç”¨** : è‡ªåŠ¨å®ç°äº† shouldComponentUpdate() é’©å­å‡½æ•°, ä¸éœ€è¦å†æ‰‹åŠ¨å¯¹æ¯”æ›´æ–°å‰åçš„props æˆ–è€… state , æ¥é˜»æ­¢ä¸å¿…è¦çš„æ›´æ–°äº†

**åŸç†** : PureComponent å†…éƒ¨, ä¼šåˆ«å¯¹æ¯”æ›´æ–°å‰åçš„props ä»¥åŠæ›´æ–°å‰åçš„state , åªè¦æœ‰ä¸€ä¸ªä¸åŒ, å°±ä¼šè®©ç»„ä»¶æ›´æ–°, åªæœ‰åœ¨ä¸¤è€…éƒ½ç›¸åŒçš„æƒ…å†µä¸‹, æ‰ä¼šé˜»æ­¢ç»„ä»¶æ›´æ–°

```js
import React, {PureComponent} from 'react'
class Hello extends PureComponent {}
```

> æ³¨æ„: PureComponent å¯¹æ¯”çš„props å’Œ state  åªæ˜¯æµ…å±‚æ¯”è¾ƒ

åƒè¿™ç§state ä¸­ çš„å±æ€§æ˜¯ç®€å•ç±»å‹, PureComponent å¯¹æ¯”æ˜¯æ²¡é—®é¢˜çš„

ä½†æ˜¯å¯¹äºå¤æ‚æ•°æ®ç±»å‹, åªè¦åœ°å€ä¸å‘ç”Ÿæ”¹å˜, PureComponent åˆ™è®¤ä¸º state æ˜¯æ²¡æœ‰æ”¹å˜, æ—¶é’Ÿä¸ä¼šè°ƒç”¨ render

```js
state = {
    count: 0,
    obj: {
        num: 0
    }
}
```

ä½¿ç”¨æ–°å¯¹è±¡è®©åœ°å€æ”¹å˜, ä¼šè§¦å‘PureComponent æ›´æ–°

```js
const newObj = {...this.state.obj} // åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡

newObj.value = Math.floor(Math.random() * 3)
this.setState({
    obj: newObj
})
```





#### ä¸å¯å˜åŸåˆ™

**ä¸å¯å˜åŸåˆ™:  ä¸ä¿®æ”¹æ•°æ®, åˆ›å»ºæ–°çš„**

**å¯¹äºstate å­˜åœ¨å¤æ‚æ•°æ®ç±»å‹, è¦éµå¾ªä¸å¯å˜åŸåˆ™**

> ä¸ç®¡æ˜¯ä½¿ç”¨Component è¿˜æ˜¯ PureComponent éƒ½éµå¾ªä¸å¯å˜åŸåˆ™
>
> çœ‹åˆ°state å¯¹è±¡ä¸­æœ‰ å¤æ‚æ•°æ®ç±»å‹, ç«‹åˆ»æƒ³åˆ°ä¸å¯å˜åŸåˆ™

##### å¤„ç†å¯¹è±¡

**ES5  Object.assign()**

- param1: ç›®æ ‡å¯¹è±¡, åé¢çš„å‚æ•°éƒ½ä¼šåˆå¹¶åˆ°è¿™ä¸ªæ–°å¯¹è±¡é‡Œ
- param2:  æ¥æºå¯¹è±¡, åé¢çš„å¯¹è±¡éƒ½ä¼šåˆå¹¶åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ä¸­, å¯¹äºå‰é¢å¯¹è±¡å­˜åœ¨å±æ€§, åé¢çš„ä¼šè¦†ç›–å‰é¢çš„

```js
Object.assign({}, this.state.obj, { num: 100 }, ....)
```

**ES6 å±•å¼€è¿ç®—ç¬¦**

```js
this.setState({
    obj: {...this.state.obj, num: 100}
})
```



##### å¤„ç†æ•°ç»„

ES5 Array.concat()

concat ä¼šæ‹¼æ¥å‚æ•°ç»„è¿”å›ä¸€ä¸ªæ–°æ•°ç»„, ä¹Ÿæ˜¯ä¸€ä¸ªçº¯å‡½æ•°

```js
let newArr = this.state.arr.concat(['cc'])
```

ES6 å±•å¼€è¿ç®—ç¬¦

```js
this.setState({
    arr: [...this.state.arr, 'cc']
})
```



## è™šæ‹ŸDOMçš„çœŸæ­£ä»·å€¼

- è™šæ‹Ÿ DOM çš„çœŸæ­£ä»·å€¼ä»æ¥éƒ½ä¸æ˜¯æ€§èƒ½ã€‚
- çœŸæ­£çš„ä»·å€¼ï¼šè™šæ‹ŸDOM èƒ½å¤Ÿè®© React æ‘†è„±æµè§ˆå™¨çš„é™åˆ¶ï¼ˆæŸç¼šï¼‰ã€‚ä¹Ÿå°±æ˜¯ï¼Œåªè¦èƒ½å¤Ÿè¿è¡ŒJSä»£ç çš„åœ°æ–¹ï¼Œå°±èƒ½å¤Ÿè¿è¡Œ Reactã€‚
- è·¨å¹³å°
  - JSX => è™šæ‹ŸDOM => react-dom  => DOM å…ƒç´ => æµè§ˆå™¨ 
  - JSX => è™šæ‹ŸDOM => React-Native => ioså’Œå®‰å“çš„å…ƒç´  => ç§»åŠ¨æ··åˆå¼€å‘
  - JSX => è™šæ‹ŸDOM => å·¥å…· => VR





## React-router

#### react-routerä»‹ç»

- è·¯ç”± :  å°±æ˜¯ä¸€å¥—æ˜ å°„è§„åˆ™, æ˜¯urlä¸­ `å“ˆå¸Œå€¼` ä¸ `å±•ç¤ºè§†å›¾` ä¹‹é—´çš„ä¸€ç§å¯¹åº”å…³ç³»
- ä¸ºä»€ä¹ˆè¦å­¦ä¹ è·¯ç”± ? 
  - ç°ä»£çš„å‰ç«¯åº”ç”¨å¤§å¤šéƒ½æ˜¯ SPAï¼ˆå•é¡µåº”ç”¨ç¨‹åºï¼‰ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ª HTML é¡µé¢çš„åº”ç”¨ç¨‹åºã€‚
  - å› ä¸ºå®ƒçš„ç”¨æˆ·ä½“éªŒæ›´å¥½ã€å¯¹æœåŠ¡å™¨çš„å‹åŠ›æ›´å°ï¼Œæ‰€ä»¥æ›´å—æ¬¢è¿ã€‚
  - ä¸ºäº†æœ‰æ•ˆçš„ä½¿ç”¨å•ä¸ªé¡µé¢æ¥ç®¡ç†åŸæ¥å¤šé¡µé¢çš„åŠŸèƒ½ï¼Œå‰ç«¯è·¯ç”± åº”è¿è€Œç”Ÿã€‚
- ä½¿ç”¨Reactè·¯ç”±ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é…ç½® **è·¯å¾„**   å’Œ  **ç»„ä»¶**ï¼ˆé…å¯¹ï¼‰



 https://github.com/ReactTraining/react-router githubä»“åº“åœ°å€

react-router è‹±æ–‡å®˜ç½‘:  https://reacttraining.com/react-router/web/guides/quick-start 

react-routeræä¾›äº†å¥½å‡ ä¸ªåŒ…, æˆ‘ä»¬åœ¨webå¼€å‘ä¸­ä½¿ç”¨`react-router-dom` å°±å¯ä»¥äº†, å®ƒä¹ŸåŒ…æ‹¬äº†`react-router` çš„æ ¸å¿ƒ

`React-router`: React-routerçš„æ ¸å¿ƒåŒ…

`React-router-dom`:  web ä¸Šä½¿ç”¨å®ƒå³å¯

 [`react-router-native`](https://github.com/ReactTraining/react-router/blob/master/packages/react-router-native) : åœ¨ React-native ä¸Šä½¿ç”¨

 [`react-router-config`](https://github.com/ReactTraining/react-router/blob/master/packages/react-router-config) : é™æ€è·¯ç”±çš„é…ç½®



#### react-router-domä½¿ç”¨

> Reactä¸­çš„è·¯ç”±éƒ½æ˜¯ç»„ä»¶

å®‰è£…

```js
yarn add react-router-dom
```



`HashRouter/BrowserRouter` : å®¹å™¨ç»„ä»¶, åªæœ‰è¢«å®¹å™¨ç»„ä»¶åŒ…è£¹, æ‰å¯ä»¥ä½¿ç”¨ç»„ä»¶, ä¸€ä¸ªå¸¦ # å· ä¸€ä¸ªä¸å¸¦ # å·

hashRouteræ˜¯å“ˆå¸Œæ¨¡å¼, BrowserRouter æ˜¯history æ¨¡å¼æ²¡æœ‰ä¸‘é™‹çš„# å·



`Link`:  **å…¥å£ç»„ä»¶** ç›¸å½“äºVueçš„`router-link` é»˜è®¤ä¼šæ¸²æŸ“æˆ a æ ‡ç­¾, å¿…é¡»æœ‰` to="/home"` å±æ€§æŒ‡å®šè·³è½¬çš„url



`Route` : **å‡ºå£ç»„ä»¶(è§„åˆ™ +å‡ºå£)** , ç›¸å½“äºvue ä¸­çš„`router-view`, èƒ½æ¸²æŸ“APPç»„ä»¶ å¹¶ä¸”ä¸ºAPPç»„ä»¶`this.props` æ³¨å…¥ä¸€äº›æ–¹æ³•history /location/match ç­‰



`NavLink`: åŠŸèƒ½å’Œ `Link` ä¸€æ ·, ä¸è¿‡ä¼šç»™å½“å‰ç‚¹å‡»è·¯ç”±æ·»åŠ ä¸€ä¸ª`class="active"` ç±»å



`Redirect` : è·¯ç”±é‡å®šå‘`<Redirect to="/home" from="/">` åªæœ‰è®¿é—®`/` å°±é‡å®šå‘åˆ°`/home` , è¦æ³¨æ„çš„æ˜¯, åœ¨ä»¥å‰éœ€è¦`<Switch />` åŒ…è£¹, å¦åˆ™å°±ä¼šæŠ¥é”™( ç°åœ¨ä¸ä¼šæŠ¥é”™äº†, å·²ç»ä¿®å¤ ), é€»è¾‘ç±»ä¼¼JS ä¸­çš„ switch å¾ªç¯, åªè¦åŒ¹é…åˆ°ä¸€ä¸ª`case` å°±ä¸ä¼šåœ¨èµ°å…¶ä»–çš„`case` , ä¹Ÿå°±æ„å‘³ç€`Switch` å†…éƒ¨çš„è·¯ç”±åªèƒ½æ˜¾ç¤ºä¸€ä¸ª



åœ¨`index.js` å…¥å£æ–‡ä»¶å®‰è£…

- `component` : æŒ‡å®šæ¸²æŸ“çš„ç»„ä»¶
- `path`: è·¯ç”±åŒ¹é…, åˆ†å±€url æ˜¾ç¤ºçš„å¯¹åº”çš„ç»„ä»¶, ä¸åŠ çš„è¯, è¡¨ç¤ºä»»ä½•url éƒ½åŒ¹é…

```js
import React from 'react'
import { render } from 'react-dom'

// è·¯ç”±
import { BrowserRouter as Router, Route } from 'react-router-dom'

import App from './App'
render(
  <Router>
    // åªæœ‰è®¿é—® / æ‰ä¼šæ˜¾ç¤ºApp
    <Route component={App} path="/"/>
  </Router>,
  document.querySelector('#root')
)
```



**ä¸€ä¸ªåŸºæœ¬çš„è·¯ç”±è·³è½¬å®ç°**

```js
import React from 'react'
import { Route, NavLink as Link, Switch, Redirect } from 'react-router-dom'
// import { BrowserRouter as Router, Switch, Route, Link } from 'react-router-dom'
// å¯¼å…¥ç»„ä»¶
import { Home, Article, Users } from './views'
export default class App extends React.Component {
  state = {}
  render() {
    return (
      <div>
        <ul>
          <li><Link to="/home">é¦–é¡µ</Link></li>
          <li><Link to="/article">æ–‡ç« </Link></li>
          <li><Link to="users">ç”¨æˆ·</Link></li>
        </ul>
        <Switch>
          <Route component={Home} path="/home" />
          <Route component={Article} path="/article" />
          <Route component={Users} path="/users" />
          <Redirect to="/home" from="/" />
        </Switch>
      </div>
    )
  }
}
```



#### è·¯ç”±çš„æ‰§è¡Œè¿‡ç¨‹

1. ç‚¹å‡» Link çš„æ—¶å€™, æ”¹å˜å…¥å£, url é‡Œçš„ pathname
2. ä¸€æ—¦æ”¹å˜, è·¯ç”±å°±ä¼šç›‘å¬å¤§ pathnameçš„å˜åŒ–
3. å°±ä¼šæ‰¾åˆ° `Router` ä¸‹çš„ `Route` , éå†åŒ¹é…è§„åˆ™
4. æ‰¾åˆ°å¯¹åº”çš„åŒ¹é…è§„åˆ™, ä¼šç»§ç»­éå† `Route` , åŒ¹é…æ‰€æœ‰ç¬¦åˆæ¡ä»¶`path=""` ä¹Ÿå°±æ„å‘³ç€:ä¸€ä¸ªè·¯å¾„å¯ä»¥åŒ¹é…å¤šä¸ªç»„ä»¶, 
   - å¦‚æœæƒ³è¦æ˜¾ç¤ºä¸€ä¸ª, å¯ä»¥ä½¿ç”¨`Switch`ç»„ä»¶, åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åé¢çš„å°±ä¸ä¼šåŒ¹é…

> åœ¨react ä¸­ ä¸€ä¸ªurlè·¯å¾„, å¯ä»¥åŒ¹é…å¤šä¸ªç»„ä»¶, å¦‚æœæƒ³è¦åŒ¹é…ä¸€ä¸ªä½¿ç”¨ <Switch>ç»„ä»¶





#### ç¼–ç¨‹å¼å¯¼èˆª

æ”¹å˜å…¥å£æ–¹å¼

- å£°æ˜å¼å¯¼èˆª
- ç¼–ç¨‹å¼å¯¼èˆª

åœ¨ vue ä¸­ é€šè¿‡`thsi.$router.push()` ç¼–ç¨‹å¼å¯¼èˆª

åœ¨Reactä¸­ é€šè¿‡`Route` è·¯ç”±åŒ¹é…çš„ç»„ä»¶, åœ¨ç»„ä»¶å†…éƒ¨çš„`this.props` å°±å…·æœ‰`history/location/match` å±æ€§, æ­£å¸¸ç»„ä»¶çš„`this.props ` åˆ™æ˜¯æ²¡æœ‰è¿™ä¸‰ä¸ªå±æ€§çš„



##### **this.props ä¸­ä¸‰ä¸ªé‡è¦å±æ€§**

`history` : ä¸­çš„ `push()/go()/goBack()/goForward()/replace()` æ–¹æ³•å¯ä»¥ç¼–ç¨‹å¼è·³è½¬è·¯ç”±



`location` : è®°å½•ä½ç½®

- pathname: å½“å‰æ˜¾ç¤ºçš„è·¯ç”±urlè·¯å¾„
- state: è®°å½•äº†push(path, state)è·³è½¬ä¼ é€’çš„stateå‚æ•°



`match`: å¯ä»¥è·å–å‚æ•°

- params: åŠ¨æ€è·¯ç”±çš„å‚æ•°

```js
<Route path="/detail/:id" component={detail}>
    
 this.props.history.push('/detail/123')
 console.log(this.props.match.params.id) // 123
```





##### historyé‡Œçš„é‡è¦æ–¹æ³•

`history.push(path. state)`

- param1: Stringç±»å‹,  è¦è·³è½¬çš„url
- param2:  åœ¨è·³è½¬è·¯ç”±çš„æ—¶å€™, å¯ç»™`location.state`ä¼ é€’å‚æ•°

```js
this.props.history.push('/two', { name: 'èªèª' })
console.log(this.props.location.state) // { name: 'èªèª'}
```

`history.replace(path, state)` ç›´æ›¿æ¢æ‰å½“å‰çš„è·¯ç”±, ä¸ä¼šè®°å½•è·³è½¬è®°å½•,  ä½¿ç”¨åœºæ™¯: å¾…æ”¯æŒé¡µé¢ => æ”¯ä»˜æˆåŠŸé¡µé¢ ä½¿ç”¨replace ä¿è¯ä¸å†å›åˆ°å¾…æ”¯ä»˜é¡µé¢

`history.goBack() `: åé€€, ç›´æ¥è°ƒç”¨åˆ™å¾€å‰è·³è½¬ä¸€æ¬¡, æ•ˆæœå’Œ go(-1) ä¸€æ ·

`history.goForward()`: å‰è¿›, ç›´æ¥è°ƒç”¨, ä½œç”¨ç›¸å½“äº go(1)

`history.go(1)` : å‰è¿›æˆ–åé€€







#### exact ç²¾ç¡®åŒ¹é…

Routeé»˜è®¤æ˜¯æ¨¡ç³ŠåŒ¹é…, åªè¦æ˜¯ä»¥`path` çš„url å¼€å¤´å°±å¯ä»¥åŒ¹é…, æ¨¡ç³ŠåŒ¹é…åœ¨åµŒå¥—è·¯ç”±ä¸­ä½¿ç”¨

åœ¨`<Route exact/>` åˆ™è¡¨ç¤ºå®Œå…¨ç²¾ç¡®åŒ¹é…, å¯¹äºåµŒå¥—è·¯ç”±, ç‚¹å‡»å­è·¯ç”±, ä¸åœ¨çˆ¶è·¯ç”±ä¸‹æ˜¾ç¤º, åˆ™å†çˆ¶è·¯ç”±èº«ä¸ŠåŠ `exact` 

```js
<Route component={Home} path="/home" />
    
<Route component={Article} path="/article" exact/>
<Route component={ArticleDetail} path="/article/:id"></Route>

<Route component={Users} path="/users" />
<Redirect to="/home" from="/" />
```



#### åµŒå¥—è·¯ç”±

**ä½¿ç”¨react-router çš„ æ¨¡ç³ŠåŒ¹é…,** å®ç°åµŒå¥—è·¯ç”±

å¤–å±‚æœ‰ä¸€å¥—è·¯ç”±, è·¯ç”±é‡Œé¢åˆæœ‰ä¸€å¥—è·¯ç”±åŒ¹é…è§„åˆ™, åªæœ‰çˆ¶è·¯ç”±åŒ¹é…åˆ°äº†, æ‰ä¼šè°ƒç”¨render, æ¸²æŸ“çˆ¶è·¯ç”±ä¸­çš„å­è·¯ç”±Route

æ‰€ä»¥è¯´reactä¸­çš„åµŒå¥—è·¯ç”±, åœ¨ä»–çš„å­è·¯ç”±ä¸­çš„`path="/parent/"`å‰é¢å¿…é¡»è¦å¸¦ä¸Šçˆ¶è·¯ç”±çš„è·¯å¾„ => `æœ‰çˆ¸çˆ¸æ‰æœ‰å„¿å­`

```js
<Link to="/article/1">æ–‡ç« è¯¦æƒ…1</Link>
<Link to="/article/2">æ–‡ç« è¯¦æƒ…2</Link>
<Route component={ArticleDetail} path="/article/:id"></Route>
```



#### é‡å®šå‘

- **æ–¹å¼1 : render-props**

 ```js
<Route exact path='/'
  render={ () => {
    return <Redirect to='/one' />
	 }
}></Route>
 ```

- **æ–¹å¼2 - children**

```js
<Route exact path='/'>
  <Redirect to='/one' />
</Route>
```

- æ–¹å¼3

```js
<Redirect to="/home" from="/" exact/>
```



#### å“ˆå¸Œæ¨¡å¼å’Œhistoryæ¨¡å¼

HashRouteræ¨¡å¼

 1. è®¿é—®è·¯å¾„ :  http://localhost:8080/#/one 
               			  http://localhost:8080/#/two
 2. æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ (æœåŠ¡å™¨æ˜¯ä¸ä¼š æ¥æ”¶ # åé¢çš„å†…å®¹çš„)
 3. ä¸ç®¡è®¿é—®çš„è·¯å¾„æ˜¯ä»€ä¹ˆæ ·çš„ 
     http://localhost:8080  ==> æœåŠ¡å™¨è¿”å›çš„é»˜è®¤ çš„å°±æ˜¯  index.html
4. åé¢çš„ /one å’Œ /two ç”±è·¯ç”±æ¥ä½¿ç”¨, æ ¹æ®è·¯ç”±åŒ¹é…è§„åˆ™æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶æ˜¾ç¤º
5. å“ˆå¸Œæ¨¡å¼ ä¸ç®¡æ˜¯ å¼€å‘é˜¶æ®µè¿˜æ˜¯å‘å¸ƒé˜¶æ®µ,éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„



historyæ¨¡å¼

1. è®¿é—®è·¯å¾„ :  http://localhost:8080/one 
                          http://localhost:8080/two
2. æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ http://localhost:8080/one  å’Œ http://localhost:8080/two
	 		ä½†æ˜¯ï¼Œ/one å’Œ /two è¿™ä¸ªè·¯å¾„æ˜¯ä¸éœ€è¦æœåŠ¡å™¨ç«¯åšä»»ä½•å¤„ç†çš„ã€‚
3.  http://localhost:8080/getNews
    http://localhost:8080/detail 
    å®ƒä»¬éƒ½æ˜¯ æ¥å£åœ°å€  , åé¢é‡åˆ° ç±»ä¼¼ /one å’Œ /two éƒ½ä¼šä»¥ä¸ºæ˜¯æ¥å£ æ˜¯è¦è¿”å›æ•°æ®çš„å‘¢?
3. æ‰€ä»¥ï¼Œåº”è¯¥åœ¨æœåŠ¡å™¨ç«¯æ·»åŠ ä¸€ä¸ªè·¯ç”±é…ç½®ï¼Œç›´æ¥è¿”å› SPA çš„ index.html é¡µé¢å°±è¡Œå•¦ã€‚
5. ç±»ä¼¼å¤„ç†

```js
   app.get('/getNews', (req,res) => {
   // æ ¹æ® res è¿”å› å¯¹åº”çš„æ•°æ®
    res.json { .....  }
  })
  app.get('/detail', (req,res) => {
   // æ ¹æ® res è¿”å› å¯¹åº”çš„æ•°æ®
    res.json { .....  }
  })

  // æœ€å é¢å¤–å†å¤šåŠ ä¸€ä¸ª, ä¸“é—¨ç”¨æ¥è¿”å› index.html
  app.use('*', (req,res) => {
    res.sendFile('index.html')
  })

```

æ€»ç»“:

- å¼€å‘é˜¶æ®µ : æœåŠ¡å™¨æ˜¯æœ¬åœ°æœåŠ¡å™¨, webpackè„šæ‰‹æ¶å·²ç»å¤„ç†å¥½äº†, 
- å‘å¸ƒé˜¶æ®µ : æœåŠ¡å™¨æ˜¯å…¬å¸çš„æœåŠ¡å™¨, å¯èƒ½å°±ä¼šæŠ¥é”™
- æˆ‘ä»¬è¦åšçš„å°±æ˜¯`å‘Šè¯‰åå°`,æˆ‘ä»¬ä½¿ç”¨çš„ æ˜¯ historyæ¨¡å¼,è®©ä»–ä¸“é—¨å¤„ç†ä¸€ä¸‹,å°±å¯ä»¥äº†
- å¦‚æœåå°ä¸ç»™å¤„ç†,æˆ–è€…å¤„ç†ä¸å¥½, æˆ‘ä»¬å°±ä½¿ç”¨ `å“ˆå¸Œæ¨¡å¼`





#### 404 åŒ¹é…

- `/` çš„é‡å®šå‘éœ€è¦`exact` ç²¾ç¡®åŒ¹é…, é™¤äº†`/` å’Œ æä¾›çš„`path` éƒ½ä¼šé‡å®šå‘åˆ°`/404`

```js
<Redirect to="/home" from="/" exact/> 
<Redirect to="/404"></Redirect>
<Route component={NotFound} path="/404"/>
```





# React ç¬¬ä¸ƒå¤©

## Redux çŠ¶æ€ç®¡ç†

#### å¼•å…¥ ->çº¯å‡½æ•°

> çº¯å‡½æ•°æ˜¯è¿™æ ·ä¸€ç§å‡½æ•°ï¼Œå³ç›¸åŒçš„è¾“å…¥ï¼Œæ°¸è¿œä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯è§‚å¯Ÿçš„å‰¯ä½œç”¨ 

 æ¯”å¦‚ `slice` å’Œ `splice`ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨å¹¶æ— äºŒè‡´â€”â€”ä½†æ˜¯æ³¨æ„ï¼Œå®ƒä»¬å„è‡ªçš„æ–¹å¼å´å¤§ä¸åŒï¼Œä½†ä¸ç®¡æ€ä¹ˆè¯´ä½œç”¨è¿˜æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬è¯´ `slice` ç¬¦åˆ*çº¯*å‡½æ•°çš„å®šä¹‰æ˜¯å› ä¸ºå¯¹ç›¸åŒçš„è¾“å…¥å®ƒä¿è¯èƒ½è¿”å›ç›¸åŒçš„è¾“å‡ºã€‚è€Œ `splice` å´ä¼šåš¼çƒ‚è°ƒç”¨å®ƒçš„é‚£ä¸ªæ•°ç»„ï¼Œç„¶åå†åå‡ºæ¥ï¼›è¿™å°±ä¼šäº§ç”Ÿå¯è§‚å¯Ÿåˆ°çš„å‰¯ä½œç”¨ï¼Œå³è¿™ä¸ªæ•°ç»„æ°¸ä¹…åœ°æ”¹å˜äº† 

```js
var xs = [1,2,3,4,5];

// çº¯çš„
xs.slice(0,3);
//=> [1,2,3]

xs.slice(0,3);
//=> [1,2,3]

xs.slice(0,3);
//=> [1,2,3]


// ä¸çº¯çš„
xs.splice(0,3);
//=> [1,2,3]

xs.splice(0,3);
//=> [4,5]

xs.splice(0,3);
//=> []
```





#### redux

reduxæœ¬èº«å’Œ reactæ²¡æœ‰å…³ç³», éœ€è¦æ‰‹åŠ¨è¿æ¥store , æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨react-reduxè‡ªåŠ¨è¿æ¥store

Redux = Flux +reducer(å‡½æ•°å¼ç¼–ç¨‹)

## **Redux ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ**

#### action - æå‡ºæƒ³æ³•

- åŠ¨ä½œæƒ³æ³•, æ˜¯ç”¨æ¥æè¿°è¦åšçš„äº‹æƒ…
  - æ¯”å¦‚ : è®¡ç®—å™¨æ¡ˆä¾‹ä¸­çš„ +1, ç‚¹å‡»æŒ‰é’®å , è®¡ç®—å™¨çš„æ•°å€¼å°±ä¼šå¢åŠ 1, åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­, +1 å°±æ˜¯ä¸€ä¸ªaction
  - æ¯”å¦‚ : ç™»å½•åŠŸèƒ½ä¸­, ç™»å½•ä¹Ÿæ˜¯ ä¸€ä¸ª action
  - æ¯”å¦‚: æ·»åŠ ä»»åŠ¡,åˆ é™¤ ä»»åŠ¡,åˆ‡æ¢ä»»åŠ¡ éƒ½æ˜¯ action
- æ³¨æ„ : action ä»…ä»…æ˜¯ç”¨æ¥æè¿°è¦åšçš„ä»€ä¹ˆäº‹æƒ…,  ä½†æ˜¯ , actionå¹¶ä¸ä¼šå»å®Œæˆè¿™ä¸ªåŠŸèƒ½
  - ä¸¾ä¸ªä¾‹å­ : å°±æƒ³`ç –`å®¶ ä¸€æ ·,  åªæ˜¯æå‡º æƒ³æ³•, ä½†æ˜¯ä¸å¹²æ´»

#### reducer - å®ç°æƒ³æ³•

- ç”¨æ¥å®ç°å…·ä½“çš„ action (åŠ¨ä½œ)
- å¯ä»¥æŠŠ reducer æƒ³è±¡æˆ æ¬ç –çš„ (å¹²æ´»çš„äºº), æ˜¯ç”¨æ¥å®Œæˆ `ç –å®¶`  æå‡ºæ¥çš„æƒ³æ³•çš„

#### store - ç®¡ç†è€…

- ä»“åº“ :  ç”¨æ¥ å°† action å’Œ reducer å…³è”åœ¨ä¸€èµ·
- å¯ä»¥æŠŠ store æƒ³è±¡æˆ`ç®¡ç†è€…(è€æ¿)`, è´Ÿè´£ å°† `ç –å®¶` æå‡ºæ¥çš„æƒ³æ³• å‘Šè¯‰ `æ¬ç –çš„(å¹²æ´»çš„äºº)`,  ç”±æ¬ç –çš„äººæ¥å®Œæˆ`ç –å®¶` æå‡ºæ¥çš„æƒ³æ³•



## ä»ä»£ç è§’åº¦æ¥çœ‹ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ

#### action 

- action å®é™…ä¸Šå°±æ˜¯ ä¸€ä¸ªæ™®é€šçš„jså¯¹è±¡
- ä½œç”¨ :  ç”¨æ¥æè¿° è¦æ‰§è¡Œçš„åŠ¨ä½œ (ä»»åŠ¡)
- çº¦å®š1 : å¿…é¡»æä¾› type å±æ€§, ç”¨æ¥è¡¨ç¤º ä»»åŠ¡ç±»å‹
- çº¦å®š2 : type å±æ€§çš„å€¼(ç±»å‹), æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² åº”è¯¥ä½¿ç”¨ `å¤§å†™å­—æ¯` è¡¨ç¤º
  - å¦‚æœæœ‰å¤šä¸ªå•è¯ , å¤šä¸ªå•è¯ä¹‹é—´é€šè¿‡ _ (ä¸‹åˆ’çº¿) æ¥é“¾æ¥
- çº¦å®š3 : å¯ä»¥åœ¨ action ä¸­æºå¸¦ä½“å¤–çš„æ•°æ®, ä½œä¸ºå®Œæˆè¯¥åŠŸèƒ½éœ€è¦ç”¨åˆ°çš„æ•°æ®

```js
// è®¡ç®—å™¨æ¡ˆä¾‹ : +1  increment
{ type : 'INCREAMENT' }

// æ·»åŠ ä»»åŠ¡
{ type : 	'ADD_TODO', text:'å­¦ä¹ redux' }

// åˆ é™¤ä»»åŠ¡
{ type : 'DELETE_TODO', id:2 }

```

#### reducer

- reducer å®é™…å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„jså‡½æ•°
- ä½œç”¨ : å®Œæˆ action çš„åŠŸèƒ½
- å› ä¸ºè¦å®ç° action ä¸­ æå‡ºçš„æƒ³æ³•, æ‰€ä»¥éœ€è¦å°† **action ä¼ é€’ç»™ reducer**
- å› ä¸º redux æ˜¯ç”¨æ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†çš„, æ‰€ä»¥ reduceråœ¨å®ŒæˆæŸä¸ª action çš„æ—¶å€™ , å°±éœ€è¦æ“ä½œçŠ¶æ€, ä¹Ÿéœ€è¦å°†**state ä½œä¸ºå‚æ•°ä¼ é€’ç»™ reducer** 
- å› ä¸º reducer æ˜¯ç”¨æ¥ å®ç°æŸä¸ªå…·ä½“çš„ action , æ‰€ä»¥ è¿™ä¸ªè¿”å›åœ¨å®Œæˆäº†æŸä¸ª action ä¹‹å, éœ€è¦è®²æœ€æ–°çš„çŠ¶æ€è¿”å›, å› æ­¤éœ€è¦æœ‰è¿”å›å€¼, è¿”å›å€¼å°±æ˜¯æœ€æ–°çš„çŠ¶æ€
- reducer çš„å‡½æ•° ç­¾å : `(oldState, action) => newState`
- ä¹Ÿå°±æ˜¯è¯´ : çŠ¶æ€çš„å˜åŒ–æ—¶åœ¨ reducer ä¸­å®Œæˆçš„
- æ³¨æ„ : reducerå‡½æ•°, ä¸€å®šè¦è¿”å› çŠ¶æ€ , è¿™æ ·æ‰èƒ½ä¿è¯ redux ä¸€ç›´éƒ½æœ‰çŠ¶æ€
  - å› æ­¤, éœ€è¦ç»™ switch-case æ·»åŠ  default , ç”¨æ¥è¿”å›é»˜è®¤çš„state
- æ³¨æ„ : reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•° 
  - 1 ä¸è¦ç›´æ¥ä¿®æ”¹å‚æ•°, ä¹Ÿå°±æ˜¯ä¸è¦ä¿®æ”¹ å‚æ•°  state,  è€Œæ˜¯è¦åˆ›å»ºæ–°çš„state
  - 2 ä¸è¦å†å‡½æ•°é‡Œä½¿ç”¨ ä¸çº¯çš„æ“ä½œ
    - æ¯”å¦‚ : Math.random() / new Date() / å‘é€ajax è¯·æ±‚, / æ“ä½œå…¨å±€å˜é‡

```js
// todos æ¡ˆä¾‹ï¼š
// å› ä¸º todos æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥ï¼Œtodosçš„æ•°æ®åº”è¯¥æ˜¯ä¸€ä¸ªï¼šæ•°ç»„ï¼ˆ [] ï¼‰
// æ‰€ä»¥ï¼Œtodos çš„é»˜è®¤å€¼åº”è¯¥æ˜¯ä¸€ä¸ª æ•°ç»„
// æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„ç»“æ„ï¼š
// text è¡¨ç¤ºä»»åŠ¡åç§°
// done è¡¨ç¤ºä»»åŠ¡å®ŒæˆçŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼
// { id: 2, text: ä»»åŠ¡åç§°, done: false }

const reducer = (state, action) => {
  switch (action.type) {
      
    case 'ADD_TODO':
      // æ·»åŠ ä»»åŠ¡çš„é€»è¾‘ä»£ç 
      return [...state, { id: id, text: action.text, done: false }]
      
    case 'DELETE_TODO':
      // åˆ é™¤ä»»åŠ¡çš„é€»è¾‘ä»£ç 
      return state.filter(item => item.id !== action.id)

    default:
      return state
  }
}
```

- çº¯å‡½æ•°çš„ç‰¹ç‚¹ : ç›¸åŒçš„è¾“å…¥ å¿…å®šå¾—åˆ°ç›¸åŒçš„è¾“å‡º
  - å¼€å§‹çš„ä»‹ç»å¯é¢„æµ‹

```js
// çº¯å‡½æ•°ï¼š
function fn(a) {
  return 1 + a
}

fn(2) // 3
fn(2) // 3
fn(2) // 3
fn(2) // 3

// ä¸çº¯çš„æ“ä½œï¼š
function foo(a) {
  return Math.random() + a
}

fn(2) // 2.1231923912983
fn(2) // 2.8909810320912
fn(2) // 2.3213982098401
```



#### store

- store å°±æ˜¯ä¸€ä¸ªå¯¹è±¡, ç”¨æ¥å°† action å’Œ reducer å…³è”åœ¨ä¸€èµ·
- æ³¨æ„ : ä¸€ä¸ª reducer åº”ç”¨ä¸­åªèƒ½æœ‰ä¸€ä¸ª store
- store æ˜¯é€šè¿‡ redux ä¸­çš„ createStoreæ¥åˆ›å»ºçš„

```js
import { createStore } from 'redux'

// å‚æ•°æ˜¯ reducer
const store = createStore( reducer )

// æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œï¼šåˆ†å‘åŠ¨ä½œ
store.dispatch( { type: 'ADD_TODO', text: 'å­¦ä¹ redux' } )
```



## createStore()

createStoreèƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªstore 

- å‚æ•°1: reducer
- å‚æ•°2: åˆå§‹å€¼
- å‚æ•°3: ä¸­é—´ä»¶  

```js
const store = createStore(reducer, todos_state)
```



## react-redux

æœ¬èº«`redux `å’Œ `react` ä¹‹é—´æ²¡æœ‰ä»€ä¹ˆç»ƒä¹ , åªèƒ½å¼ºé¡¹å¯¼å…¥, ä½¿ç”¨`store` ,ä¸”æ— æ³•å®ç°å•å‘æ•°æ®æµçš„æ€æƒ³, æ‰€ä»¥è¿™æ—¶å€™react-redux å°±å‡ºç°äº†, å®ƒèƒ½å¤ŸæŠŠ

#### å®‰è£…ä½¿ç”¨

```js
yarn add react-redux
```

#### ä½¿ç”¨æ­¥éª¤(è´­ç‰©è½¦æ¡ˆä¾‹)

##### åˆ›å»ºstore

1. æ ¹ç›®å½•ä¸‹åˆ›å»º`store`  -> **éœ€è¦åˆå¹¶åçš„reducer**
   - å…¨å±€å”¯ä¸€æ•°æ®æº`state`, ä½¿ç”¨`createStore` åˆ›å»ºstore
   - åœ¨è¿™é‡Œå¼•å…¥åˆå¹¶åçš„`reducer` 

```js
// createStore æ˜¯react-redux ç”¨äºåˆ›å»ºstoreçš„æ–¹æ³•, è¿™ä¸ª
import {createStore} from 'redux'

// å¼•å…¥åˆå¹¶åçš„reducer
import rootReducer from './reducers'

// createStore çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªreducer, å¦‚æœæ˜¯å¤šä¸ª, è¯·åœ¨reducersç›®å½•ä¸‹å…ˆä½¿ç”¨combineReducersåˆå¹¶ä¹‹ååœ¨å¯¼å‡º 
export default createStore(rootReducer)
```



##### åˆ›å»ºå¹¶åˆå¹¶reducer

2. åœ¨`reducers`ç›®å½•ä¸‹åˆ›å»º`index.js`å¹¶å¯¼å‡ºåˆå¹¶åçš„reducer

- å®é™…ä¸­, å¯èƒ½å­˜åœ¨å¤šä¸ª`reducer` æˆ‘ä»¬éƒ½å¯ä»¥åœ¨`index.js` ä¸­åˆå¹¶ä¹‹åç»Ÿä¸€å¯¼å‡º
- åœ¨`index.js` ä¸­å¯¼å…¥`reducer`é€šèƒ½è¿‡`redux` æä¾›çš„`combineReducers` åˆå¹¶æ‰€æœ‰çš„`reducer`

```js
// åœ¨å®é™…çš„é¡¹ç›®ä¸­, ç”±äºåªæœ‰å•ä¸€çš„store, ä½†æ˜¯çŠ¶æ€ç”±å¾ˆå¤šåˆ†ç±», æ‰€ä»¥éœ€è¦åˆ’åˆ†reducer, ä½†æ˜¯createStoreçš„å‚æ•°åªæ¥æ”¶ä¸€ä¸ªreducer, æ‰€ä»¥, reduxèªæ˜çš„æä¾›äº†ä¸€ä¸ªç”¨äºåˆå¹¶å¤šä¸ªrenderçš„æ–¹æ³•. æ³¨æ„:ä¸è¦æ‰‹åŠ¨åˆå¹¶
import { combineReducers } from 'redux'

// å¼•å…¥ cart reducer , å¦‚æœæœ‰å¤šä¸ª, ç»§ç»­å¼•å…¥
import cart from './cart'

// å¯¼å‡ºåˆå¹¶åçš„reducer
export default combineReducers({
  // æŠŠå¤šä¸ªreducerä½œä¸ºcombineReducers çš„å¯¹è±¡å‚æ•°ä¼ å…¥å³å¯, åœ¨å¤–éƒ¨å°±å¯ä»¥é€šè¿‡store.getState().cart æ¥è·å–åˆ°cart reducer é‡Œçš„stateæ•°æ® 
  cart
})

```



3. åœ¨`reducers`ç›®å½•ä¸‹åˆ›å»ºreducer `cart.js` -> **åœ¨å…·ä½“çš„`reducer` ä¸­éœ€è¦actionå’Œ åˆå§‹state**

- `state` è¦ç»™ä¸€ä¸ªåˆå§‹çŠ¶æ€
- åˆ›å»ºçš„`reducer` å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°
- åœ¨æ ¹æ®ä¸åŒçš„`action` åšä¸åŒçš„å¤„ç†è¿”å›ä¸åŒçš„`state`

```js
// ä¸ºäº†é¿å…actionTypeé‡å¤, æ‰€ä»¥ä¸€èˆ¬ä¼šæŠŠactionTypeæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ç»Ÿä¸€ç®¡ç†, ä¹Ÿå¯ä»¥é¿å…å†™é”™actionType
import actionType from '../actions/actionType'
// å¯¹äºè´­ç‰©è½¦æ¥è¯´è¿™æ˜¯ä¸€ä¸ªåˆå§‹åŒ–çŠ¶æ€
const initState = [
  {
    id: 1,
    title: 'Apple',
    price: 888,
    amount: 10
  },
  {
    id: 2,
    title: 'oriange',
    price: 999,
    amount: 10
  }
]

// åˆ›å»ºè´­ç‰©è½¦çš„ reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•°, reducerçš„å›ºå®šå†™æ³•æ˜¯: 
// ä¸¤ä¸ªå‚æ•°, ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯stateå¹¶æœ‰åˆå§‹å€¼, ç¬¬äºŒä¸ªæ˜¯action
export default (state = initState, action) => {

  // æ ¹æ®ä¸åŒçš„action, åšä¸åŒçš„å¤„ç†, æ¯ä¸€æ¬¡è¿”å›ä¸€ä¸ªæ–°çš„state, è¿”å›çš„ç±»å‹è¦ä¸€æ ·
  switch (action.type) {
    case actionType.CART_AMOUNT_INCREMENT:
      return state.map((item) => {
        console.log('åŠ ')
        if (item.id === action.payload.id) {
          item.amount += 1
        }
        return item
      })
    case actionType.CART_AMOUNT_DECREMENT:
    return state.map((item) => {
      console.log('å‡')
      if (item.id === action.payload.id) {
        item.amount -= 1
      }
      return item
    })

    // ä¸€å®šè¦æœ‰default, å½“actionTypeä¸å¯¹æ—¶, å°±ä¸åšå¤„ç†, è¿”å›ä¸Šä¸€æ¬¡çš„state
    default:
      return state
  }
}

```



##### å®šä¹‰actionCreator

4. åœ¨`src` ç›®å½•ä¸‹åˆ›å»º`action`ç›®å½•, åˆ›å»ºç»Ÿä¸€çš„`actionType.js`

- ä¸ºäº†é¿å…actionTypeé‡å¤, æ‰€ä»¥ä¸€èˆ¬ä¼šæŠŠactionTypeæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ç»Ÿä¸€ç®¡ç†, ä¹Ÿå¯ä»¥é¿å…å†™é”™actionType

```js
// ä¸ºäº†é¿å…actionTypeé‡å¤, æ‰€ä»¥ä¸€èˆ¬ä¼šæŠŠactionTypeæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ç»Ÿä¸€ç®¡ç†, ä¹Ÿå¯ä»¥é¿å…å†™é”™actionType
export default {
  CART_AMOUNT_INCREMENT: 'CART_AMOUNT_INCREMENT',
  CART_AMOUNT_DECREMENT: 'CART_AMOUNT_DECREMENT'
}
```



5. åœ¨`action` ç›®å½•ä¸‹åˆ›å»º`cart.js` å¯¹åº”çš„actionCreator

- æœ‰ä¸¤ç§å†™æ³•, å®é™…å·¥ä½œç¬¬äºŒç§å¸¸ç”¨
- è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨: ç»™ç»„ä»¶çš„`action`

```js
// æä¾›actionType
import actionType from './actionType'


// ç¬¬ä¸€ç§å†™æ³•: è¿™æ˜¯æ ‡å‡†å†™æ³•, ä½†æ˜¯ä¸æ–¹ä¾¿ä¼ é€’åŠ¨æ€å‚æ•°
// export const increment = {
//   type: actionType.CART_AMOUNT_INCREMENT
//   payload: {
//     id
//   }
// }


// åœ¨å®é™…å·¥ä½œä¸­, å¸¸ç”¨çš„ä¸€ç§æ–¹å¼actionCreator, å®ƒæ˜¯ä¸€ä¸ªæ–¹æ³•, è¿”å›ä¸€ä¸ªå¯¹è±¡, è¿™ä¸ªå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„action, èƒ½å¤Ÿä¼ é€’åŠ¨æ€å‚æ•° 
export const increment = (id) => {
  // console.log(id)
  return {
    type: actionType.CART_AMOUNT_INCREMENT,
    payload: {
      id
    }
  }
}

// å¯¼å‡ºå‡çš„æ–¹æ³•
export const decrement = (id) => {
  // console.log(id)
  return {
    type: actionType.CART_AMOUNT_DECREMENT,
    payload: {
      id
    }
  }
}

```



=================== ç»å†ä¸Šè¿°æ­¥éª¤, redux åˆ™åˆ›å»ºå®Œæ¯•, å¯ä»¥ä½¿ç”¨=========================

##### ä½¿ç”¨Provider

6. ä½¿ç”¨`react-redux` æä¾›çš„`Provider` ç»„ä»¶, ä¼ é€’å”¯ä¸€æ•°æ®æº`store`
   - éœ€è¦å…¥å£æ–‡ä»¶`index.js`å¼•å…¥åˆ›å»ºçš„`store`
   - ä½¿ç”¨`Provider` ç»„ä»¶åŒ…è£¹, ä¼ é€’`store`
   - **åªè¦åœ¨æœ€å¤–å±‚åŒ…è£¹Provider, æ‰€æœ‰åä»£ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨Redux.connectè¿æ¥åˆ°store **

```js
import React from 'react'
import { render } from 'react-dom'

// Provider æ˜¯ react-reduxæä¾›çš„ç»„ä»¶, ç±»ä¼¼äºcontext ä¸Šä¸‹æ–‡ä¼ é€’æ•°æ®
import { Provider } from 'react-redux'

import App from './App'
import store from './store'

// æŠŠstoreä¸­çš„æ•°æ®ä¼ é€’ç»™APP
render(
  // ä¸€èˆ¬æŠŠstore æ”¾åœ¨åº”ç”¨ç¨‹åºçš„æœ€é¡¶å±‚, è¿™ä¸ªç»„ä»¶å¿…é¡»æœ‰storeå±æ€§, è¿™ä¸ªstoreå±æ€§å°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„store
  // åªè¦åœ¨æœ€å¤–å±‚åŒ…è£¹Provider, nameæ‰€æœ‰åä»£ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨Redux.connectè¿æ¥åˆ°store 
  <Provider store={store}>
    <App />
  </Provider>,
  document.querySelector('#root')
)

```



##### åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ”¹å˜store

7. åœ¨ç»„ä»¶`cartList`ä¸­ä½¿ç”¨redux
   - ä½¿ç”¨react-reduxæä¾›çš„`connect` è¿æ¥ store
   - å¯¼å‡º`action` 
   - ç»™ç»„ä»¶`props`æ³¨å…¥storeä¸­çš„state å’Œ dispatch æ–¹æ³•

```js
import React from 'react'

// conectæ–¹æ³•æ‰§è¡Œä¹‹åæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶
import { connect } from 'react-redux'

// å¯¼å…¥ actionCreators
import { increment, decrement } from '../../actions/cart'

class CarList extends React.Component {
  render() {
    // å°±å¤šäº† dispatch æ–¹æ³•
    console.log('props',this.props)
    // console.log(connect())
    return (
      <div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>å•†å“åç§°</th>
              <th>ä»·æ ¼</th>
              <th>æ•°é‡</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody>
            {this.props.carList.map((item) => (
              <tr key={item.id}>
                <td>{item.id}</td>
                <td>{item.title}</td>
                <td>{item.price}</td>
                <td>
                  <button
                    // onClick={() => {
                    //   // this.props.dispatch(decrement(item.id))
                    //    // mapState ä¼ ç¬¬äºŒä¸ªå‚æ•°
                    //   this.props.decrement(item.id)
                    // }}

                    // æ”¹å†™ 
                    // onClick={() => this.props.decrement(item.id)}
                    onClick={this.props.decrement.bind(this, item.id)}
                  >
                    -
                  </button>
                  <span>{item.amount}</span>
                  <button
                    onClick={() => {
                      // mapState ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°
                      // this.props.dispatch(increment(item.id))
                      // mapState ä¼ ç¬¬äºŒä¸ªå‚æ•°
                      this.props.increment(item.id)
                    }}
                  >
                    +
                  </button>
                </td>
                <td></td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    )
  }
}

// è¿™é‡Œçš„stateå®é™…ä¸Šå°±æ˜¯store.getState()çš„å€¼
const mapStateToProps = (state) => {
  console.log('mapStateToProps', state)
  // è¿™é‡Œreturnäº†ä»€ä¹ˆ, åœ¨ç»„ä»¶é‡Œå°±å¯ä»¥é€šè¿‡this.propsè·å–åˆ°
  return {
    carList: state.cart // åˆ™propså°±æœ‰ carList
  }
}
// ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°, è‡ªåŠ¨å…·æœ‰dispatch æ–¹æ³•
// export default connect(mapStateToProps)(CarList)
/* 
  connect æœ‰å››ä¸ªå‚æ•°, å¸¸ç”¨å°±æ˜¯å‰é¢ä¸¤ä¸ªå‚æ•°
  param1: mapStateToProps: ä½œç”¨å°±æ˜¯ä»storeé‡ŒæŠŠstateæ³¨å…¥åˆ°å½“å‰çš„ç»„ä»¶çš„this.propsä¸Š 
  param2: mapDispatchToProps: é»˜è®¤ä¸ä¼ æ˜¯æ³¨å…¥dispatch, å¯ä»¥æŠŠactionç”Ÿæˆçš„æ–¹æ³•æ³¨å…¥åˆ°å½“å‰ç»„ä»¶çš„propsä¸Š,
  ä¸€èˆ¬ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªå¯¹è±¡, è¿™ä¸ªå¯¹è±¡é‡Œå°±æ˜¯actionCreateors, åªè¦ä¼ å…¥äº†actionCreators, åœ¨ç»„ä»¶å†…å°±å¯ä»¥é€šè¿‡this.props.actionCreator() è°ƒç”¨, è°ƒç”¨ä¹‹å, é‚£ä¸ªactionCreatorå°±ä¼šè‡ªåŠ¨å¸®ä½ æŠŠå®ƒå†…éƒ¨çš„action dispatchå‡ºå»
*/
// ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°
export default connect(mapStateToProps, { increment, decrement })(CarList)

```





#### å¼‚æ­¥action

åŒæ­¥Storeæµç¨‹: actionCreator -> è‡ªåŠ¨dispatch(action) -> reducer -> store -> view

å¼‚æ­¥:  actionCreator -> middleWareå¤„ç†ç”Ÿæˆæ–°çš„action -> æ‰‹åŠ¨dispatch(action) -> reducer -> store -> view

å€ŸåŠ© middleWare ä¸­é—´ä»¶å¤„ç† å¼‚æ­¥ action => `react-thunk` ä¸­é—´ä»¶å®ç° å¼‚æ­¥action

#### react-thunk 

```js
yarn add redux-thunk
```

åœ¨`store.js`ä¸­redux ä¸­å¼•å…¥ `applyMiddleware`

```js
import { createStore, applyMiddleware } from 'redux'

// å¯¼å…¥åˆå¹¶åçš„ reducer
import rootReducer from './reducers'

// å¯¼å…¥react-thunk
import Thunk from 'redux-thunk'

export default createStore(rootReducer, applyMiddleware(Thunk))
```



å®šä¹‰å¼‚æ­¥actionCreator

```js
export const decrementAsync = id => dispatch => {
  setTimeout(() => {
    dispatch(decrement(id))
  }, 2000)
}
```





# React åäºŒå¤©

## ç¯å¢ƒå˜é‡å’Œaxiosä¼˜åŒ–

### é¡¹ç›®å¼€å‘çš„ä¸¤ä¸ªç¯å¢ƒ

- å¼€å‘ç¯å¢ƒ ( development ) : é¡¹ç›®å¼€å‘æœŸé—´çš„ç¯å¢ƒ
  - ç»™å¼€å‘äººå‘˜ä½¿ç”¨
  - å¼€å‘ç¯å¢ƒ ä¸€èˆ¬å°±æ˜¯ ç”±  è„šæ‰‹æ¶ æ­å»ºèµ·æ¥çš„
- å‘å¸ƒç¯å¢ƒ ( production ) : çº¿ä¸Šç¯å¢ƒ, ä¹Ÿå°±æ˜¯é¡¹ç›®å®Œæˆå, æ‰“åŒ…ä¸Šçº¿çš„ç¯å¢ƒ
  - ç»™ç”¨æˆ·ä½¿ç”¨
  - `yarn build`æ‰“åŒ…ä¸Šçº¿çš„ç¯å¢ƒ
- é¢„å‘å¸ƒç¯å¢ƒ : æµ‹è¯•ç¯å¢ƒ , ç°åº¦ç¯å¢ƒ(é¢„ä¸Šçº¿ç¯å¢ƒ) => æµ‹è¯•é˜¶æ®µ



## ç¯å¢ƒå˜é‡

åœ¨å®é™…å·¥ä½œä¸­, å¯èƒ½ä¼šæœ‰ä¸åŒçš„ç¯å¢ƒä¸‹å­˜åœ¨ä¸åŒçš„æ¥å£.....

- åœ¨ä¸åŒçš„ç¯å¢ƒä¸­, æœ‰ä¸åŒçš„å†…å®¹ , æ¯”å¦‚ : æ¥å£åœ°å€ã€æ•°æ®åº“ç­‰
  - æ³¨æ„ : æ¥å£åœ°å€ç­‰éœ€è¦æ ¹æ®ç¯å¢ƒæ¥ä½œåŒºåˆ†çš„å†…å®¹,,,,ä¸è¦å†™æ­»åœ¨é¡¹ç›®é‡Œ,  è€Œåº”è¯¥å°†å…¶ä½œä¸ºé…ç½®, 
  - è„šæ‰‹æ¶ä¸­ä¸€èˆ¬éƒ½æ˜¯ä¼šæä¾›ç€è¿™æ ·çš„ ç¯å¢ƒå˜é‡ çš„é…ç½®,   ç”¨æ¥åˆ†åŒºä¸åŒçš„ç¯å¢ƒ,  
  - åœ¨ React è„šæ‰‹æ¶ä¸­, ä¸åŒçš„ç¯å¢ƒæœ‰ä¸åŒçš„é…ç½®æ–‡ä»¶
- å¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶åç§° : ` .env.development `(å¼€å‘ç¯å¢ƒè¯»å–è¯¥é…ç½®)
- ç”Ÿæˆç¯å¢ƒçš„é…ç½®æ–‡ä»¶åç§° : `.env.production` (é¡¹ç›®æ‰“åŒ…ä¸Šçº¿è¯»å–è¯¥é…ç½®é¡¹)
- åœ¨ä¸åŒç¯å¢ƒçš„é…ç½®æ–‡ä»¶ä¸­, åˆ†åˆ«é…ç½® ç¯å¢ƒå˜é‡ , æ¯”å¦‚ æ¥å£: `REACT_APP_URL`
  - å¼€å‘ç¯å¢ƒä¸­é…ç½® : REACT_APP_URL = http://localhost:8080
  - å‘å¸ƒç¯å¢ƒä¸­é…ç½® : REACT_APP_URL = http://api.xx.com
- æ³¨æ„ï¼šç¯å¢ƒå˜é‡çš„åç§°ç›¸åŒï¼Œå€¼æ˜¯ä¸åŒçš„ï¼ï¼ï¼ï¼Œå°†æ¥ä»£ç ä¸­å°±å¯ä»¥è¯»å–åˆ°ç›¸åŒçš„é”®ï¼Œæ¥æ‹¿åˆ°ä¸åŒçš„æ¥å£åœ°å€äº†



## é…ç½®ç¯å¢ƒå˜é‡

- â‘  åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶  **.env.development**
- â‘¡ åœ¨è¯¥æ–‡ä»¶ä¸­æ·»åŠ ç¯å¢ƒå˜é‡  **REACT_APP_URL**   (æ³¨æ„ : ç¯å¢ƒå˜é‡å¿…é¡»çº¦å®šä»¥ REACT_APP_å¼€å¤´)
- â‘¢ è®¾ç½®  REACT_APP_URL çš„å€¼ ä¸º  : http://localhost:8080

```js
# ä¸ºå¼€å‘ç¯å¢ƒæä¾›ç¯å¢ƒå˜é‡
REACT_APP_URL=http://localhost:8080    (ä¸æ˜¯å­—ç¬¦ä¸²)
```

- â‘£ é‡æ–°å¯åŠ¨è„šæ‰‹æ¶ 
  - `yarn start`
  - é‡å¯å, æ‰ä¼šé‡æ–°è¯»å–ç›®å½•, è¯»å–`.env.development/production` æ–‡ä»¶é€šè¿‡nodeä¸­çš„`process`æ¨¡å—è¯»å–
- â‘¤ åœ¨ **utils/url.js** æ–‡ä»¶ä¸­,  åˆ›å»º BASE_URL å˜é‡,  è®¾ç½®å…¶å€¼ä¸º `process.env.REACT_APP_URL`

```js
const BASE_URL = process.env.REACT_APP_URL
// process æ˜¯ Node æä¾›çš„ç”¨æ¥è·å–å½“å‰è¿›ç¨‹çš„å¯¹è±¡
// æ‰“å° process
```

- â‘¥ å¯¼å‡º BASE_URL

```js
export { BASE_URL }
```

- â‘¦ ä½¿ç”¨ BASE_URL  ä¿®æ”¹å›¾ç‰‡åœ°å€

```js
//  utils/index.js å¼•å…¥
import { BASE_URL } from './utils/url.js'

// å¼•å…¥ import {BASE_URL } from './urils/urils' å¤ªé•¿äº†,è€Œä¸” './urils' å·²ç»å¼•å…¥è¿‡äº†, å¯ä»¥ä¸ç”¨åœ¨å¼•å…¥è¿™ä¹ˆå¤šæ¬¡äº†, æ‰€ä»¥å¯ä»¥åœ¨ index.js é‡Œé¢å¼•å…¥åœ¨å¯¼å‡º
export { BASE_URL } from './url'

// é‚£ä»¥åå¼•å…¥ä½¿ç”¨
import { BASE_URL } from './utils'

// ä½¿ç”¨ : ä»¥åå›¾ç‰‡
<img src={ `${BASE_URL}${item.imgSrc}` } />  æˆ–è€…
<img src={ BASE_URL + item.imgSrc  } />

// å°è¯•ä¿®æ”¹  Index ç»„ä»¶é‡Œé¢çš„
```



#### react è„šæ‰‹æ¶ä¸­çš„ç¯å¢ƒå˜é‡è¯´æ˜

- 1 å½“è¿è¡Œå‘½ä»¤ `yarn start` çš„æ—¶å€™ï¼Œè„šæ‰‹æ¶å°±ä¼šè¯»å–ï¼š`.env.development` è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡
- 2 å½“è¿è¡Œå‘½ä»¤ `yarn build` çš„æ—¶å€™ï¼Œè„šæ‰‹æ¶å°±ä¼šè¯»å–ï¼š`.env.production` è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡



## axios ä¼˜åŒ–

- â‘  åœ¨ utils/api.js æ–‡ä»¶ä¸­, å¯¼å…¥ axios å’Œ BASE_URL
- â‘¡ è°ƒç”¨ axios.create() æ–¹æ³•åˆ›å»ºä¸€ä¸ª axios å®ä¾‹
- â‘¢ ç»™ create() æ–¹æ³•, æ·»åŠ  é…ç½® baseURL, å€¼ä¸º : BASE_URL,   å¹¶ä¸”å¯¼å‡º

```js
const API = axios.create({
	baseURL : BASE_URL
})
export { API }

// åœ¨ utils/index.js  å¯¼å…¥ç«‹é©¬å¯¼å‡º
export { API } from './api.js'
```

- â‘£ å¯¼å…¥ API , ä½¿ç”¨ API ä»£æ›¿ axios , å»æ‰æ¥æ”¶åœ°å€ä¸­çš„ http://localhost:8080

```js
import { API  } from '../utils'

// è¯·æ±‚
const res = await API.get('/home/groups')

// å°è¯•ä¿®æ”¹  Index ç»„ä»¶é‡Œé¢çš„
```



## å¤‡

- ç¯å¢ƒå˜é‡ =>Index => æµ‹è¯•å›¾ç‰‡ä½¿ç”¨ BASE_URL æ›¿æ¢ http://localhost:8080
- axiosä¼˜åŒ– => Index => ä½¿ç”¨API æ›¿æ¢ axios+åŸºè·¯å¾„http://localhost:8080
- å¤ä¹ ä»¥å‰vue å¤„ç† åŸºæœ¬è·¯å¾„çš„

```js
// app.js 
import axios from 'axios'

axios.defaults.baseURL = localhost:8080
å†æŠŠè®¾ç½®å¥½åŸºå‡†è·¯å¾„çš„axios æ·»åŠ åˆ°vueçš„åŸå‹ä¸Š
Vue.protoType.$axios = axios

å› ä¸º æ‰€æœ‰ çš„vueå®ä¾‹ç»„ä»¶éƒ½æ˜¯ç»§æ‰¿ Vueçš„, æ‰€ä»¥æ‰€æœ‰çš„ç»„ä»¶å†… 
this.$axios éƒ½æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨çš„æœ‰åŸºå‡†è·¯å¾„çš„axios

```





# React ç¬¬åäº”å¤©

## åŠ¨ç”»åº“

## react-spring



## react-motion 





## formik è¡¨å•éªŒè¯



# React åä¸ƒå¤©

## é˜²æŠ–(è¾“å…¥æ¡†é˜²æŠ– -- é¢è¯•)

åœ¨è¾“å…¥æ¡†ä¸­,ä½¿ç”¨é˜²æŠ–, ä¿è¯åªä¼šå‘é€æœ€åä¸€æ¬¡çš„è¯·æ±‚

```js
cleartimeout(this.timeId)
this.timeId = setTimeout(() =>{
    // å‘é€è¯·æ±‚
    
}, 500)
```



æ–¹å¼2: lodashåº“ (é¢è¯•ä¼šæ¶‰åŠ) 

ä½¿ç”¨å‡½æ•°çš„æ–¹æ³•`_.debounce()`



## èŠ‚æµ(æŒ‰é’®èŠ‚æµ)

ä¸€èˆ¬å¯ä»¥åº”ç”¨åœ¨ç‚¹å‡»è·å–éªŒè¯ç , è§„å®šæ—¶é—´å†…ä¸å…è®¸åœ¨ç‚¹å‡»

```js
<button onClick={this.fn}>èŠ‚æµçš„æ¼”ç¤º</button>

isOk = false

fn = () => {
    if (this.isOk) {
      return
    }

    console.log('-------------------')

    // å‘é€è¯·æ±‚äº†
    this.isOk = true
    console.log('æˆ‘è¦å‘é€è¯·æ±‚äº†')
    setTimeout(() => {
      console.log('è¯·æ±‚ç»“æŸäº†')
      this.isOk = false
    }, 5000)
  }
```



# React äºŒåä¸€å¤©

## ä¸­é—´ä»¶

- [reduxã€expressä¸­é—´ä»¶å¯¹æ¯”](https://www.jianshu.com/p/922194db2ae2)
- redux ä¸­é—´ä»¶é‡‡ç”¨çš„æ˜¯ æ´‹è‘±æ¨¡å‹
- ä¸­é—´ä»¶å®é™…ä¸Šå°±æ˜¯ æ‰©å±•äº† store.dispatch
  - æ³¨æ„ï¼šä½¿ç”¨ä¸­é—´ä»¶åï¼Œæˆ‘ä»¬è°ƒç”¨ store.dispatch å°±ä¸å†æ˜¯ redux é»˜è®¤çš„dispatchäº†ï¼Œè€Œæ˜¯ï¼Œä¸­é—´ä»¶åŒ…è£…åçš„dispatch
- ä¸­é—´ä»¶çš„æ‰§è¡Œæ—¶æœºï¼š

```js
// æ²¡æœ‰ä¸­é—´ä»¶ï¼š dispatch ç›´æ¥å°† action ä¼ é€’ç»™ reducer
store.dispatch ----> reducer

// æœ‰äº†ä¸­é—´ä»¶ï¼š dispatch æ²¡æœ‰ç›´æ¥å°† action ä¼ é€’ç»™ reducerï¼Œè€Œæ˜¯ï¼Œå…ˆæ‰§è¡Œä¸­é—´ä»¶çš„ä»£ç ï¼Œç­‰åˆ°æ‰€æœ‰çš„ä¸­é—´ä»¶éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šå°† action ä¼ é€’ç»™ reducer
store.dispatch ----> ä¸­é—´ä»¶1 -> ä¸­é—´ä»¶2 -> ä¸­é—´ä»¶3 ----> reducer
```

### redux ä¸­é—´ä»¶åŸç†

- ä¸€ä¸ªä¸­é—´ä»¶å°±æ˜¯åŒ…è£…äº† store.dispatchï¼ˆä¹Ÿå°±æ˜¯reduxåŸç”Ÿçš„dispatchï¼‰ï¼Œå¹¶ä¸”ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªæ–°çš„å‡½æ•°ï¼Œå°±åšä¸ºäº†æ–°çš„ store.dispatch
- ä¹Ÿå°±æ˜¯è¯´ï¼šåªè¦ä½¿ç”¨äº†ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬å†æ‹¿åˆ°çš„ store.dispatch å°±ä¸å†æ˜¯åŸç”Ÿçš„dispatchï¼Œä¸­é—´ä»¶ï¼ŒåŒ…è£…åçš„dispatch



**[express ä¸­é—´ä»¶ å’Œ redux ä¸­é—´ä»¶](https://www.jianshu.com/p/922194db2ae2)**

express æ˜¯ çº¿æ€§æ¨¡å‹, reduxä¸­é—´ä»¶æ˜¯æ´‹è‘±æ¨¡å‹



## redux ä¸­é—´ä»¶ä½¿ç”¨1 - redux-logger

> createStore.js æ–‡ä»¶

- å®‰è£…ä¸­é—´ä»¶ : `yarn add redux-logger`

```js
import logger from 'redux-logger'
```

- å¯¼å…¥reduxä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼š`applyMiddleware`

```js
import { applyMiddleware } from 'redux'
```

- 2 å°†åˆ›å»ºå¥½çš„ä¸­é—´ä»¶æˆ–è€…ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™ applyMiddleware

```js
const middlewares = applyMiddleware(logger)
```

- 3 å°† middlewares ä¼ é€’ç»™ createStoreï¼Œä½œä¸ºå®ƒçš„ç¬¬ä¸‰ä¸ªå‚æ•°

```js
const store = createStore(reducer, initialState, middlewares)
```



## redux ä¸­é—´ä»¶ä½¿ç”¨2-redux-thunk(å¼‚æ­¥action)

#### 1.ä»‹ç»ä½¿ç”¨

- é»˜è®¤æƒ…å†µä¸‹ : redux è‡ªèº«åªä¼šå¤„ç†åŒæ­¥æ•°æ®æµ
- ä½†æ˜¯,å¦‚æœæ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œ, å°±åº”è¯¥ä½¿ç”¨`redux-thunk` è¿™ç§ä¸­é—´ä»¶,æ¥å¤„ç†å¼‚æ­¥æ•°æ®æµ
- ä½œç”¨ : ç”¨åœ¨ åœ¨ redux ä¸­ å¤„ç†å¼‚æ­¥æ•°æ®æµ

```js
// æ²¡æœ‰ä½¿ç”¨ redux-thunk æ—¶å€™, å¤„ç†åŒæ­¥æ•°æ®çš„ action
const addTodo = (text) => ({ type : 'ADD_TODO',text })

// æœ‰äº† redux-thunk ä»¥å,  å¤„ç†å¼‚æ­¥æ•°æ®çš„ action
const addTodoAsync = (text) => {
  
  return (dispatch) => {
   // åœ¨æ­¤å¤„,å°±å¯ä»¥å¤„ç†å¼‚æ­¥æ“ä½œäº†
   setTimeout(()=>{
     
     dispatch( addTodo(text) )
   },3000)
    
  }
}
```

#### 2. redux-thunk å…·ä½“ä½¿ç”¨æ­¥éª¤

- å®‰è£… : `yarn add redux-thunk`
- åœ¨ configStore.js åˆ°ä¸­ å¯¼å…¥thunk
- 
- å°†thunk ä½œä¸ºä¸­é—´ä»¶, ä¼ é€’ç»™ store

```js
import thunk from 'redux-thunk'

const middlewares = applyMiddleware(thunk, logger)
  
// ä¹‹å‰çš„æ•ˆæœè¿˜æœ‰,è¯´æ˜ thunk ä¸ä¼šå¯¹æˆ‘ä»¬ä¹‹å‰å†™çš„åŒæ­¥æœ‰å½±å“
```

- åœ¨ actions ä¸­ åˆ›å»º å¼‚æ­¥ action, ç”¨æ¥å°è£…å¼‚æ­¥æ“ä½œ

```js
// æ·»åŠ å¼‚æ­¥ action å®ç°å¼‚æ­¥æ·»åŠ ä»»åŠ¡çš„æ“ä½œ
const addTodoAsync = text =>{
  return dispatch => {
    setTimeout(() => {
      
      dispatch(addTodo(text))
    }, 3000);
  }
}
// å¯¼å‡º
export { addTodoAsync,....., setVisibilityFilter }
```

- åœ¨ AddTodo.js ä½¿ç”¨

```js
// å¼•å…¥
import { addTodo, addTodoAsync } from '../actions'

// åˆ†å‘åŠ¨ä½œ
dispatch(addTodoAsync(value))
```



#### 3. axios å‘é€è¯·æ±‚ç¤ºä¾‹

```js
export const ml_todoList = list => ({ type: TODO_LIST, list })

// å¼‚æ­¥è·å–todosæ•°æ®
export const ml_todoListSync = () => {
  return async dispatch => {
    const res = await axios.get(`https://jsonplaceholder.typicode.com/todos`)
    let list = res.data.slice(0, 10)
    dispatch(ml_todoList(list))
  }
}
```



## redux ä¸­é—´ä»¶ä½¿ç”¨3 - redux-devtools

### 1. å®‰è£…æ’ä»¶

- é“¾æ¥ : https://github.com/zalmoxisus/redux-devtools-extension
- å®‰è£…çš„å·¥å…·,ä¸èƒ½ä½¿ç”¨

### 2. æ²¡æœ‰å…¶ä»–ä¸­é—´ä»¶

```js
const store = createStore(
  reducer,
  initTodos,
  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()   #+++
)
```



### 3. æœ‰å…¶ä»–ä¸­é—´ä»¶

- å®‰è£…æ’ä»¶ : `yarn add redux-devtools-extension`
- ä½¿ç”¨

```js
import { createStore, applyMiddleware } from 'redux';
import { composeWithDevTools } from 'redux-devtools-extension';

const middlewres = applyMiddleware(logger, thunk, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__())

const store = createStore(
  reducer,
  initTodos,
  composeWithDevTools(middlewres)       # ++++ 
)
```







## React-hooks

 *Hook* æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ç±»ä¼¼`class`ç»„ä»¶çš„`state`

 Hook ä¸ºå·²çŸ¥çš„ React æ¦‚å¿µæä¾›äº†æ›´ç›´æ¥çš„ APIï¼špropsï¼Œ stateï¼Œcontextï¼Œrefs ä»¥åŠç”Ÿå‘½å‘¨æœŸ 

>  Hook åœ¨ class å†…éƒ¨æ˜¯**ä¸**èµ·ä½œç”¨çš„ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥å–ä»£ class ã€‚ 

![](./image/useStateå’ŒuseEffect.png)



### useState

 **`è°ƒç”¨ useState` æ–¹æ³•çš„æ—¶å€™åšäº†ä»€ä¹ˆ?** 

 å®ƒå®šä¹‰ä¸€ä¸ª â€œstate å˜é‡â€ã€‚æˆ‘ä»¬çš„å˜é‡å« `count`ï¼Œ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å«ä»–ä»»ä½•åå­—ï¼Œæ¯”å¦‚ `banana`ã€‚è¿™æ˜¯ä¸€ç§åœ¨å‡½æ•°è°ƒç”¨æ—¶ä¿å­˜å˜é‡çš„æ–¹å¼ â€”â€” `useState` æ˜¯ä¸€ç§æ–°æ–¹æ³•ï¼Œå®ƒä¸ class é‡Œé¢çš„ `this.state` æä¾›çš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨å‡½æ•°é€€å‡ºåå˜é‡å°±å°±ä¼šâ€æ¶ˆå¤±â€ï¼Œè€Œ state ä¸­çš„å˜é‡ä¼šè¢« React ä¿ç•™ã€‚ 



 **`useState` éœ€è¦å“ªäº›å‚æ•°ï¼Ÿ** 

`useState(number/string)` æ–¹æ³•é‡Œé¢å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹ stateã€‚ä¸åŒäº class çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§éœ€è¦ä½¿ç”¨æ•°å­—æˆ–å­—ç¬¦ä¸²å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œè€Œä¸ä¸€å®šæ˜¯å¯¹è±¡ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œåªéœ€ä½¿ç”¨æ•°å­—æ¥è®°å½•ç”¨æˆ·ç‚¹å‡»æ¬¡æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ äº† `0` ä½œä¸ºå˜é‡çš„åˆå§‹ stateã€‚ï¼ˆå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ state ä¸­å­˜å‚¨ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼Œåªéœ€è°ƒç”¨ `useState()` ä¸¤æ¬¡å³å¯ã€‚ï¼‰ 



 **`useState` æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ**

 è¿”å›å€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼šå½“å‰ state ä»¥åŠæ›´æ–° state çš„å‡½æ•°ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å†™ `const [count, setCount] = useState(åˆå§‹state)` çš„åŸå› ã€‚è¿™ä¸ class é‡Œé¢ `this.state.count` å’Œ `this.setState` ç±»ä¼¼ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ä½ éœ€è¦æˆå¯¹çš„è·å–å®ƒä»¬ã€‚

```js
import React, { useState } from 'react';

function Example() {
  // å£°æ˜ä¸€ä¸ªæ–°çš„å«åš â€œcountâ€ çš„ state å˜é‡
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>You clicked {count} times</p>
      <button onClick={() => setCount(count + 1)}>
        Click me
      </button>
    </div>
  );
}
```

****

**å¤šæ¬¡è°ƒç”¨setCount**

åœ¨ä¸€ä¸ªå‡½æ•°ä¸­å¤šæ¬¡è°ƒç”¨ `setCount()` æ—¶, ä¼šå’Œ `setState` ä¸€ä¸ªæ•°æ®æ›´æ–°æ˜¯å¼‚æ­¥çš„, åªä¼šæ‹¿åˆ°åŸæ¥çš„å€¼, å¾—åˆ°çš„ç»“æœæ˜¯ç›¸åŒ,å¦‚æœæƒ³è¦å¾—åˆ°ä¸Šä¸€ä¸ª`setCount` çš„ state , å¯ä»¥é‡‡ç”¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‡½æ•°å¼

```js
<button onClick={() => {
    setCount((count) => {
        count + 1
    })
    setCount((count) => {
        count + 1
    })
}}>
```





### useEffect

ä½ å¯ä»¥æŠŠ `useEffect` Hook çœ‹åš `componentDidMount`ï¼Œ`componentDidUpdate` å’Œ `componentWillUnmount` è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆã€‚ 

åœ¨åˆæ¬¡æ¸²æŸ“å’Œ`state` æ›´æ–°éƒ½ä¼šè§¦å‘`useEffect( () => {} )`

å‡½æ•°çš„è¿”å›å€¼, å°†ä¼šåœ¨ç»„ä»¶å¸è½½æ—¶è°ƒç”¨(`ç›¸å½“äºè°ƒç”¨äº†componentWillUnmount`)

```js
import React, { useState, useEffect } from 'react';

function Example() {
  const [count, setCount] = useState(0);

  // Similar to componentDidMount and componentDidUpdate:
  useEffect(() => {
    // Update the document title using the browser API
    document.title = `You clicked ${count} times`;
      
    # æŒ‚è½½  
    window.addEventListener('mousemove', handleFn)
    
      # return çš„å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½æ—¶è°ƒç”¨
    return () => {
        window.removeEventListener('mousemove', handleFn)
    }
  }, [count]) # å‚æ•°2: ä¾èµ–é¡¹, å†³å®š return çš„å‡½æ•°æ‰§è¡Œä¸å¦
  
  handleFn = () => { console.log('å“ˆå“ˆ') }
  return (
    <div>
      <p>You clicked {count} times</p>
      <button onClick={() => setCount(count + 1)}>
        Click me
      </button>
    </div>
  );
}
```



**useEffectå‚æ•°**

- param1:  ç®­å¤´å‡½æ•° ( componentDidMount , componentDidUpdate)  return å€¼ä¸º componenetWillUnmount
- param2:  [ä¾èµ–é¡¹]
  - å½“ä¾èµ–é¡¹æ•°æ®å‘ç”Ÿå˜åŒ–, useEffect é‡Œçš„å‡½æ•°å°±ä¼šæ‰§è¡Œ
  - å¦‚æœä¸å‘ç”Ÿå˜åŒ–,  return çš„å‡½æ•°åˆ™ä¸ä¼šæ‰§è¡Œ



**effectçš„æ¡ä»¶æ‰§è¡Œ**

- é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect ä¼šåœ¨æ¯è½®ç»„ä»¶æ¸²æŸ“å®Œæˆåæ‰§è¡Œ
- ä½†æ˜¯ ä¸æ˜¯æ¯æ¬¡éƒ½éœ€è¦æ‰§è¡Œçš„, æ¯”å¦‚åœ¨ä¸Šä¸€ç« çš„æ³¨å†Œé¼ æ ‡ç§»åŠ¨äº‹ä»¶, æ¯æ¬¡ç»„ä»¶æ›´æ–°éƒ½ä¼šæ³¨å†Œä¸€æ¬¡
- è¦å®ç°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ç»™ useEffect ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ effect æ‰€ä¾èµ–çš„å€¼æ•°ç»„

```js
// æ³¨å†Œäº‹ä»¶
useEffect(() => {
  console.log('æ³¨å†Œ')

  window.addEventListener('mousemove', handleMousemove)
  return () => {
    window.removeEventListener('mousemove', handleMousemove)
  }
}, [å‚æ•°2 ä¸ºä¾èµ–é¡¹])

// æ¯”å¦‚ä½¿ç”¨count 

useEffect({

},[count])  
// å½“ count å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰ä¼šå‡ºæ‰§è¡Œ, 
// å¦‚æœcount ä¸å˜å°±ä¸éœ€è¦æ‰§è¡Œ

```

- æ­¤æ—¶ï¼Œåªæœ‰å½“ `å‚æ•°2 ä¾èµ–é¡¹` æ”¹å˜åæ‰ä¼šé‡æ–°åˆ›å»ºè®¢é˜…ã€‚

  - å¦‚æœä½ è¦ä½¿ç”¨æ­¤ä¼˜åŒ–æ–¹å¼ï¼Œè¯·ç¡®ä¿æ•°ç»„ä¸­åŒ…å«äº†æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­ä¼šå‘ç”Ÿå˜åŒ–ä¸”åœ¨ effect ä¸­ä½¿ç”¨çš„å˜é‡
  - å¦‚æœæƒ³æ‰§è¡Œåªè¿è¡Œä¸€æ¬¡çš„ effectï¼ˆä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•° (è¿™å°±å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äº props æˆ– state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦é‡å¤æ‰§è¡Œ)
  - ä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ effect å‡½æ•°

- æ”¹é€ ä¹‹å : 

  ```js
  // æ·»åŠ æ ‡é¢˜
  useEffect(() => {
    document.title = `ä½ ç‚¹å‡»äº†${count}æ¬¡`
  }, [count])    # è¿™é‡Œæ·»åŠ 
    
  // æ³¨å†Œäº‹ä»¶
  useEffect(() => {
    console.log('æ³¨å†Œ')
    
    window.addEventListener('mousemove', handleMousemove)
    return () => {
      window.removeEventListener('mousemove', handleMousemove)
    }
  }, [])   # è¿™é‡Œæ·»åŠ 
  ```





### useContext

3.1 ä»‹ç»

- useContext ç”¨æ¥ç®€åŒ– context

3.2 å›å¿†

```js
// ç¬¬ä¸€æ­¥: åˆ›å»º context
const context = React.createContext()

class Child22 extends React.Component {
  render() {
    return (
      <context.Provider value="123">
        <div>
          context-ç±» <One></One>{' '}
        </div>
      </context.Provider>
    )
  }
}
class One extends React.Component {
  render() {
    return <context.Consumer>{data => <div>ä¼ é€’:{data}</div>}</context.Consumer>
  }
}
```



3.3 ä½¿ç”¨ useContext æ”¹é€ 

- åˆ‡è®° : hook æ˜¯ç”¨åœ¨å‡½æ•°ç»„ä»¶é‡Œçš„, æ‰€ä»¥ä¸€å®šè¦æŠŠ Three ç»„ä»¶æ”¹ä¸º å‡½æ•°ç»„ä»¶,ä¸ç„¶ä¼šæœ‰æç¤º
- `Invalid hook call. Hooks can only be called inside of the body of a function component`

```js
// ç¬¬ä¸€æ­¥: åˆ›å»º context
const context = React.createContext()

const Child11 = () => {
  return (
    // ç¬¬äºŒæ­¥ : åŒ…è£¹
    <context.Provider value="666">
      <div>
        context-fn <One></One>{' '}
      </div>
    </context.Provider>
  )
}
const One = () => {
  // ç¬¬ä¸‰æ­¥ : è¿”å›å€¼
  const value = useContext(context)

  return <div>ä¼ é€’ : {value}</div>
}
```



### useReducer

**4.1 ä»‹ç»**

- ä½¿ç”¨ useReducer æ›¿ä»£ redux 

**4.2 redux å›å¿†**

```js
// åˆ›å»º store
import { createStore } from 'redux'
// rducer
let reducer = (state, action) => {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 }
    case 'decrement':
      return { count: state.count - 1 }
    default:
      return { count: state.count }
  }
}
// åˆå§‹å€¼
let initialState = { count: 100 }
// åˆ›å»º store
const store = createStore(
  reducer,
  initialState,
  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()
)
// ç›‘å¬æ•°æ®çš„å˜åŒ–
store.subscribe(() => {
  console.log('æ•°æ®å˜åŒ–', store.getState())
})

//2. åˆ›å»ºç»„ä»¶
const Child = () => {
  return (
    <div>
      <div>Count:{store.getState().count}</div>
      <button onClick={() => store.dispatch({ type: 'increment' })}>+1</button>
      <button onClick={() => store.dispatch({ type: 'decrement' })}>-1</button>
    </div>
  )
}
```



**4.3 ä½¿ç”¨ useReducer æ”¹é€  redux**

```js
//1. å¼•å…¥åŒ…
import React, { useReducer } from 'react'

// reducer
const reducer = (state = 1, action) => {
  switch (action.type) {
    case 'increment':
      return state + 1
    case 'decrement':
      return state - 1
    default:
      return state
  }
}

//2. åˆ›å»ºç»„ä»¶
const Child = () => {
  const [state, dispatch] = useReducer(reducer, 1)

  return (
    <div>
      å‡½æ•°ç»„ä»¶ {state}
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>1</button>
    </div>
  )
}
```

